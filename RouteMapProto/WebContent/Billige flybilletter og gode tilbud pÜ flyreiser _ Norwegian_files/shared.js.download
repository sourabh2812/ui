function HotelComUrlBuilder(){function i(n,t,i,r){return"&wapb3=|c."+n+"|l."+t+"|t."+i+"|s."+r}function r(n){return"pos="+n}function u(n){return"&locale="+n}function f(n){return"&q-check-in="+n}function e(n){return"&q-check-out="+n}function o(n){return"&q-rooms="+n}function s(n){return"&token="+n}function h(n,t){if(n)return"&q-destination="+n;if(t)return"&destination-id="+t;throw"Either destination or destination ID must be specified";}function c(n,i){return t(n,i,"adults")}function l(n,i){return t(n,i,"children")}function a(t,i,r){for(var e=n(t,i),o="",f,u=0;u<e.length;u++)for(f=0;f<e[u];f++)o+="&q-room-["+u+"]-child-"+f+"-age="+r[f];return o}function n(n,t){for(var i=[];n>t;)n=n-t,i.push(t);return i.push(n),i}function t(t,i,r){for(var f=n(t,i),e="",u=0;u<f.length;u++)e+="&q-room-["+u+"]-"+r+"="+f[u];return e}function v(n,t){if(n===0)return 0;for(var i=1;n>t;)i++,n=n-t;return i}HotelComUrlBuilder.prototype.buildVendorUrl=function(n,t,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot){if(!t)throw"Pos must be specified";if(!y)throw"Locale must be specified";if(!w&&!b)throw"Either destination or destination ID must be specified";if(!nt)throw"Adult count must be specified";if(it>0&&!ut)throw"Children ages must be specified";if(it>0&&ut.length!==it)throw"Children ages must be specified for each child";if(!n){var st="https://hotels.norwegian.com/search.do";y.toLowerCase()==="no_no"&&(st="https://hotels.norwegian.no/search.do");n=st}return g||(g=v(nt,tt)),n+"?"+r(t)+u(y)+i(p,y,ft,et)+(ot?s(ot):"")+h(w,b)+f(k)+e(d)+o(g)+c(nt,tt)+(it>0?l(it,rt):"")+(it>0?a(it,rt,ut):"")}}(function(){"use strict";angular.module("nas.brand",[])})(),function(){"use strict";angular.module("nas.core",[])}(),function(){"use strict";angular.module("nas.modals",[])}(),function(){"use strict";var n=angular.module("nas.shared",[]);n.run(["airportsSvc",function(){}])}(),function(n){"use strict";var t=angular.module("nas.bootstrap",["nas.instant","nas.core","nas.shared"]);"ontouchstart"in window;angular.element(document.getElementsByTagName("label")).on("click",function(){});angular.module("nas.bootstrap").factory("bootstrappedData",function(){return{}});typeof Object.assign!="function"&&function(){Object.assign=function(n){var u,i,t,r;if(n===undefined||n===null)throw new TypeError("Cannot convert undefined or null to object");for(u=Object(n),i=1;i<arguments.length;i++)if(t=arguments[i],t!==undefined&&t!==null)for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(u[r]=t[r]);return u}}();t.run(["$rootScope","$timeout","$translate","deviceSvc",function(n,t,i,r){r.isIos&&r.isSafari&&n.$on("$stateChangeStart",function(){try{var r="-testing-";window.sessionStorage.setItem(r,"1");window.sessionStorage.removeItem(r)}catch(u){t(function(){n.$broadcast("showInfoMessage",{items:[i.instant("SafariPrivateBrowsingWarning")]})},1e3)}})}]);t.run(["$rootScope","$window","$http",function(t,i,r){t.window=i;angular.element(document.getElementById("loader")).css("display","none");angular.element(i).bind("keyup",function(n){t.$emit("norwegian.keyup",n)});r.defaults.transformRequest.push(function(n){if(n)return t.$broadcast("errorMessageHide"),n});_.each(["$stateChangeStart","$locationChangeStart","$routeChangeStart"],function(i){t.$on(i,function(){n.closeMenu()})})}]);t.run(["notifierSvc",function(){}]);t.run(function(){window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""))});t.config(["$translateProvider","instantTranslationLanguage",function(n,t){n.translations(t.languageCode,t).preferredLanguage(t.languageCode).useSanitizeValueStrategy(null)}]);t.config(["$httpProvider",function(n){n.interceptors.push("languageInterceptor")}]);t.config(["$compileProvider",function(n){n.debugInfoEnabled(!1)}]);t.config(["$provide","nasConfig","$cookiesProvider",function(n,t,i){(i.defaults.path="/",t.logging.enabled)&&(n.decorator("$log",["$delegate","$injector","$window",function(n,i,r){var u=n.info;return n.info=function(n){u(n);var i=new XMLHttpRequest;i.open("POST",t.logging.infoUrl);i.setRequestHeader("Content-Type","application/json");i.send(angular.toJson({message:n,url:r.location.href}))},n}]),n.decorator("$exceptionHandler",["$delegate","$injector","$window",function(n,i,r){return function(u,f){if(!u.stack||!(u.stack.indexOf("setItem@[native code]")>0)){i.get("$rootScope").$broadcast("errorMessageShow");var e=new XMLHttpRequest;e.open("POST",t.logging.errorUrl);e.setRequestHeader("Content-Type","application/json");e.send(angular.toJson({message:u.stack||u.message||u||"",source:f||"",url:r.location.href}));n(u,f)}}}]))}])}(NasPlainMenuController),function(){"use strict";angular.module("nas.brand").directive("alert",["$window",function(n){return{restrict:"C",link:function(t,i){function o(n,t){return n.className&&new RegExp("(\\s|^)"+t+"(\\s|$)").test(n.className)}function f(){u&&i[0].offsetHeight>130&&i.addClass("alert--collapsed")}function s(){window.clearTimeout(e);e=window.setTimeout(function(){f()},200)}var u=!o(i[0],"alert--fixed-bottom"),r,e;u&&(r=document.createElement("button"),r.setAttribute("type","button"),r.setAttribute("class","alert__toggle"),r.addEventListener("click",function(){i.removeClass("alert--collapsed")}),i[0].appendChild(r),f());angular.element(n).bind("resize",s)}}}])}(),function(){"use strict";var n=angular.module("nas.brand");n.directive("norwegianApiRequestVerificationToken",["$http",function(n){return function(t,i,r){n.defaults.headers.common.ApiRequestVerificationToken=r.norwegianApiRequestVerificationToken||"no token"}}])}(),function(){"use strict";angular.module("nas.brand").directive("autoSuggest",["$timeout","$filter","scroller","keyCodes",function(n,t,i,r){function u(n){var t=0;if(n.offsetParent)do t+=n.offsetTop;while(n=n.offsetParent);return t}return{replace:!0,scope:{ngModel:"=",closeLabel:"=",ngChange:"&?",airports:"=",label:"=",iconClass:"=",suggestions:"=",setFocus:"=",placeholders:"=",emptyText:"=",input:"=?displayname",lastSeparatorText:"=",close:"&onClose",inputId:"@",open:"&onOpen",hideCode:"=",disableFilter:"=",showOnEnterChars:"=",itemsNumberLimit:"=",inputDebounce:"=",onInputChange:"=",displayCategory:"="},require:"^ngModel",link:function(f,e,o){function rt(){f.ngModel?(f.disableFilterIfItemSelected=!0,w(!0)):f.disableFilterIfItemSelected=!1;f.showOnEnterChars==0&&(f.showSuggestions=!0,st(),f.displayCategory&&n(function(){y();var n=e[0].getElementsByClassName("autosuggest__suggestions");n&&n.length!==0&&n[0].addEventListener("scroll",y)},500));f.open&&f.open()}function d(){f.showSuggestions=!1;l[0].blur();b();f.close&&f.close()}function ut(){f.ngModel="";f.input="";a(!0);l[0].focus()}function g(n){return n?n.displayName+" ("+n.code+")":""}function ft(){var n=f.input.indexOf(" (");return n>0?f.input.slice(0,n):f.input}function c(t,i){f.ngModel=t?t.code?t.code:"":"";f.input=f.hideCode?t&&t.displayName?t.displayName:"":t&&t.code?g(t):"";a(!0);n(function(){i||f.blur();k();f.ngChange&&f.ngChange()},100)}function et(n){c(t("filter")(f.airports,{$:n})[0])}function ot(n){var i,e,r,t,o,u,s;if(f.disableFilter||f.disableFilterIfItemSelected||(i=(f.searchTerm||"").toLowerCase(),e=i.indexOf(" ")>-1,n.displayName.toLowerCase().lastIndexOf(i,0)===0))return!0;for(r=n.displayName.split(/-| |\//),t=0;t<r.length;++t)if(o=e?r.slice(t).join(" "):r[t],o.toLowerCase().lastIndexOf(i,0)===0)return!0;if(n.airportName)for(u=n.airportName.split(/-| |\//),t=0;t<u.length;++t)if(s=u[t],s.toLowerCase().lastIndexOf(i,0)===0)return!0;return n.countryName&&n.countryName.toLowerCase().lastIndexOf(i,0)===0?!0:n.code&&n.code.toLowerCase().lastIndexOf(f.searchTerm.toLowerCase(),0)===0?!0:n.cityCode&&n.cityCode.toLowerCase().lastIndexOf(f.searchTerm.toLowerCase(),0)===0?!0:n.cityName&&n.cityName.toLowerCase().lastIndexOf(f.searchTerm.toLowerCase(),0)===0?!0:n.virtualDestination&&n.virtualDestination.toLowerCase().lastIndexOf(f.searchTerm.toLowerCase(),0)===0?!0:!1}function a(n){if(f.disableFilterIfItemSelected=!1,f.searchTerm=ft(),!n&&f.onInputChange&&f.searchTerm.length>=f.showOnEnterChars){f.onInputChange(f.searchTerm);p=!0}else w()}function w(n){(s=t("filter")(f.airports,f.searchfilter),s&&f.itemsNumberLimit&&f.itemsNumberLimit>0&&(s=t("limitTo")(s,f.itemsNumberLimit)),n)||(f.searchTerm!==""?v(0):(h=-1,k()),f.showOnEnterChars>0?document.activeElement==l[0]&&f.searchTerm.length>=f.showOnEnterChars?(f.showSuggestions=!0,y()):f.showSuggestions=!1:y())}function b(){if(f.ngModel){var n=_.find(f.airports,function(n){return n.code==f.ngModel});n&&(f.input=f.hideCode?n.displayName:g(n),a(!0))}}function v(t){n(function(){h=Math.min(s?s.length:0,Math.max(1,h+t));k();s&&s.length>0?(s[h-1].focus=!0,f.selectedOption=f.id+"-"+s[h-1].code,f.$apply(),ht()):f.selectedOption=""})}function st(){if(s&&s.length>0){var n=-1,t=_.find(s,function(t,i){return n=i,t.code==f.ngModel});t&&n!=-1&&(h=n+1,v(0))}}function ht(){var t=e[0].getElementsByClassName("autosuggest__link--focus"),n=e[0].getElementsByClassName("autosuggest__suggestions");if(t&&n&&n.length!==0&&t.length!==0){var f=n[0].offsetHeight,s=f-t[0].offsetHeight,o=n[0].scrollTop,r=u(t[0])-u(n[0]);r>=o+f-2?i.scrollTo(n[0],r-s,100):r<=o&&i.scrollTo(n[0],r,100)}}function k(){for(var n=f.airports?f.airports.length:0;n--;)f.airports[n].focus=!1}function tt(n){it(n,1)}function ct(n){it(n,-1)}function it(n,t){var i=_.filter(document.querySelectorAll("input, a, select, button, textarea"),function(n){return n.tabIndex>-1&&(n.offsetHeight>0||n.offsetWidth>0)}),r=i.indexOf(n);i[r+t].focus();typeof i[r+t].select=="function"&&i[r+t].select()}function y(){f.displayCategory&&n(function(){var n=e[0].getElementsByClassName("autosuggest__suggestions"),t,i,o,r;if(n&&n.length!==0&&n[0].children&&n[0].children.length!==0)for(t=0;t<n[0].children.length;t++)if(i=n[0].children[t],o=u(i)-u(n[0]),o+i.scrollHeight>n[0].scrollTop+12&&(r=i.getElementsByClassName("autosuggest__place"),r)){f.categoryName=r[0].innerText;f.$apply();break}},200)}var l=e[0].getElementsByClassName("autosuggest__input"),s,h=-1,p=!1,nt;f.name=o.name?o.name:"airportsearch";f.showSuggestions=!1;f.input=f.input||"";f.focus=rt;f.blur=d;f.clear=ut;f.select=c;f.selectSuggestion=et;f.inputChange=a;f.searchfilter=ot;f.id=f.inputId?f.inputId:f.name;f.labelId="label_"+f.id;f.selectedOption="";f.hideCode=f.hideCode?f.hideCode:!1;f.disableFilter=f.disableFilter?f.disableFilter:!1;f.showOnEnterChars=f.showOnEnterChars?f.showOnEnterChars:0;f.inputDebounce=f.inputDebounce?f.inputDebounce:0;f.displayCategory=f.displayCategory?f.displayCategory:!1;f.categoryName="";nt=f.$watch("placeholders",function(n){if(n){nt();var t=Math.floor(Math.random()*f.placeholders.length);f.placeholder=f.placeholders[t]}});f.$watch("setFocus",function(t){t&&n(function(){l[0].focus()})});f.$watch("ngModel",function(){f.ngModel?b():c(!1,!0)});f.$watch("airports",function(i){i&&n(function(){f.disableFilter||(s=t("filter")(f.airports,f.ngModel));p?(w(),p=!1):b()})});e.bind("keydown keypress",function(t){t.which===r.UP?v(-1):t.which===r.DOWN?v(1):t.which===r.ENTER?h&&(t.preventDefault(),c(s[h-1]),n(function(){tt(t.target)},200)):t.which===r.ESC?(t.preventDefault(),d()):t.which===r.TAB&&(t.preventDefault(),c(s[h-1]),n(function(){t.shiftKey?ct(t.target):tt(t.target)},200))})},template:'<div class="autosuggest" data-ng-class="{\'autosuggest--focus\': showSuggestions}" tabindex="-1"><div class="autosuggest__label"><label class="autosuggest__title" for="{{id}}" id="{{labelId}}">{{ label }}<\/label><i class="autosuggest__icon" data-ng-class="iconClass" data-ng-if="input.length < 1"><\/i><input type="search" value="{{input}}" data-ng-model="input" role="combobox" aria-expanded="{{showSuggestions}}" aria-autocomplete="list" aria-owns="{{id}}-list" aria-activedescendant="{{selectedOption}}" ng-change="inputChange()" class="autosuggest__input" ng-focus="focus()" placeholder="{{ placeholder }}" name="{{ name }}" id="{{ id }}" autocomplete="off" ng-model-options="{ debounce: inputDebounce }" data-nas-focus-scroll/><button type="button" tabindex="-1" class="autosuggest__clear" data-ng-click="clear()" data-ng-if="input.length > 0" ><i aria-label="{{closeLabel}}" class="icon-remove"><\/i><\/button><div class="autosuggest__line"><\/div><\/div><div class="autosuggest__suggestions-wrapper"><div class="autosuggest__suggestions-content" data-ng-if="showSuggestions"><div data-ng-if="displayCategory" class="autosuggest__category"><strong>{{ categoryName }}<\/strong><\/div><ul class="autosuggest__suggestions" id="{{id}}-list" role="listbox"><li role="option" id="{{id}}-{{item.code}}" aria-label="{{item.displayName}}" class="autosuggest__item" data-ng-repeat="item in filteredSuggestions = ( airports  | filter:searchfilter | limitTo:itemsNumberLimit)"><a href="" data-ng-click="select(item)" class="autosuggest__link" data-ng-class="{\'autosuggest__link--focus\': item.focus}" tabindex="-1"><strong class="autosuggest__airport" data-ng-if="item.code && !hideCode">{{ item.displayName }} ({{ item.code }})<\/strong><strong class="autosuggest__airport" data-ng-if="item.code && hideCode">{{ item.displayName }}<\/strong><strong class="autosuggest__airport" data-ng-if="!item.code">{{ item.displayName }}<\/strong><small class="autosuggest__place" data-ng-if="item.countryName" >{{ item.countryName }}<\/small><\/a><\/li><li class="autosuggest__item" data-ng-if="filteredSuggestions.length < 1"><div class="autosuggest__no-hits"><strong class="autosuggest__airport">{{ emptyText }}<\/strong><\/div><\/li><\/ul><\/div><\/div><div class="autosuggest__quick-suggestions" role="presentation" data-ng-if="suggestions && suggestions.length > 0"><span data-ng-repeat="suggestion in suggestions"><a href="" tabindex="-1" data-ng-click="selectSuggestion(suggestion)" class="autosuggest__quick-suggestions__link" data-ng-attr-aria-labelledby="{{labelId}}">{{ suggestion }}<\/a><span data-ng-if="$index < ( suggestions.length - 2 )">, <\/span><span data-ng-if="$index == ( suggestions.length - 2 )"> {{ lastSeparatorText }} <\/span><\/span>?<\/div><div class="autosuggest__backdrop" data-ng-click="blur()" data-ng-if="showSuggestions"><\/div><\/div>'}}])}(),function(){"use strict";var n=angular.module("nas.brand");n.directive("norwegianCheckboxbutton",["deviceSvc","$timeout",function(n,t){return{restrict:"A",transclude:!0,scope:{required:"=?",disabled:"=?",negate:"=?",click:"&?",ngModel:"="},require:"ngModel",link:function(i,r,u,f){function e(){i.disabled||(i.disabled=!1);(n.isSafari||n.isTravelAssistant||n.isNativeAndroid)&&r.find(".btn-cb .check").removeClass("check").addClass("check-alt")}i.elementId=_.uniqueId("cb_");u.id&&(i.elementId=u.id,r.removeAttr("name"));i.cbLabelId="label_"+i.elementId;e();i.$watch("ngModel",function(){typeof i.ngModel=="string"&&(i.ngModel=i.ngModel=="true"?!0:!1);i.model=i.ngModel});i.negate===!0&&(i.model=!i.model);r.on("change",function(){i.disabled||t(function(){i.$apply(function(){f.$setViewValue(i.negate===!0?!i.model:i.model);f.$setTouched(!0);i.click&&t(function(){i.click()})})},100)})},template:'<label class="checkbox"><input type="checkbox" name="checkbox-group" id="{{elementId}}" data-ng-model="model" data-ng-required="required" data-ng-disabled="disabled" aria-labelledby="{{cbLabelId}}"/><span class="checkbox__control-indicator"><\/span><span id="{{cbLabelId}}" data-ng-transclude><\/span><\/label>'}}]);n.directive("norwegianRadio",["$timeout","keyCodes",function(n,t){return{restrict:"A",transclude:!0,scope:{model:"=",value:"=",isreadonly:"=",modifier:"="},compile:function(){return{post:function(i,r){function f(n,t){if(event.target.nodeName==="BUTTON"){var i=Array.prototype.slice.call(r[0].querySelectorAll("button")),f=i.indexOf(event.target),u=f+t;u<i.length&&u>=0?(i[u].focus(),i[u].click()):u>=i.length?(i[0].focus(),i[0].click()):u<0&&(i[i.length-1].focus(),i[i.length-1].click())}}function u(){i.options&&(i.optionList=_.map(i.options,function(n,t){return n===undefined?{}:typeof n=="string"?{value:n,label:i.optionLabels&&i.optionLabels[t]||n}:{value:n.value,label:i.optionLabels&&i.optionLabels[t]||n.label||n.name||n.value}}))}i.radiogroup=_.uniqueId("radio_");r.on("keydown keypress",function(n){n.which===t.RIGHT||n.which===t.DOWN?f(n.target,1):n.which===t.LEFT||n.which===t.UP?f(n.target,-1):n.which===t.SPACE&&n.target.nodeName==="BUTTON"&&n.target.click()});var e=i.$watch("optionLabels",function(){i.optionLabels&&(e(),u())});i.$watch("options",function(){i.options&&u()});u();i.onClick=function(t){i.isreadonly||(i.model=t,i.click&&n(function(){i.click({selected:t})}))};n(function(){var n=Array.prototype.slice.call(r[0].querySelectorAll("button"));n.length>0&&(_.some(n,function(n){return n.tabIndex>=0})||(n[0].tabIndex=0))})}}},template:'<label class="control radio {{modifier ? modifier : \'\'}}"><input type="radio" name="{{model}}" data-ng-value="value" data-ng-model="model" data-ng-readonly="isreadonly" data-ng-disabled="isreadonly" /> <span class="radio__control-indicator"><\/span> <span data-ng-transclude><\/span><\/label> '}}])}(),function(){"use strict";angular.module("nas.brand").directive("norwegianClearServerValidation",function(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){n.$watch(i.ngModel,function(){r.$error.server&&r.$setValidity("server",!0)})}}})}(),function(){"use strict";angular.module("nas.brand").directive("norwegianDatePicker",["$timeout","keyCodes",function(n,t){return{replace:!0,transclude:!0,scope:{label:"=",ngModel:"=",minDate:"=",maxDate:"=",iconClass:"=",disabledFn:"=?",onClose:"&",onChanged:"&",setFocus:"=",datepickerMode:"=",minMode:"=",isAccessibilityMode:"=",isBusy:"=",showFooter:"="},link:function(i,r,u){function e(){var t=t=r[0].querySelector(".calendarnavigation__button.pull-left"),u=r[0].querySelector(".calendarnavigation__button.pull-right"),f=r[0].querySelector('[role="heading"]'),n;t!=undefined&&u!=undefined&&f!=undefined&&(t.disabled=!1,u.disabled=!1,i.datepickerMode=="day"?(n=moment(f.innerText,"MMMM YYYY"),i.min!="Invalid Date"&&n<=new Date(i.min.getFullYear(),i.min.getMonth(),1)&&(t.disabled=!0),i.max!="Invalid Date"&&n>=new Date(i.max.getFullYear(),i.max.getMonth(),1)&&(u.disabled=!0)):i.datepickerMode=="month"&&(n=moment(f.innerText,"YYYY"),i.min!="Invalid Date"&&n.year()<=i.min.getFullYear()&&(t.disabled=!0),i.max!="Invalid Date"&&n.year()>=i.max.getFullYear()&&(u.disabled=!0)))}function o(n,t){var i=_.filter(document.querySelectorAll("input, a, select, button, textarea"),function(n){return n.tabIndex>-1&&(n.offsetHeight>0||n.offsetWidth>0)}),r=i.indexOf(n);i[r+t].focus();typeof i[r+t].select=="function"&&i[r+t].select()}function s(n){return o(n,1)}function h(n){return o(n,-1)}var f=r[0].querySelector(".calendar__input");i.name=u.name||"";i.showCalendar=!1;i.label=i.label?i.label:"Outbound";i.selectedDate=new Date(i.ngModel?i.ngModel:i.minDate);i.min=new Date(i.minDate);i.max=new Date(i.maxDate);i.datepickerMode||(i.datepickerMode="day");i.minMode||(i.minMode="day");i.isAccessibilityMode&&(i.type="date",i.placeholder="yyyy-MM-dd",i.minMode==="month"&&(i.type="month",i.placeholder="yyyy-MM"));i.disabled=function(n,t){return i.disabledFn?i.disabledFn(n,t):!1};i.focus=function(){f.focus();i.showCalendar=!0;n(function(){r[0].querySelector(".ui-datepicker .ui-datepicker-content").focus()})};i.$on("dateViewSwitched",function(){n(function(){e()})});i.$watch("datepickerMode",function(){n(function(){e()})});i.blur=function(){i.showCalendar=!1;i.onClose&&i.onClose()};i.change=function(){s(f);i.blur();i.onChanged&&i.onChanged()};i.getClass=function(n,t){return t};i.$watch("setFocus",function(n){n&&i.focus()});i.$watch("minDate",function(n,t){if(n&&n!==t){var r=new Date(n),u=i.selectedDate;i.min=r;e();u<r&&(i.selectedDate=new Date(n))}});i.$watch("maxDate",function(n,t){if(n&&n!==t){var r=new Date(n),u=i.selectedDate;i.max=r;e();u>r&&(i.selectedDate=new Date(n))}});i.select=function(n){n&&(i.ngModel=moment(n).format("YYYY-MM-DD"))};i.finish=function(){i.blur();i.onChanged&&i.onChanged()};i.$watch("selectedDate",function(){i.ngModel=moment(i.selectedDate).format("YYYY-MM-DD")});i.$watch("ngModel",function(n){n||(i.selectedDate=i.min)});r.bind("keydown keypress",function(r){i.isAccessibilityMode||(r.which===t.ESC?i.blur():r.which===t.TAB&&(r.preventDefault(),r.shiftKey?h(f):s(f),n(function(){i.blur()})))})},template:'<div><label class="calendar__label" data-ng-if="isAccessibilityMode"><span class="calendar__title">{{ label }}<\/span><i class="calendar__icon icon-small--calendar"><\/i><input type="{{type}}" min="{{minDate}}" data-ng-change="select(selectedDate)"class="calendar__input datepicker" ng-blur="finish()"data-ng-model="selectedDate" placeholder="{{placeholder}}" data-nas-focus-scroll /><div class="calendar__line"><\/div><\/label><div class="calendar" data-ng-class="{\'calendar--focus\': showCalendar}" tabindex="-1" data-ng-show="!isAccessibilityMode"><label class="calendar__label"><span class="calendar__title">{{ label }}<\/span><i class="calendar__icon" data-ng-class="iconClass"><\/i><input type="text" class="calendar__input" data-ng-click="focus()" placeholder="{{ placeholder }}" value="{{ selectedDate | date:\'fullDate\' }}" data-ng-focus="focus()" readonly data-nas-focus-scroll/><div class="calendar__line"><\/div><\/label><div class="calendar__datepicker-wrapper"><div class="calendar__datepicker" data-ng-show="showCalendar"><div data-uib-datepicker data-min-mode="minMode" data-datepicker-mode="datepickerMode" data-max-mode="month" data-custom-class="getClass(date, mode)" data-ng-model="selectedDate" name="{{name}}" class="ui-datepicker" data-show-weeks="false" data-starting-day="1" data-min-date="minDate" data-max-date="maxDate" data-year-range="2" data-ng-change="change()" data-date-disabled="disabled(date, mode)"><\/div><div class="calendar__footer" data-ng-if="showFooter"><div class="calendar__footer--message" ng-transclude><\/div><div class="calendar__footer--busy" data-ng-show="isBusy"><div class="preloader preloader--small"><div class="preloader__border"><\/div><\/div><\/div><\/div><\/div><\/div><div class="calendar__backdrop" data-ng-click="blur()" data-ng-if="showCalendar"><\/div><\/div><\/div>'}}]).config(["$provide",function(n){n.decorator("uibDatepickerDirective",["$delegate",function(n){var t=n[0],i=t.link;return t.compile=function(){return function(n,t,r,u){i.apply(this,arguments);var f=u[0],e=u[1];e&&n.$on("refreshDatepickers",function(){f.refreshView()});n.$watch(function(){return f.activeDate.getTime()},function(){n.$emit("dateViewSwitched",{name:r.name,date:f.activeDate})})}},n}])}])}(),function(){"use strict";var n=angular.module("nas.brand");n.factory("deviceSvc",function(){var i=parseInt((/WebKit\/([0-9]+)/.exec(navigator.appVersion)||0)[1],10)||void 0,r=navigator.userAgent.indexOf("TravelAssistant")!=-1,n=navigator.userAgent.indexOf("Android")!=-1,u=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,f=n&&i<=534&&navigator.vendor.indexOf("Google")>=0,t=navigator.userAgent.indexOf("Chrome")!=-1,e=navigator.userAgent.indexOf("Safari")!=-1&&!t;return{height:{md:function(){return Modernizr.mq("(min-height: 380px)")},lg:function(){return Modernizr.mq("(min-height: 668px)")},xl:function(){return Modernizr.mq("(min-height: 924px)")}},width:{md:function(){return Modernizr.mq("(min-width: 640px)")},lg:function(){return Modernizr.mq("(min-width: 1000px)")},xl:function(){return Modernizr.mq("(min-width: 1280px)")}},isTravelAssistant:r,isNativeAndroid:f,isAndroid:n,isIos:u,isChrome:t,isSafari:e}})}(),function(){"use strict";angular.module("nas.brand").directive("norwegianDropdown",["$timeout","keyCodes","$window",function(n,t,i){return{replace:!0,transclude:!0,scope:{closeOnChange:"=",options:"=",ngModel:"="},require:"^ngModel",link:function(r,u){function o(){var n=u[0].getBoundingClientRect().left;n+300>i.innerWidth&&n-300>0?r.right=!0:n-300<0||(r.right=!1)}var f,e,s;if(r.show=!1,r.right=!1,r.toggle=function(n){o();r.show=n?!1:!r.show},r.selectOption=function(n){for(var t=r.options.length;t--;)r.options[t].selected=!1;n.selected=!0;r.show=!1;r.ngModel=n},r.options){for(f=r.options.length;f--;)if(e=r.options[f],e.selected){r.selectOption(e);break}r.ngModel||r.selectOption(r.options[0])}s=r.$watch("ngModel.name",function(n){n&&r.closeOnChange&&r.toggle(!0)},!0);n(function(){o()});angular.element(i).bind("resize",function(){o()});u.bind("keydown keypress",function(n){n.which===t.ESC&&r.toggle(!0)})},template:'<span class="dropdown" ng-class="{\'dropdown--focus\': show, \'dropdown--right\': right}"><button type="button" class="dropdown__trigger" ng-click="toggle()">{{ ngModel.name }} <i class="icon-dropdown"><\/i><\/button><div class="dropdown__body"><div data-ng-if="!options" class="dropdown__content" ng-transclude ng-show="show"><\/div><div data-ng-if="options" class="dropdown__content" ng-show="show"><button type="button" class="dropdown__option" ng-repeat="item in options" ng-click="selectOption(item)" ng-class="{\'dropdown__option--selected\': item.selected}">{{ item.name }}<\/button><\/div><\/div><div class="dropdown__backdrop" ng-click="toggle()" ng-show="show"><\/div><\/span>'}}])}(),function(){"use strict";var n=angular.module("nas.brand");n.directive("norwegianError",["$state","templateBase",function(){return{restrict:"A",controller:"ErrorCtrl",controllerAs:"vm",template:'<section class="dialogue dialogue--error" data-ng-if="messageModel && messageModel.hasMessage"> <small>{{messageModel.timeStamp}}<\/small> <ul class="list list--image-list list--image-list--first" data-ng-class="{\'animation__pop-in-from-top\': enableAnimation}" data-ng-if="messageModel.messageList && messageModel.messageList.length > 0"> <li> <i class="icon-medium icon-medium--alert--error"><\/i> <h3 data-ng-bind="messageModel.header"><\/h3> <ul class="list list--icon-list"> <li data-ng-repeat="item in messageModel.messageList"> <p class="normal margin-bottom--none" data-ng-bind-html="item" role="alert"><\/p> <\/li> <\/ul> <\/li> <\/ul> <div class="margin-bottom--small" data-ng-if="messageModel.exception"> <button class="link" data-ng-click="showDetails = !showDetails"> <span data-ng-if="!showDetails">Show details<\/span> <span data-ng-if="showDetails">Hide details<\/span> <\/button> <hr data-ng-if="showDetails" /> <pre data-ng-if="showDetails">{{messageModel.exception | json}}<\/pre> <\/div> <\/section> '}}]);n.controller("ErrorCtrl",["$scope","$stateParams",function(n,t){n.messageModel=t.message}])}(),function(){"use strict";angular.module("nas.brand").directive("norwegianHeader",["templateBase",function(){return{restrict:"A",replace:!0,scope:{title:"=?",subtitle:"=?",breadcrumbtitle:"=?",breadcrumbState:"=",breadcrumbUrl:"=",breadcrumbAction:"="},controller:["$scope","$state","deviceSvc",function(n,t,i){n.isTravelAssistant=i.isTravelAssistant}],template:'<header class="page-cover"><div class="page-cover__content"><div class="page-cover__grid"><nav class="breadcrumbs" data-ng-if="breadcrumbtitle && !isTravelAssistant && (breadcrumbUrl || breadcrumbAction || breadcrumbState)"><span aria-hidden="true" class="icon-small icon-small--arrow-left"><\/span><a data-ng-if="breadcrumbState && !breadcrumbUrl && !breadcrumbAction" ui-sref="{{breadcrumbState}}" class="breadcrumbs__link">{{breadcrumbtitle}}<\/a><a data-ng-if="breadcrumbUrl && !breadcrumbState && !breadcrumbAction" data-ng-href="{{breadcrumbUrl}}" class="breadcrumbs__link">{{breadcrumbtitle}}<\/a><button data-ng-if="breadcrumbAction && !breadcrumbState && !breadcrumbUrl" data-ng-click="breadcrumbAction()" class="breadcrumbs__link">{{breadcrumbtitle}}<\/button><\/nav><div data-ng-if="!isTravelAssistant"><h1 class="page-cover__title" style="display: block">{{title}}<\/h1><h2 class="heading3" data-ng-if="subtitle">{{subtitle}}<\/h2><hr class="page-cover__divider"><\/div><\/div><\/div><\/header>'}}])}(),function(){"use strict";angular.module("nas.brand").directive("norwegianInfoBox",["$timeout","deviceSvc","smoothScroll",function(n,t,i){return{restrict:"A",replace:!0,scope:{items:"=?",header:"=",type:"=",showBox:"=?",showIcon:"=?",showList:"=?",showDismissIcon:"=?",action:"=?",actionLabel:"=?",timestamp:"=?",details:"=?"},link:function(r,u){r.showIcon=r.showIcon==undefined?!0:r.showIcon;r.showBox=r.showBox==undefined?!0:r.showBox;r.showDismissIcon=r.showDismissIcon==undefined?!0:r.showDismissIcon;r.expandDetails=!1;r.dismiss=function(){r.items=[]};r.showDetails=function(){r.expandDetails=!r.expandDetails};r.$watch("items",function(f){f&&f.length>0&&(r.enableAnimation=!t.height.lg(),n(function(){r.enableAnimation&&i(angular.element(u)[0],{offset:20});var n=angular.element(u)[0];n&&n.focus()},1e3))})},template:'<div data-ng-class="showBox ? (!type || type == \'information\' ? \'dialogue dialogue--information\' : \'dialogue dialogue--\' + type) : \'\'" data-ng-show="items && items.length > 0" style="position: relative;" tabindex="-1"><button aria-label="{{\'CloseButton\' | translate}}" data-ng-if="showBox && showDismissIcon" data-ng-click="dismiss()" class="button__close" style="border-bottom: 0; position:absolute; top:10px;right:10px;">&times;<\/button><ul data-ng-class="{\'list--image-list\': showBox && showIcon , \'list--image-list--first\': showBox && showIcon ,  \'animation__pop-in-from-top\': enableAnimation ,  \'list--icon-list\': !showbox || !showicon}" tabindex="-1"><li><i class="icon-medium"  aria-label="{{\'Warning\' | translate}}" data-ng-class="!type || type == \'information\' ? \'icon-medium--alert\' : \'icon-medium--alert--\' + type" data-ng-if="showIcon"><\/i><small>{{timestamp}}<\/small><div data-ng-show="items && header" role="alert"><h2 class="heading3" data-ng-if="items && header" data-ng-bind="header"><\/h3><\/div><ul class="list" data-ng-class="{  \'list--negative\': (showList || !showIcon) && type == \'error\',  \'list--markers\': (showList || !showIcon) && (!type || type == \'information\'),  \'list--positive\': (showList || !showIcon) && type== \'success\',  \'list--icon-list\': (!showList && showIcon) }"><li data-ng-repeat="item in items"><p class="normal margin-bottom--none" data-ng-bind-html="item" role="alert"><\/p><\/li><li data-ng-if="action && actionLabel"><button class="link" data-ng-click="action()">{{actionLabel}}<\/button><\/li><\/ul><button class="link" data-ng-click="showDetails()" data-ng-if="details && !expandDetails">Show details<\/button><button class="link" data-ng-click="showDetails()" data-ng-if="details && expandDetails">Hide details<\/button><\/li><li data-ng-if="details && expandDetails"><pre>{{details | json}}<\/pre><\/li><\/ul><\/div>'}}])}(),function(){"use strict";angular.module("nas.brand").directive("norwegianInlineDatePicker",["$timeout","keyCodes",function(n){return{scope:{label:"=",ngModel:"=",minDate:"=",maxDate:"=",iconClass:"=",datepickerMode:"=",minMode:"=",endSentence:"=",onChanged:"&",isAccessibilityMode:"="},link:function(t,i){var r=i[0];t.dateFormat="fullDate";t.datepickerMode==="month"&&(t.dateFormat="MMMM, y");t.toggleSuggestions=function(){t.showAutoSuggest=!t.showAutoSuggest;t.showAutoSuggest?n(function(){t.setFocus=!0},100):(t.setFocus=!1,n(function(){r.firstChild.focus()},100))}},template:'<span class="link-departure__wrapper link-departure__wrapper--small"><a href="" class="link-departure" data-ng-click="toggleSuggestions()"><span data-ng-bind="ngModel | date:dateFormat"><\/span> <i class="icon-dropdown"><\/i><\/a><div class="link-departure__overlay link-departure__overlay--small" data-ng-show="showAutoSuggest"><h2 class="link-departure__title">{{ lang.label }}<\/h2><input data-is-accessibility-mode="isAccessibilityMode" data-max-date="maxDate" data-min-date="minDate" data-min-mode="minMode" data-datepicker-mode="datepickerMode" data-on-close="toggleSuggestions()" data-set-focus="setFocus" norwegian-date-picker data-on-changed="onChanged()" data-icon-class="iconClass" data-ng-model="ngModel" data-label="label" /><\/div><span data-ng-if="endSentence">.<\/span><\/span>'}}])}(),function(){"use strict";angular.module("nas.brand").directive("norwegianInlineNav",["$window","$timeout",function(n){function t(n){var t=0;if(n.offsetParent)do t+=n.offsetTop;while(n=n.offsetParent);return t}return{transclude:!0,replace:!0,scope:{sidenav:"=",title:"@"},controller:["$scope",function(n){var t=n.links=[];this.addLink=function(n,i){n.element=i;t.push(n)}}],link:function(i,r){function h(){a();s=t(r[0]);o=y();v();c();i.offset=i.sidenav?0:r[0].offsetHeight;i.$apply()}function a(){i.contentWidth=i.sidenav?{width:r[0].offsetWidth+"px"}:{}}function v(){u=[];for(var n=i.links.length,f,o,e,s=r[0].offsetHeight+10;n--;)(e=document.getElementById(i.links[n].elementId),e)&&(f=t(e),o=f+e.offsetHeight,i.links[n].topPos&&(f=i.links[n].topPos),u.push({element:angular.element(i.links[n].element),from:f-s,to:o-s}))}function y(){if(i.stopBefore){var n=t(document.querySelector(i.stopBefore)),u=r[0].querySelector(".inline-nav__content").offsetHeight;return n-u-100}return!1}function c(){var i=n.pageYOffset,t;for(i>s?r.addClass("inline-nav--fixed"):r.removeClass("inline-nav--fixed"),o&&o<i?(r.removeClass("inline-nav--fixed"),r.css({top:o-l-10+"px"})):r.css({top:0}),t=u.length;t--;)i>u[t].from&&i<u[t].to?u[t].element.addClass("inline-nav__link--active"):u[t].element.removeClass("inline-nav__link--active")}var e=document.querySelectorAll("[inline-nav-content]"),f;for(i.elementList=[],f=0;f<e.length;f++)i.elementList.push({title:e[f].getAttribute("inline-nav-content"),id:e[f].getAttribute("id"),fromTop:e[f].hasAttribute("from-top")?"0":!1});i.sidenav&&(i.stopBefore=".page-footer");var s,o=!1,u=[],l=t(r[0]);i.contentWidth={};setInterval(function(){window.requestAnimationFrame(h)},300);angular.element(n).bind("scroll",function(){window.requestAnimationFrame(c)});angular.element(n).bind("resize",function(){h()})},template:'<nav class="inline-nav" ng-class="{\'inline-nav--box\': sidenav}"><div class="inline-nav__content" ng-style="contentWidth"><div class="grid"><h2 class="heading4 inline-nav__title" data-ng-if="title && sidenav">{{ title }}<\/h2><a inline-link="{{ item.id }}" offset="{{offset}}" href="#{{ item.id }}" ng-repeat="item in elementList" inline-link-top="{{ item.fromTop }}" modifier="-55">{{ item.title }}<\/a><\/div><\/div><\/nav>'}}]).directive("inlineLink",function(){return{require:"^norwegianInlineNav",transclude:!0,replace:!0,link:function(n,t,i,r){n.elementId=i.inlineLink;i.inlineLinkTop&&i.inlineLinkTop!="false"&&(n.topPos=i.inlineLinkTop);r.addLink(n,t)},template:'<a ng-transclude class="inline-nav__link" scroll-to="{{elementId}}"><\/a>'}})}(),function(){"use strict";angular.module("nas.brand").directive("norwegianInlineSimpleSelect",[function(){return{replace:!0,scope:{options:"=",ngModel:"=",label:"="},require:"^ngModel",template:'<span class="select select--inline"><select data-ng-attr-aria-label="{{label}}" select-autowidth data-ng-model="ngModel" data-ng-options="item.value as item.name for item in options"><\/select><\/span>'}}])}(),function(){"use strict";angular.module("nas.brand").directive("norwegianInlineSelect",["$timeout","keyCodes","$window",function(){return{scope:{options:"=",ngModel:"=",label:"="},require:"^ngModel",link:function(n){var t,i;if(n.selectOption=function(t){for(var i=n.options.length;i--;)n.options[i].value==t?(n.options[i].selected=!1,n.ngModel=n.options[i]):n.options[i].selected=!1},n.options){for(t=n.options.length;t--;)if(i=n.options[t],i.selected){n.ngModel=i;break}n.ngModel?n.ngModel&&(n.selectedOption=n.ngModel.value):n.selectedOption=n.options[0].value}n.update=function(){n.selectOption(n.selectedOption)}},template:'<span class="select select--inline"><select data-ng-attr-aria-label="{{label}}" select-autowidth data-ng-model="selectedOption" data-ng-change="update()"><option data-ng-repeat="item in options" value="{{item.value}}">{{item.name}}<\/option><\/select><\/span>'}}])}(),function(){"use strict";var n=angular.module("nas.brand");n.constant("keyCodes",{TAB:9,ENTER:13,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32})}(),function(){"use strict";angular.module("nas.brand").directive("norwegianLowfareCompact",["$filter","$timeout",function(n,t){return{replace:!0,scope:{fares:"=",loadingText:"=",loadingCallback:"&"},link:function(n,i){function l(){t(function(){r=0;u=i[0].getElementsByClassName("lowfare-compact__content")[0];e=i[0].getElementsByClassName("lowfare-compact__month");f={min:0,max:0};v();a();h();s();n.loading=!1;n.loadingCallback({loading:!1});n.$apply()})}function c(t){n.calendar.months.push({month:t,days:[]})}function a(){for(var t=n.calendar.months.length,i=0,r=n.calendar.months[0].days[0].amount>0?n.calendar.months[0].days[0].amount:999999,u=0;t--;)for(i=n.calendar.months[t].days.length;i--;)u=Math.max(n.calendar.months[t].days[i].amount,u),n.calendar.months[t].days[i].amount&&(r=Math.min(n.calendar.months[t].days[i].amount,r));f={min:r,max:u}}function o(){var n=i[0].getElementsByClassName("lowfare-compact__day"),t=n[0],r=n[n.length-1];return r.getBoundingClientRect().right-t.getBoundingClientRect().left+50}function s(){r+i[0].offsetWidth>=o()?i.addClass("lowfare-compact--block-right"):i.removeClass("lowfare-compact--block-right");r<=0?i.addClass("lowfare-compact--block-left"):i.removeClass("lowfare-compact--block-left");angular.element(u).css({transform:"translateX(-"+r+"px)","-webkit-transform":"translateX(-"+r+"px)","-moz-transform":"translateX(-"+r+"px)","-ms-transform":"translateX(-"+r+"px)"})}function v(){var t=u.querySelector("li a[aria-disabled=false]");t&&t.getBoundingClientRect().right>i[0].offsetWidth&&n.scrollRight(t.getBoundingClientRect().right)}function h(){for(var u,o,n,f,t,i,s=e.length;s--;)i=400,n=e[s],f=n.querySelector(".lowfare-compact__month-name"),u=n.offsetLeft-24,o=n.offsetWidth+n.offsetLeft,t=Math.min(n.offsetWidth-i,r-u),t>-i&&t<0&&(t=0),r>=u-i&&r<=o-i?(angular.element(n).addClass("lowfare-compact__month--active"),angular.element(f).css({transform:"translateX("+t+"px)","-webkit-transform":"translateX("+t+"px)","-moz-transform":"translateX("+t+"px)","-ms-transform":"translateX("+t+"px)"}).addClass("lowfare-compact__month-name--active")):(angular.element(n).removeClass("lowfare-compact__month--active"),angular.element(f).css({transform:"translateX(0)","-webkit-transform":"translateX(0)","-moz-transform":"translateX(0)","-ms-transform":"translateX(0)"}).addClass("lowfare-compact__month-name--active"))}n.loading=!0;n.loadingCallback({loading:!0});n.calendar={months:[]};var r=0,u=i[0].getElementsByClassName("lowfare-compact__content")[0],e=i[0].getElementsByClassName("lowfare-compact__month"),f={min:0,max:0};n.$watch("fares",function(i){n.calendar={months:[]};angular.isDefined(i)&&i.dates&&i.dates.length?t(function(){var e=new Date(i.dates[0].date),u=e.getMonth(),f=0,r,t;for(c(new Date(i.dates[0].date)),t=0;t<n.fares.dates.length;t++)r=new Date(n.fares.dates[t].date),u!=r.getMonth()&&(u=r.getMonth(),f++,c(r)),n.calendar.months[f].days.push(n.fares.dates[t]);l()}):(n.loading=!0,n.loadingCallback({loading:!0}))});n.getHeight=function(n){if(n.amount&&n.amount>0){var t=0,i=50,r=f.min,e=f.max,u;return t=Math.abs((r-n.amount)/(r-e)*100),u=isNaN(t)?i:Math.round(i+t*.8),{height:u+"px"}}};n.scrollRight=function(n){var t=r+i[0].offsetWidth,f=o();n&&(t=r+n);r=t+i[0].offsetWidth>f?f-i[0].offsetWidth:t;angular.element(u).css({transform:"translateX(-"+r+"px)","-webkit-transform":"translateX(-"+r+"px)","-moz-transform":"translateX(-"+r+"px)","-ms-transform":"translateX(-"+r+"px)"});h();s()};n.scrollLeft=function(n){var t=r-i[0].offsetWidth,f=o();n&&(t=r-n);r=t<=0?0:t;angular.element(u).css({transform:"translateX(-"+r+"px)","-webkit-transform":"translateX(-"+r+"px)","-moz-transform":"translateX(-"+r+"px)","-ms-transform":"translateX(-"+r+"px)"});h();s()};n.checkFocus=function(){var t=document.activeElement.getBoundingClientRect();t.left>i[0].offsetWidth-200?n.scrollRight(200):t.left<200&&n.scrollLeft(200)}},template:'<div class="lowfare-compact" ng-class="{\'lowfare-compact--loading\': loading}"><div class="lowfare-compact__content"><ul class="lowfare-compact__month" ng-repeat="month in calendar.months"><li class="lowfare-compact__month-name">{{ month.month | date:"MMMM" }}<\/li><li class="lowfare-compact__day" ng-repeat="day in month.days" ng-class="{\'lowfare-compact__day--cheapest\': day.isCheapestPrice}"><a ng-href="{{ day.amount > 0 ? fares.url + day.urlQueryString : \'\' }}" class="lowfare-compact__link" title="{{ day.title }}" ng-disabled="day.amount <= 0" ng-focus="checkFocus()"><div class="lowfare-compact__bar" ng-style="getHeight(day)"><div class="lowfare-compact__price" data-ng-if="day.amount > 0">{{ day.price }}<\/div><\/div><div class="lowfare-compact__date"><strong class="lowfare-compact__date__day">{{ day.date | date:"d" }}<\/strong>{{ day.date | date:"EEE" }}<\/div><\/a><\/li><\/ul><\/div><button class="lowfare-compact__show  lowfare-compact__show--right" ng-click="scrollRight()"><i class="icon-medium  icon-medium--arrow-right--light"><\/i><i class="icon-small  icon-small--arrow-right--light"><\/i><\/button><button class="lowfare-compact__show  lowfare-compact__show--left" ng-click="scrollLeft()"><i class="icon-medium  icon-medium--arrow-left--light"><\/i><i class="icon-small  icon-small--arrow-left--light"><\/i><\/button><div class="lowfare-compact__loading"><div class="preloader"><div class="preloader__border"><\/div><\/div><\/div><\/div>'}}])}(),function(){"use strict";angular.module("nas.brand").directive("norwegianNetworkStatus",[function(){return{restrict:"A",scope:{},controller:["$window","$timeout","$filter",function(n,t,i){var r=this;r.showOfflineNotification=!1;angular.element(n).bind("offline",function(){r.timestamp=i("outputDateTime")(new Date).toString();t(function(){r.showOfflineNotification=!0})});angular.element(n).bind("online",function(){t(function(){r.showOfflineNotification=!1})})}],controllerAs:"vm",template:'<div data-ng-if="vm.showOfflineNotification" class="loader"><div class="loader__background padding--none"><section class="dialogue dialogue--error margin-bottom--none"><ul class="animation__pop-in-from-top list list--image-list list--image-list--first"><li style="white-space: normal; text-align: left;"><i class="icon-medium icon-medium--alert--error"><\/i><small data-ng-bind="vm.timestamp"><\/small><h3 data-translate="BookingNoNetworkConnectionTitle"><\/h3><span data-translate="BookingNoNetworkConnectionMessage"><\/span><\/li><\/ul><\/section><\/div><\/div>'}}])}(),function(){"use strict";angular.module("nas.brand").directive("norwegianNotifier",["notifierSvc",function(n){return{restrict:"A",replace:!0,scope:{},template:'<div><div data-ng-repeat="notification in vm.notifications" data-norwegian-info-box data-header="notification.header" data-items="notification.items" data-type="notification.type" show-icon="notification.showIcon" show-box="notification.showBox" show-list="notification.showList" show-dismiss-icon="notification.showDismissIcon"><\/div><\/div>',controller:function(){var t=this;t.notifications=n.notifications;t.dismiss=function(){t.items=[]}},controllerAs:"vm"}}]).factory("notifierSvc",["$timeout","$rootScope",function(n,t){function r(t,r,f){(u=!0,n(function(){u=!1},2e3),r.type=t,r.showIcon=r.showIcon==undefined?!1:r.showIcon,f==!0&&e(r))||(i.push(r),r.timeout&&n(function(){i.splice(i.indexOf(r),1)},r.timeout*1e3))}function e(n){if(i.length==0||n.items==undefined||n.items.length==0)return!1;var t=_.find(i,function(t){return t.items&&t.items.length>0&&t.items[0]==n.items[0]});return t?!0:!1}function f(){i.length=0}var i=[],u=!1;return t.$on("showSuccessMessage",function(n,t){r("success",t,!1)}),t.$on("showInfoMessage",function(n,t){r("information",t,!1)}),t.$on("showInfoMessageUnique",function(n,t){r("information",t,!0)}),t.$on("showErrorMessage",function(n,t){r("error",t,!1)}),t.$on("hideMessage",function(n,t){var r,u;i.length>0&&(r=_.find(i,["items",t.items]),r&&(u=i.indexOf(r),i.splice(u,1)))}),t.$on("$stateChangeStart",function(){u||f()}),t.$on("clearMessages",function(){f()}),{addMessage:r,notifications:i}}])}(),function(){"use strict";angular.module("nas.brand").directive("norwegianNumberfield",["$timeout",function(n){return{replace:!0,scope:{ngModel:"=",label:"=",min:"=",max:"=",setFocus:"=",inputId:"@",minLabel:"=",maxLabel:"=",canAdd:"&",disabled:"=ngDisabled"},require:"^ngModel",link:function(t,i,r){function f(){n(function(){t.ngModel=Math.min(t.max,t.ngModel+1)})}function e(){n(function(){t.ngModel=Math.max(t.min,t.ngModel-1)})}function o(t){u||(u=!0,t(),n(function(){u=!1},300))}var s=i[0].querySelector(".numberfield__input"),u=!1;t.id=t.inputId?t.inputId:r.name?r.name:"numberfield";i.bind("keydown",function(n){event.keyCode==38||event.keyCode==39||event.keyCode==107?(f(),n.preventDefault()):(event.keyCode==37||event.keyCode==40||event.keyCode==109)&&(e(),n.preventDefault())});t.min=t.min||0;t.max=t.max||0;t.ngModel=t.ngModel||t.min;t.subtract=function(){o(e)};t.add=function(){var n=t.canAdd();n!==!1&&o(f)};t.$watch("ngModel",function(n){angular.isDefined(n)||(t.ngModel=t.max)});t.$watch("max",function(n){t.ngModel>n&&(t.ngModel=n)});t.$watch("setFocus",function(t){t&&n(function(){s.focus()})})},template:'<div class="numberfield"><label class="numberfield__title" for="{{ id }}" data-ng-if="label">{{ label }}<\/label><div class="numberfield__wrapper"><button type="button" class="numberfield__button numberfield__button--subtract" aria-controls="{{ id }}" ng-click="subtract()" data-ng-disabled="disabled || ngModel === min" data-ng-attr-tabindex="{{ngModel === min && \'-1\' || \'0\' }}"><i aria-label={{maxLabel}}  class="numberfield__icon-subtract"><\/i><\/button><input type="number" aria-live="assertive" ng-model="ngModel" class="numberfield__input" placeholder="{{ placeholder }}" min="{{ min }}" max="{{ max }}" name="{{ id }}" id="{{ id }}" data-ng-disabled="disabled" /><button type="button" class="numberfield__button  numberfield__button--add" aria-controls="{{ id }}" ng-click="add()" data-ng-disabled="disabled || ngModel === max" data-ng-attr-tabindex="{{ngModel === max && \'-1\' || \'0\' }}"><i aria-label={{minLabel}}  class="numberfield__icon-add"><\/i><\/button><div class="numberfield__line"><\/div><\/div><\/div>'}}])}(),function(){"use strict";var n=angular.module("nas.brand");n.config(["$httpProvider",function(n){n.interceptors.push("loadingStatusInterceptor")}]);n.directive("norwegianProgressSpinner",["$http","$window","$timeout","$rootScope",function(n,t,i,r){return{template:'<div aria-live="assertive"><div class="loader" data-ng-if="showProgress"><div class="loader__background"><div class="preloader"><div class="preloader__border"><\/div><\/div><h4 role="alert">{{header}}<\/h4><a data-ng-if="showRefreshButton" data-ng-click="refresh()" class="animation__pop-in-from-top">{{cancel}}<\/a><\/div><\/div><\/div>',replace:!0,link:function(u,f,e){function a(){u.wait||o()}function o(){u.showRefreshButton=!1;var n=h.pop();i.cancel(n);i.cancel(s);s=null;u.showProgress=!1;r.$broadcast("isInProgress",!1)}function l(){u.showRefreshButton=!0;s=null}function c(t,f){u.wait||(u.header=e.headerText,u.cancel=e.cancelText,f=f&&!isNaN(f)?f:1200,h.push(i(function(){u.showProgress=!0;r.$broadcast("isInProgress",!0);t&&t.name&&t.name==="$locationChangeStart"&&i(function(){n.pendingRequests.length===0&&o()},1e3);s||u.hideTimer||(s=i(function(){l()},12e3))},f)))}function v(){c(null,0)}function y(n,t,f,e){u.wait=!0;u.header=t;u.cancel=f;e=e&&!isNaN(e)?e:1200;h.push(i(function(){u.showProgress=!0;r.$broadcast("isInProgress",!0);u.showRefreshButton=!0;s=null},e))}u.showRefreshButton=!1;u.showProgress=!1;var h=[],s=null;u.refresh=function(){u.showRefreshButton=!1;location.reload()};u.$on("loadingStatusActive",c);u.$on("$locationChangeStart",c);u.$on("$stateChangeStart",v);u.$on("loadingStatusInactive",a);u.$on("$stateChangeSuccess",o);u.$on("$stateChangeError",o);u.$on("$locationChangeSuccess",o);u.$on("errorMessageTimeOut",l);u.$on("waitForAction",y);u.$on("actionCompleted",o);angular.element(t).bind("offline",o);o();u.$on("$destroy",function(){i.cancel(h)})}}}]);n.factory("loadingStatusInterceptor",["$q","$rootScope",function(n,t){var i=0,u=function(n){i===0&&n&&t.$broadcast("loadingStatusActive");i++},r=function(){i--;i===0&&t.$broadcast("loadingStatusInactive")};return{request:function(t){return u(!t.hideSpinner&&t.url.indexOf(".html")<0),t||n.when(t)},response:function(t){return r(),t||n.when(t)},responseError:function(t){return r(),n.reject(t)}}}])}(),function(){"use strict";angular.module("nas.brand").directive("responsiveTable",["$sce",function(n){return{restrict:"C",replace:!0,transclude:!0,link:function(t,i){var o=[],r,e,u,f;t.responsivetable=[];f=[];angular.element(document).ready(function(){var nt=i[0].getElementsByTagName("thead"),v=nt[0].querySelectorAll("tr"),g=0,s,y,h,p,c,w,l,b,k,a,d;if(v.length>1){for(s=v[0].querySelectorAll("td,th"),r=1;r<s.length;r++)for(s[r].innerText?f.push(s[r].innerText):f.push(s[r].textContent),y=1;y<s[r].colSpan;y++)f.push(null);g++}for(h=v[g].querySelectorAll("td,th"),r=1;r<h.length;r++)h[r].innerText?o.push(h[r].innerText):o.push(h[r].textContent);for(p=i[0].getElementsByTagName("tbody"),r=0;r<p.length;r++)for(c=p[r].getElementsByTagName("tr"),e=0;e<c.length;e++){for(w=c[e].querySelectorAll("th,td"),k=c[e].querySelectorAll("th"),l=[],a=1,k.length?b=n.trustAsHtml(k[0].innerHTML):(b="",a=0),u=a;u<w.length;u++)d=1,a==0&&(d=0),f.length&&f[u-1]&&l.push({title:f[u-1],description:"&nbsp;"}),l.push({title:o[u-d],description:n.trustAsHtml(w[u].innerHTML)});t.responsivetable.push({title:b,cols:l})}t.$apply()})},template:'<div><section class="box box--light is-visible--md"><table class="table" ng-transclude><\/table><\/section><section class="box box--light is-hidden--md"><div ng-repeat="item in responsivetable"><h3><span ng-bind-html="item.title"><\/span><\/h3><ul class="list  list--table--label-inline-double"><li ng-repeat="subitem in item.cols" data-ng-class="{\'noborder\' : !$first }"><strong ng-style="{ width: subitem.description == \'&nbsp;\' ? \'100%\' : \'inherit\' }">{{ subitem.title }}<\/strong><span ng-bind-html="subitem.description"><\/span><\/li><\/ul><\/div><\/section><\/div>'}}])}(),function(){"use strict";angular.module("nas.brand").directive("screenHeight",["$window","$timeout",function(n,t){return{link:function(i,r,u){var f,o=u.modifier?u.modifier:70,e=function(){n.innerWidth>959?(f=n.innerHeight-o,angular.element(r).css({"min-height":f+"px"})):angular.element(r).css({"min-height":""})};angular.element(n).bind("resize",function(){e()});t(function(){e()})}}}])}(),function(){"use strict";angular.module("nas.brand").directive("scrollSpy",["$window","$timeout",function(n,t){function i(n){var t=0;if(n.offsetParent)do t+=n.offsetTop;while(n=n.offsetParent);return t}return{replace:!0,transclude:!0,scope:{scrollSpy:"=",fromBottom:"="},link:function(r,u){function e(){o=c();h()}function c(){return r.fromBottom?i(f)-(window.innerHeight-500):i(f)-u[0].offsetHeight-4}function h(){s=n.pageYOffset;s>o?(r.scrollSpy=!0,r.$apply()):(r.scrollSpy=!1,r.$apply())}var l=u[0],o=99999999,s,f=document.createElement("div");u[0].parentNode.insertBefore(f,u[0].parentNode.childNodes[0]);t(function(){e()});setInterval(function(){e()},300);angular.element(n).bind("scroll",function(){window.requestAnimationFrame(h)});angular.element(n).bind("resize",function(){e()})},template:"<div><div data-ng-transclude><\/div><\/div>"}}])}(),function(){"use strict";angular.module("nas.brand").directive("scrollerTo",["scroller",function(n){function t(n){var t=0;if(n.offsetParent)do t+=n.offsetTop;while(n=n.offsetParent);return t}return{link:function(i,r,u){var f=u.modifier&&!isNaN(parseInt(u.modifier))?parseInt(u.modifier):0;angular.element(r).bind("click",function(i){if(navigator.userAgent.toLowerCase().indexOf("firefox")>-1||i.preventDefault(),u.scrollTo!="top"){var e=document.querySelector(u.href),r=t(e),o=r<100?r:r+f;n.scrollTo(document.body,o,300)}else n.scrollTo(document.body,0,300)})}}}])}(),function(){"use strict";angular.module("nas.brand").directive("selectAutowidth",["$timeout",function(n){return function(t,i){function r(){var n=angular.element("<select><\/select>").css({position:"absolute",top:"-10000px",left:"-10000px",maxWidth:"none",fontSize:getComputedStyle(i[0])["font-size"],fontFamily:getComputedStyle(i[0])["font-family"],fontWeight:getComputedStyle(i[0])["font-weight"],letterSpacing:getComputedStyle(i[0])["letter-spacing"],paddingTop:getComputedStyle(i[0])["padding-top"],paddingRight:getComputedStyle(i[0])["padding-right"],paddingBottom:getComputedStyle(i[0])["padding-bottom"],paddingLeft:getComputedStyle(i[0])["padding-left"],borderTop:getComputedStyle(i[0])["border-top"],borderRight:getComputedStyle(i[0])["border-right"],borderBottom:getComputedStyle(i[0])["border-bottom"],borderLeft:getComputedStyle(i[0])["border-left"]}),t=document.createElement("option"),r;t.value=u();t.innerHTML=u();n.append(t);angular.element(i[0].parentNode).append(n);r=n[0].getBoundingClientRect().width;r>0&&(i[0].style.width=+ 'px');n.remove()}function u(){if(i[0].selectedOptions&&i[0].selectedOptions.length)return i[0].selectedOptions[0].innerHTML;if(i[0].selectedIndex!==-1){var n=i[0].options[i[0].selectedIndex];return n.innerHTML}return i[0].value}i[0].addEventListener("change",function(){r()});r();n(r)}}])}(),function(){"use strict";angular.module("nas.brand").directive("setFocus",["$timeout","$parse",function(n,t){return{link:function(i,r,u){var f=t(u.setFocus);i.$watch(f,function(t){t===!0&&n(function(){r[0].focus()})});r.bind("blur",function(){i.$apply(f.assign(i,!1))})}}}])}(),function(){"use strict";angular.module("nas.brand").directive("simpleSuggest",["$timeout",function(n){return{replace:!0,scope:{transparent:"=",airportList:"=",preferredAirport:"=",user:"=",language:"=",small:"=",closeLabel:"=",endSentence:"=",displayCategory:"="},link:{pre:function(t,i){var u=i[0],r={value:angular.copy(t.user.preferredAirport),displayName:angular.copy(t.user.selectedAirportName)};t.lang=t.language||{placeholders:["Where from?","Your favourite airport?","Your starting point","Ready, set, go"],emptyText:"No matches",label:"Choose an airport"};t.user.preferredAirport=t.user.preferredAirport||t.preferredAirport;t.showAutoSuggest=!1;t.$watch("user",function(){t.user.preferredAirport&&(r={value:angular.copy(t.user.preferredAirport),displayName:angular.copy(t.user.selectedAirportName)})},!0);t.toggleSuggestions=function(){if(t.showAutoSuggest=!t.showAutoSuggest,t.showAutoSuggest)n(function(){var n=i[0].getElementsByClassName("link-departure__text");n[0].className="link-departure__text_toggle";t.setFocus=!0},100);else{var f=i[0].getElementsByClassName("link-departure__text_toggle");f[0].className="link-departure__text";t.setFocus=!1;n(function(){t.user.preferredAirport||(t.user.preferredAirport=r.value,t.user.selectedAirportName=r.displayName);u.firstChild.focus()},100)}}}},template:'<span class="link-departure__wrapper" data-ng-class="{\'link-departure__wrapper--small\': small}"><a href="" class="link-departure" data-ng-click="toggleSuggestions()"><div class="link-departure__text"> <span data-ng-bind="user.selectedAirportName"><\/span> <i data-ng-if="!small" class="icon-small icon-small--arrow-down"><\/i><i data-ng-if="small" class="icon-dropdown"><\/i><\/div><\/a><div class="link-departure__overlay" data-ng-show="showAutoSuggest" data-ng-class="{\'link-departure__overlay--small\': small}"><h2 class="link-departure__title">{{ lang.label }}<\/h2><input auto-suggest icon-class="\'icon-small--flight-departure\'" data-close-label="closeLabel" data-ng-model="user.preferredAirport" airports="airportList" set-focus="setFocus" displayname="user.selectedAirportName" on-close="toggleSuggestions()" placeholders="lang.placeholders" empty-text="lang.emptyText" label="lang.label" data-display-category="displayCategory" /><\/div><span data-ng-if="endSentence">.<\/span><\/span>'}}])}(),function(){"use strict";angular.module("nas.brand").directive("slider",["$document","$window","$timeout","$interval","keyCodes",function(n,t,i,r,u){return{replace:!0,scope:{ngModel:"=",value:"=",steps:"=",currency:"=",currencyPrefix:"=",labelMin:"=",labelMax:"=",compact:"="},link:function(n,f){function k(n,t){for(var u=t[0],f=Math.abs(n-u),e=0,r,i=0;i<t.length;i++)r=Math.abs(n-t[i]),r<=f&&(f=r,u=t[i],e=i);return e}function ut(){for(var t=f[0].getElementsByClassName("slider__value"),i=t.length,n=0;i--;)n=Math.max(t[i].offsetWidth,n);nt=n}function b(){n.value?(e=k(n.value,n.steps)*s,v(e),n.ngModel=h(e)):n.ngModel?(e=k(n.ngModel,n.steps)*s,v(e),n.ngModel=h(e)):(e=0,n.ngModel=h(e));n.displayValue=n.ngModel;ut()}function d(){w=a[0].offsetWidth;o=f[0].offsetWidth-w;s=o/(n.steps.length-1);b();n.$apply()}function tt(t){if(t&&f[0].offsetHeight)d();else if(!t&&f[0].offsetHeight)b();else var u=n.value,e=r(function(){f[0].offsetHeight&&(n.value=u,b(),i(function(){d();n.$apply()}),r.cancel(e))})}function h(t){return n.steps[Math.round(t*(n.steps.length-1)/o)]}function ft(t){var i=h(t);n.ngModel!=i&&n.$apply(function(){n.ngModel=i})}function it(t){var i=h(t);n.displayValue!=i&&n.$apply(function(){n.displayValue=i})}function v(i){a.css({transform:"translateX("+i+"px)","-moz-transform":"translateX("+i+"px)","-webkit-transform":"translateX("+i+"px)"});var e=p[0].offsetWidth/2,r=i-e+18,u=p[0].offsetWidth,f=a[0].offsetWidth;t.innerWidth<=o+u-f&&t.innerWidth>640&&!n.compact?r=Math.max(Math.min(r,o-80),-10):(t.innerWidth<=640||n.compact)&&(r=Math.max(Math.min(r,o-u+f+10),-10));p.css({transform:"translateX("+r+"px)","-moz-transform":"translateX("+r+"px)","-webkit-transform":"translateX("+r+"px)"})}function rt(n){e=Math.min(o,Math.max(0,n-g-w/2));a.addClass("slider__slide--active");p.addClass("slider__bubble--active");v(e);it(e)}function et(n){e=Math.min(o,Math.max(0,n-g-w/2));e=e>o-s/2?o:Math.round(e/s)*s;a.removeClass("slider__slide--active");p.removeClass("slider__bubble--active");v(e);ft(e);it(e)}var g,y,l=!1,e=0,a=angular.element(f[0].querySelector(".slider__slide")),p=angular.element(f[0].querySelector(".slider__bubble")),w=a[0].offsetWidth,o=f[0].offsetWidth-w,s=o/(n.steps.length-1),nt=0,c;n.min=n.steps[0];n.max=n.steps[n.steps.length-1];i(function(){tt()});i(function(){d()},300);n.$watch("value",function(){b()});n.$watch("steps",function(){b();i(function(){d()})});n.stepLeftPos=function(n,t){return t?{left:"auto"}:{left:n*s+"px"}};n.showStep=function(t){var i=!1;return t===0||t==n.steps.length-1?i=!0:nt+20<s?i=!0:Math.floor(n.steps.length/2)==t&&n.steps.length%2?i=!0:!(n.steps.length%2)&&(Math.floor(n.steps.length/3)==t||Math.floor(n.steps.length/3)*2+1==t),i};c={start:function(n){l=!0;g=f[0].getBoundingClientRect().left;y=n;rt(n)},move:function(n){y=n;rt(y)},end:function(n){l=!1;y=n;et(y)}};f.bind("keydown keypress",function(t){t.which===u.LEFT?(e=Math.max(k(n.ngModel,n.steps)-1,0)*s,v(e),n.ngModel=h(e),n.$apply()):t.which===u.RIGHT?(e=Math.min(k(n.ngModel,n.steps)+1,n.steps.length-1)*s,v(e),n.ngModel=h(e),n.$apply()):t.which===u.ESC&&f[0].blur()});f[0].addEventListener("touchstart",function(n){c.start(n.changedTouches[0].pageX);n.preventDefault()},!1);document.addEventListener("touchmove",function(n){l&&(c.move(n.changedTouches[0].pageX),n.preventDefault())},!1);document.addEventListener("touchend",function(n){l&&(c.end(n.changedTouches[0].pageX),n.preventDefault())},!1);f[0].addEventListener("mousedown",function(n){f[0].focus();c.start(n.pageX);n.preventDefault()},!1);document.addEventListener("mousemove",function(n){l&&(c.move(n.pageX),n.preventDefault())},!1);document.addEventListener("mouseup",function(n){l&&(c.end(n.pageX),n.preventDefault())},!1);angular.element(t).bind("resize",function(){tt(!0)})},template:'<div class="slider" aria-valuemin="{{min}}" aria-valuemax="{{max}}" aria-valuenow="{{displayValue}}" tabindex="0" role="slider" aria-controls="destinations"><div class="slider__slide"><i class="slider__slide__draghandle"><\/i><\/div><span class="slider__bubble"><span class="slider__bubble__value"><span data-ng-if="currency && currencyPrefix">{{ ( displayValue == max && labelMax ) ? "" : currency }}<\/span>{{ ( displayValue == max && labelMax ) ? labelMax : ( displayValue == min && labelMin ) ? labelMin : displayValue }}<span data-ng-if="currency && !currencyPrefix">{{ ( displayValue == max && labelMax ) ? "" : currency }}<\/span><\/span><\/span><span class="slider__value" data-ng-repeat="step in steps track by $index" data-ng-style="stepLeftPos($index, $last)" data-ng-class="{\'slider__value--first\': $first, \'slider__value--last\': $last}" data-ng-if="showStep($index)"><span data-ng-if="$last && labelMax">{{ labelMax }}<\/span><span data-ng-if="$first && labelMin">{{ labelMin }}<\/span><span data-ng-if="( !$first || !labelMin ) && ( !$last || !labelMax )"><span data-ng-if="currency && currencyPrefix">{{ currency }}<\/span>{{ step }}<span data-ng-if="currency && !currencyPrefix">{{ currency }}<\/span><\/span><\/span><\/div>'}}])}(),function(){"use strict";angular.module("nas.brand").directive("norwegianTimePicker",["$timeout","keyCodes",function(){return{replace:!0,scope:{label:"=",ngModel:"="},link:function(n,t,i){n.name=i.name||"";n.label=n.label;n.selectedTime=new Date(n.ngModel);n.getClass=function(n,t){return t};n.$watch("selectedTime",function(){n.ngModel=new Date(n.selectedTime)})},template:'<div class="calendarTime"><div data-uib-timepicker data-ng-model="selectedTime" class="ui-timepicker" name="{{name}}" data-hour-step="1" data-minute-step="30" show-meridian="false"><\/div><\/div>'}}])}(),function(){"use strict";var n=angular.module("nas.core");n.directive("nasApiRequestVerificationToken",["$http",function(n){return function(t,i,r){n.defaults.headers.common.ApiRequestVerificationToken=r.nasApiRequestVerificationToken||"no token"}}])}(),function(){"use strict";var n=angular.module("nas.core");n.directive("autoFocus",["$timeout",function(n){return{restrict:"AC",link:function(t,i,r){n(function(){(!r.autoFocus||t.$eval(r.autoFocus))&&i[0].focus()},500)}}}])}(),function(){"use strict";var n=angular.module("nas.core");n.directive("nasBookingReference",["templateBase",function(n){return{restrict:"A",replace:!0,templateUrl:n+"templates/booking.reference.tpl.html",scope:{reference:"="}}}])}();angular.module("checklist-model",[]).directive("checklistModel",["$parse","$compile",function(n,t){function i(n,t,i){if(angular.isArray(n))for(var r=n.length;r--;)if(i(n[r],t))return!0;return!1}function r(n,t,r){return n=angular.isArray(n)?n:[],i(n,t,r)||n.push(t),n}function u(n,t,i){if(angular.isArray(n))for(var r=n.length;r--;)if(i(n[r],t)){n.splice(r,1);break}return n}function f(f,e,o){function w(n,t){var i=a(f.$parent);angular.isFunction(v)&&(t===!0?v(f.$parent,r(i,n,s)):v(f.$parent,u(i,n,s)))}function b(n){if(c&&c(f)===!1){w(l,f[o.ngModel]);return}f[o.ngModel]=i(n,l,s)}var h=o.checklistModel,y;o.$set("checklistModel",null);t(e)(f);o.$set("checklistModel",h);var a=n(h),v=a.assign,p=n(o.checklistChange),c=n(o.checklistBeforeChange),l=o.checklistValue?n(o.checklistValue)(f.$parent):o.value,s=angular.equals;o.hasOwnProperty("checklistComparator")&&(o.checklistComparator[0]=="."?(y=o.checklistComparator.substring(1),s=function(n,t){return n[y]===t[y]}):s=n(o.checklistComparator)(f.$parent));f.$watch(o.ngModel,function(n,t){if(n!==t){if(c&&c(f)===!1){f[o.ngModel]=i(a(f.$parent),l,s);return}w(l,n);p&&p(f)}});angular.isFunction(f.$parent.$watchCollection)?f.$parent.$watchCollection(h,b):f.$parent.$watch(h,b,!0)}return{restrict:"A",priority:1e3,terminal:!0,scope:!0,compile:function(n,t){if((n[0].tagName!=="INPUT"||t.type!=="checkbox")&&n[0].tagName!=="MD-CHECKBOX"&&!t.btnCheckbox)throw'checklist-model should be applied to `input[type="checkbox"]` or `md-checkbox`.';if(!t.checklistValue&&!t.value)throw"You should provide `value` or `checklist-value`.";return t.ngModel||t.$set("ngModel","checked"),f}}}]),function(){"use strict";var n=angular.module("nas.core");n.config(["$httpProvider",function(n){n.interceptors.push("checkUserAgentInterceptor")}]);n.factory("checkUserAgentInterceptor",[function(){return{request:function(n){return n.checkUserAgent&&(n.headers.CheckUserAgent="true"),n}}}])}(),function(){"use strict";var n=angular.module("nas.core");n.factory("deviceSvc",function(){var i=parseInt((/WebKit\/([0-9]+)/.exec(navigator.appVersion)||0)[1],10)||void 0,r=navigator.userAgent.indexOf("TravelAssistant")!=-1,n=navigator.userAgent.indexOf("Android")!=-1,u=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,f=n&&i<=534&&navigator.vendor.indexOf("Google")>=0,t=navigator.userAgent.indexOf("Chrome")!=-1,e=navigator.userAgent.indexOf("Safari")!=-1&&!t;return{height:{md:function(){return Modernizr.mq("(min-height: 380px)")},lg:function(){return Modernizr.mq("(min-height: 668px)")},xl:function(){return Modernizr.mq("(min-height: 924px)")}},width:{md:function(){return Modernizr.mq("(min-width: 640px)")},lg:function(){return Modernizr.mq("(min-width: 1000px)")},xl:function(){return Modernizr.mq("(min-width: 1280px)")}},isTravelAssistant:r,isNativeAndroid:f,isAndroid:n,isIos:u,isChrome:t,isSafari:e}});n.provider("device",function(){this._device={};this.$get=["deviceSvc",function(n){var t=new Device(n);return t.setDevice(this._device),t}];this.setDevice=function(n){this._device=n}})}(),function(){"use strict";var n=angular.module("nas.core");n.factory("domutilsSvc",function(){function t(n,i){if(!n)return null;if(n.nodeName||(n=n[0]),i[0]==="."){if(_.includes(n.classList,i.slice(1)))return n}else if(n.nodeName.toLowerCase()===i)return n;return t(n.parentNode,i)}function i(n,t){var u=[],f,i,r;if(!n)return null;if(n.nodeName||(n=n[0]),t[0]==="."){for(f=t.slice(1),i=n.previousElementSibling;i;)_.includes(i.classList,f)&&u.push(i),i=i.previousElementSibling;for(r=n.nextElementSibling;r;)_.includes(r.classList,f)&&u.push(r),r=r.previousElementSibling}return u}function n(t,i){if(!t)return null;if(t.nodeName||(t=t[0]),i.tag)if(t.tagName.toLowerCase()===i.tag){if(i.type)if(t.attributes.type&&t.attributes.type===i.type){if(i.classname)return _.includes(t.classList,i.classname)?t:n(t.children[0],i)}else return n(t.children[0],i)}else return n(t.children[0],i)}return{closest:t,siblings:i,find:n}})}(),function(){"use strict";var n=angular.module("nas.core"),t="nas-refreshAttempted";n.config(["$httpProvider",function(n){n.interceptors.push("errorHandlerHttpInterceptor")}]);n.factory("alertSvc",["$sessionStorage",function(n){return{getError:function(){return n.error},setError:function(t){n.error=t},reset:function(){n.error=null}}}]);n.factory("errorHandlerHttpInterceptor",["$q","$rootScope","$window","alertSvc",function(n,i,r,u){function f(n,t){var r=n.data.exceptionDetails||n.data;r&&(r.hasMessage||r.Message)&&i.$broadcast(t?"errorMessageUnrecoverable":"errorMessageShow",r)}function e(n){f(n)}function o(n){f(n,!0)}return{response:function(t){if(t.data&&t.data.messageModel){var r=_.map(t.data.messageModel.messageItemList,function(n){return n.text});i.$broadcast("showInfoMessage",{items:r})}return t||n.when(t)},responseError:function(f){if(f.status==0&&i.$broadcast("errorMessageTimeOut"),f.status>=400&&f.status<500){if(!f.config.custom400handling){if(f.data.redirect)return u.setError(f.data.message),r.location.replace(f.data.redirect),n.reject(f);e(f)}}else if(f.status>=500){if(f.data&&f.data.attemptRefresh){var s=window.sessionStorage.getItem(t);s||(window.sessionStorage.setItem(t,!0),window.location.reload())}f.config.custom500handling||f.status==503||o(f)}return n.reject(f)}}}])}(),function(){"use strict";var t=angular.module("nas.core"),n="nas-refreshAttempted";t.directive("nasErrorMessage",["$sce","$window","$timeout","$rootScope","smoothScroll","bootstrappedData","templateBase","alertSvc",function(t,i,r,u,f,e,o,s){return{templateUrl:o+"core/errorMessage.tpl.html",replace:!0,link:function(i,o){function h(){i.enableAnimation=!0;o&&(o.tagName||o[0].tagName)&&o.css("display","block");f(document.getElementsByTagName("body")[0],{duration:400});r(function(){i.enableAnimation=!1},500)}function c(){i.messageModel="";o&&o[0].style&&o.css("display","none")}function l(){var t=window.sessionStorage.getItem(n);t&&setTimeout(function(){window.sessionStorage.removeItem(n)},1e4)}i.trustAsHtml=t.trustAsHtml;i.fromJson=angular.fromJson;l();i.$on("errorMessageShow",function(n,t){n.defaultPrevented||(n.preventDefault(),r(function(){i.messageModel=t;h()}))});i.$on("errorMessageUnrecoverable",function(n,t){n.defaultPrevented||(n.preventDefault(),t.unrecoverable=!0,r(function(){i.messageModel=t;h()}))});i.$on("errorMessageHide",c);i.$on("$stateChangeStart",c);i.$on("$stateChangeSuccess",function(){var n=s.getError();n&&(i.messageModel=n,h(),s.reset())});c();e&&e.pageModel&&(e.pageModel.messageType==="Error"||e.pageModel.messageType==="Warn")&&!e.pageModel.isErrorHandled&&r(function(){var n=e.pageModel;u.$broadcast(n.messageType==="Error"?"showErrorMessage":"showInfoMessage",{items:n.messageList,header:n.header,timestamp:n.timeStamp,details:n.exception})},1e3)}}}])}(),function(){"use strict";var n=angular.module("nas.core");n.directive("nasFileDownload",["$http","deviceSvc",function(n,t){return{link:function(i,r,u){function o(){var r=u.url;r.indexOf("ApiRequestVerificationToken")==-1&&(r=r+"&ApiRequestVerificationToken="+n.defaults.headers.common.ApiRequestVerificationToken);e(r);return}function f(n,t){var i,r;try{i=new Blob([n],{type:t})}catch(u){window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;u.name=="TypeError"&&window.BlobBuilder?(r=new BlobBuilder,r.append(n),i=r.getBlob(t)):i=u.name=="InvalidStateError"?new Blob([n],{type:t}):undefined}return i}function e(n){window.open(n,"_blank")}function s(n){var t=window.document.createElement("a"),i;t.target="_blank";t.href=n;i=window.document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null);t.dispatchEvent(i)}function h(n){return Array.prototype.map.call(n,function(n){return String.fromCharCode(n)}).join("")}r.bind("click",function(){o()})}}}])}(),function(){"use strict";var n=angular.module("nas.core");n.directive("nasFocusScroll",["$timeout","deviceSvc","smoothScroll","domutilsSvc",function(n,t,i,r){return{scope:{},replace:!1,restrict:"EA",link:function(u,f){var e=function(){if(!f[0].id)return null;var t=document.getElementsByTagName("label"),n=_.filter(t,function(n){var t=_.find(n.attributes,function(n){return n.name==="for"});return t?t.value===f[0].id:!1});return n.length>0&&n||null},o=function(){var n=r.closest(f[0],"label");return n&&n.length>0||null};f.on("focus",function(){if(!(f.length<=0)){var r=e()||o()||f;!r||t.isTravelAssistant||t.height.lg()||n(function(){i(r[0],{offset:30,easing:"easeOutQuart",duration:400})})}})}}}])}(),function(){"use strict";var n=angular.module("nas.core");n.directive("compareTo",function(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(n,t,i,r){r.$validators.compareTo=function(t){return t==n.otherModelValue};n.$watch("otherModelValue",function(){r.$validate()})}}});n.directive("accessibleForm",["$timeout","formValidation",function(n,t){return{restrict:"A",link:function(i,r,u){function s(){var n=[],t=angular.element(f.getElementsByClassName("pickerror"));return _.each(t,function(t){n.push(t.innerText)}),n}function o(){n(function(){i.$emit("clearMessages");i.$emit("showErrorMessage",{items:s()})})}var e=u.enableErrorMessagePropagation,f=r[0];r.on("submit",function(){t.setFocusOnFirstInvalidElement(f);e&&o()});i.$on("inputFocus",function(n,i){u.name===i&&t.setFocusOnFirstInvalidElement(f)});i.$on("serverErrors",function(){e&&o()})}}}]);n.factory("formValidation",["$rootScope",function(n){function i(n){return n.$$parentForm instanceof n.constructor?i(n.$$parentForm):n}function r(n){var t=n.tagName==="INPUT"?n:n.getElementsByTagName("input")[0],i=n.tagName==="FORM"?n:n.getElementsByTagName("form")[0];return t?t.form:i?i:undefined}function u(n,t,i){n[t].$setValidity("server",!1);n[t].$error.server=typeof n[t].$error.server=="boolean"?i:n[t].$error.server.concat(i)}var t=function(i){var r,u;if(i.querySelector)r=i.querySelector(".ng-invalid"),r&&(r.nodeName==="FIELDSET"||r.nodeName==="FORM"||r.nodeName==="DIV"?t(r):r.focus());else for(u in i)if(u&&u.indexOf("$")!==0&&i[u].$invalid){n.$broadcast("inputFocus",i.$name);break}};return{setFocusOnFirstInvalidElement:t,findTopLevelForm:i,findFormElement:r,setFieldError:u}}]);n.directive("form",function(){return{restrict:"E",link:function(n,t,i){t.on("submit",function(){n.$broadcast(i.name+":submit")})}}});n.directive("ngModel",["$timeout",function(n){return{restrict:"A",require:"ngModel",link:function(t,i,r,u){function f(){n(function(){u.$setValidity("server",!0)})}i.on("blur",f);u.clearServerErrors=f}}}])}(),function(){"use strict";function t(n){return function(t){return{restrict:"A",transclude:!0,template:n,link:function(n){n.isTravelAssistant=t.isTravelAssistant}}}}var n=angular.module("nas.core");n.directive("ifTravelAssistant",["deviceSvc",t('<div data-ng-if="isTravelAssistant" data-ng-transclude><\/div>')]);n.directive("ifNotTravelAssistant",["deviceSvc",t('<div data-ng-if="!isTravelAssistant" data-ng-transclude><\/div>')])}(),function(){"use strict";var n=angular.module("nas.core");n.constant("keyCodes",{TAB:9,ENTER:13,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32})}(),function(){"use strict";angular.module("nas.core").factory("languageInterceptor",["nasConfig",function(n){return{request:function(t){return t.url.match(/\.html$/)===null&&(t.params||(t.params={}),t.params.culture=n.culture),t}}}])}(),function(){"use strict";var n=angular.module("nas.core");n.factory("optionUtilsSvc",function(){var n={};return n.getOptionByValue=function(n,t,i){i=i||"value";var r=null;return n&&t&&(r=_.filter(n,function(n){return _.isEqual(n[i],t)})[0]),n&&!r&&(r=""),r},n.getSelectedOption=function(n){if(!n)return null;var t=_.filter(n,function(n){return n.selected})[0];return t||(t=n[0]),t},n.resetSelectedOptions=function(n){n&&_.forEach(n,function(n){n.selected=!1})},n})}(),function(){"use strict";angular.module("nas.core").controller("PageCtrl",["$scope","$http","$cookies","nasConfig","sitemapSvc","layoutConfig","deviceSvc",function(n,t,i,r,u,f,e){function h(){n.displayCookieDisabledBox=n.activateCookieDisabledBox&&n.shouldDisplayCookieDisabledBox;n.displayCookieDisplayMode=!e.isTravelAssistant&&n.activateCookieDisplayMode&&n.shouldDispladisplayInformationBoxyCookieDisplayMode&&!n.shouldDisplayCookieDisabledBox;n.displayCookieDisclaimer=n.activateCookieDisclaimer&&n.shouldDisplayCookieDisclaimer&&!n.shouldDisplayCookieDisabledBox;n.displayInformationBox=n.displayCookieDisabledBox||n.displayCookieDisplayMode||n.displayCookieDisclaimer}var s,o;n.isBusy=!1;n.culture=r.culture;n.activateCookieDisplayMode=f.activateCookieDisplayMode;n.activateCookieDisabledBox=f.activateCookieDisabledBox;n.activateCookieDisclaimer=f.activateCookieDisclaimer;n.shouldDisplayCookieDisclaimer=!0;n.shouldDisplayCookieDisabledBox=!navigator.cookieEnabled;n.shouldDisplayCookieDisplayMode=!1;n.accessibilityMode=!1;h();n.$watchGroup(["shouldDisplayCookieDisabledBox","shouldDisplayCookieDisplayMode","shouldDisplayCookieDisclaimer"],function(){h()});r.cookies.overrideAcceptDisclaimerCookie&&(s=i.get(r.cookies.overrideAcceptDisclaimerCookie.name),s&&s===r.cookies.overrideAcceptDisclaimerCookie.value&&(n.shouldDisplayCookieDisclaimer=!1));r.cookies.overrideDisplayModeCookie&&(o=i.get(r.cookies.overrideDisplayModeCookie.name),o&&o===r.cookies.overrideDisplayModeCookie.valueMobile&&(n.accessibilityMode=!e.isTravelAssistant),o&&o===r.cookies.overrideDisplayModeCookie.valueDesktop&&(n.shouldDisplayCookieDisplayMode=!0,n.accessibilityMode=!1));n.showAccesabilityLink=function(){if(r.cookies.overrideDisplayModeCookie){var n=i.get(r.cookies.overrideDisplayModeCookie.name);if(n&&n===r.cookies.overrideDisplayModeCookie.valueMobile)return!1}return!0};n.acceptCookie=function(){i.put(r.cookies.overrideAcceptDisclaimerCookie.name,r.cookies.overrideAcceptDisclaimerCookie.value,{path:"/",expires:new Date(2099,1,1)});n.shouldDisplayCookieDisclaimer=!1};n.navigateToUseOfCookiesPage=function(){window.location.href=u.get("pageUrlUseOfCookies")};n.removeDisplayModeCookie=function(){i.remove(r.cookies.overrideDisplayModeCookie.name,{path:"/"});n.shouldDisplayCookieDisplayMode=!1;n.accessibilityMode=!1};n.$on("isInProgress",function(t,i){n.isBusy=i})}])}(),function(){"use strict";var n=angular.module("nas.core");n.config(["$httpProvider",function(n){n.interceptors.push("loadingStatusInterceptor")}]);n.directive("nasProgressSpinner",["$http","$window","$timeout","$rootScope","templateBase",function(n,t,i,r,u){return{templateUrl:u+"core/progressSpinner.tpl.html",replace:!0,link:function(u){function f(){u.showRefreshButton=!1;var n=o.pop();i.cancel(n);i.cancel(e);e=null;u.showProgress=!1;r.$broadcast("isInProgress",!1)}function h(){u.showRefreshButton=!0;e=null}function s(t,s){s=s&&!isNaN(s)?s:1200;o.push(i(function(){u.showProgress=!0;r.$broadcast("isInProgress",!0);t&&t.name&&t.name==="$locationChangeStart"&&i(function(){n.pendingRequests.length===0&&f()},1e3);e||(e=i(function(){h()},12e3))},s))}function c(){s(null,0)}u.showRefreshButton=!1;u.showProgress=!1;var o=[],e=null;u.refresh=function(){u.showRefreshButton=!1;location.reload()};u.$on("loadingStatusActive",s);u.$on("$locationChangeStart",s);u.$on("$stateChangeStart",c);u.$on("loadingStatusInactive",f);u.$on("$stateChangeSuccess",f);u.$on("$stateChangeError",f);u.$on("$locationChangeSuccess",f);u.$on("errorMessageTimeOut",h);angular.element(t).bind("offline",f);f();u.$on("$destroy",function(){i.cancel(o)})}}}]);n.factory("loadingStatusInterceptor",["$q","$rootScope",function(n,t){var i=0,u=function(n){i===0&&n&&t.$broadcast("loadingStatusActive");i++},r=function(){i--;i===0&&t.$broadcast("loadingStatusInactive")};return{request:function(t){return u(!t.hideSpinner&&t.url.indexOf(".html")<0),t||n.when(t)},response:function(t){return r(),t||n.when(t)},responseError:function(t){return r(),n.reject(t)}}}])}(),function(){"use strict";angular.module("nas.core").service("reservationUrlSvc",["sitemapSvc",function(n){this.getReservationUrl=function(t){var i=n.get("pageUrlProfileMyReservation")+"?pnr="+t.pnr;return t.pnrLocal&&(i+="&pnrLocal="+t.pnrLocal),t.pnrName&&(i+="&pnrName="+t.pnrName),i}}])}(),function(){"use strict";angular.module("nas.core").factory("scroller",function(){function t(t,i,r){var f=typeof t.scrollTop=="function"?t.scrollTop():t.scrollTop;var s=i-f,u=0,e=20,o=function(){u+=e;var i=n(u,f,s,r);typeof t.scrollTop=="function"?t.scrollTop(i):t.scrollTop=i;u<r&&setTimeout(o,e)};o()}var n=function(n,t,i,r){return(n/=r/2,n<1)?i/2*n*n+t:(n--,-i/2*(n*(n-2)-1)+t)};return{scrollTo:t}})}(),function(){"use strict";angular.module("nas.core").run(["$rootScope","smoothScroll",function(n,t){var i;n.$on("$locationChangeStart",function(r,u,f){n.skipScrollOnRouteChange||i&&i===u||(i=f,t(document.getElementsByTagName("body")[0]))})}])}(),function(){"use strict";var n=angular.module("nas.core");n.factory("sitelanguagesRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/sitelanguages",{},{get:{method:"GET",isArray:!0}})}])}(),function(){"use strict";angular.module("nas.core").factory("sitemapSvc",["instantSiteMap","$cookies","nasConfig",function(n,t,i){function u(n){var u=t.get(i.cookies.overrideDisplayModeCookie.name);return(!u||u!==i.cookies.overrideDisplayModeCookie.valueDesktop)&&r[n+"Responsive"]?r[n+"Responsive"]:r[n]}var r={};return n&&(r=n),{get:u}}])}(),function(){"use strict";var n=angular.module("nas.core");n.factory("stringutils",function(){function n(n){return _(arguments).tail().forEach(function(t,i){var r=new RegExp("\\{"+i+"\\}","g");n=n.replace(r,t)}),n}return{format:n}})}(),function(){"use strict";var n=angular.module("nas.core");n.directive("nasTooltip",["$document","templateBase",function(n,t){return{restrict:"A",replace:!0,transclude:!0,scope:{tooltiplabel:"="},controller:["$scope",function(n){n.showTooltip=!1;n.toggleTooltip=function(){n.showTooltip=!n.showTooltip}}],link:function(t,i){i.bind("click",function(n){n.stopPropagation()});n.bind("click",function(){t.$apply(function(){t.showTooltip=!1})})},templateUrl:t+"core/tooltip.tpl.html"}}])}(),function(){"use strict";var n=angular.module("nas.core");n.factory("urlHelper",function(){function t(n){var i=[],t;for(t in n)n.hasOwnProperty(t)&&i.push(t);return i.sort()}function i(n,i,r){for(var f=t(n),u=0;u<f.length;u++)i.call(r,n[f[u]],f[u]);return f}function n(n,t){return encodeURIComponent(n).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,t?"%20":"+")}function r(t,r){if(!r)return t;var u=[];return i(r,function(t,i){t===null||angular.isUndefined(t)||angular.equals({},t)||(angular.isArray(t)||(t=[t]),angular.forEach(t,function(t){angular.isObject(t)&&(t=angular.toJson(t));u.push(n(i)+"="+n(t))}))}),t+(t.indexOf("?")===-1?"?":"&")+u.join("&")}function u(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=window.location.search?window.location.search:window.location.hash,r=new RegExp("[\\?&]"+n+"=([^&#]*)","gi"),t=r.exec(i);return t===null?"":decodeURIComponent(t[1].replace(/\+/g," "))}function f(n){n.indexOf("?")>-1&&(n=n.substring(n.indexOf("?")+1));n.indexOf("#")>-1&&(n=n.substring(0,n.indexOf("#")));for(var t,r=/([^&=]+)=?([^&]*)/g,i={};t=r.exec(n);)i[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return i}return{buildUrl:r,getQuerystringParameter:u,parseQuerystring:f}})}(),function(){"use strict";var n=angular.module("nas.modals");n.controller("ConfirmModalCtrl",["$uibModalInstance",function(n){var t=this;t.ok=function(){n.close()};t.cancel=function(){n.dismiss("cancel")}}])}(),function(){"use strict";angular.module("nas.modals").factory("confirmModalSvc",["$uibModal",function(n){function t(t){return n.open({templateUrl:t,controller:"ConfirmModalCtrl",controllerAs:"vm",size:"lg"})}return{open:t}}])}(),function(){"use strict";angular.module("nas.modals").controller("InfoModalCtrl",["$scope","$uibModalInstance","$translate","smoothScroll","content","header",function(n,t,i,r,u,f){n.header=f;n.content=u;n.cancel=function(){t.dismiss("cancel")};n.scrollTo=function(n){var t=document.getElementById(n);r(t||document.getElementsByClassName("modal-dialog")[0],{duration:400,containerId:"modal"});t&&(t.nodeName==="A"&&t.text===""?t.tabIndex=0:(t.nodeName==="P"||t.nodeName==="TD")&&(t.tabIndex=0),t.focus())};n.closelabel=i.instant("CloseButton")}]).directive("nasDynamic",["$compile",function(n){return{restrict:"A",replace:!0,link:function(t,i,r){document.getElementsByClassName("modal")[0].id="modal";t.$watch(r.nasDynamic,function(r){i.html(r);n(i.contents())(t)})}}}])}(),function(){"use strict";angular.module("nas.modals").factory("infoModal",["$uibModal","$window","$q","$http","$sce","$translate","templateBase",function(n,t,i,r,u,f,e){function h(f,e,h){f?n.open({templateUrl:o,controller:"InfoModalCtrl",size:h,resolve:{content:function(){var e=new DOMParser,n=i.defer();return r.get(f).success(function(i){var r,o,s,h,c;f.indexOf("://")<0&&(f=f.charAt(0)==="/"?t.location.origin+f:t.location.origin+"/"+f);try{o=e.parseFromString(i,"text/html");r=o.getElementById("mainbodycontentbox")}catch(l){}r?(s=angular.element(r).find("a"),_.forEach(s,function(n){var t=n.getAttribute("href");t&&t[0]==="#"&&(n.setAttribute("data-ng-click","scrollTo('"+t.slice(1)+"')"),n.setAttribute("href",""))}),n.resolve(u.trustAsHtml(r.innerHTML))):(h=i.split("<!--START_MAIN_CONTENT-->"),c=h[1].split("<!--END_MAIN_CONTENT-->"),n.resolve(u.trustAsHtml(c[0])))}).error(function(t){n.reject(t)}),n.promise},header:s(e)}}):console.log("openModal: url is null, nothing to show.")}function c(t,i,r){n.open({templateUrl:o,controller:"InfoModalCtrl",size:r,resolve:{content:function(){return u.trustAsHtml(t)},header:s(i)}})}var o=e+"modals/infoModal.tpl.html",s=function(n){var t=i.defer();return n?f(n).then(function(n){t.resolve(n)})["catch"](function(){t.resolve(n)}):t.resolve(" "),t.promise};return{open:h,openText:c}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasKeyNavigation",["keyCodes",function(n){return{restrict:"EA",scope:{tabcallback:"&"},link:function(t,i){var u=i[0],r;u&&(r=u.querySelectorAll("a"),t.numberoftabs=r.length,angular.forEach(r,function(i){angular.element(i).on("keydown keypress",function(i){var u=i.target.attributes["data-tabnumber"],r;u&&u.value&&(r=parseInt(u.value,0),(i.which===n.LEFT||i.which===n.UP)&&(r=r>1?r-1:1,t.$apply(t.tabcallback({number:r}))),(i.which===n.RIGHT||i.which===n.DOWN)&&(r=r===t.numberoftabs?t.numberoftabs:r+1,t.$apply(t.tabcallback({number:r}))))})}))}}}])}(),function(){"use strict";var n=angular.module("nas.shared"),t=React.createClass({displayName:"nas-select",propTypes:{items:React.PropTypes.array.isRequired,displayProp:React.PropTypes.string,valueProp:React.PropTypes.string,emptyOption:React.PropTypes.string,label:React.PropTypes.string,id:React.PropTypes.string,ngModel:React.PropTypes.node,ngModelCtrl:React.PropTypes.object,props:React.PropTypes.object,onChange:React.PropTypes.func,disabled:React.PropTypes.bool},render:function(){function y(t){n.$setViewValue(t.target.value);e&&e(t.target.value)}function p(){n.clearServerErrors&&n.clearServerErrors()}var c=this.props.items,t=this.props.displayProp,i=this.props.valueProp,r=this.props.emptyOption,l=this.props.ngModel,u=this.props.label,f=this.props.id,e=this.props.onChange,n=this.props.ngModelCtrl,a=this.props.disabled,v=this.props.props,o=c.map(function(n,r){var u=i?n[i]:n;return React.DOM.option({key:r,value:u,selected:u==l},t?n[t]:n)}),s,h;return r&&o.unshift(React.DOM.option({value:"",key:"empty"},r)),s=Object.assign({key:"select",onChange:y,id:f,disabled:a,onBlur:p},v),h=React.DOM.select(s,o),React.DOM.div(null,[u?React.DOM.label({className:"select__label",key:"label",htmlFor:f},u):null,h])}});n.value("Options",t);n.directive("nasSelect",["reactDirective",function(n){function u(){var n=arguments[3],t=arguments[2].name;t&&(delete arguments[2].name,n.$$parentForm[t]=n,arguments[1].removeAttr("name"));arguments[2].ngModelCtrl=function(){return n};r.apply(i,arguments)}var i=n(t,null,{restrict:"A",require:"^ngModel"}),r=i.link;return i.link=u,i}])}(),function(){"use strict";function n(n,t,i,r){var u=this,f;u.emailRegex=r.emailRegex;u.errorHeader="";u.errors=[];u.profile=n.profile;u.profile.phonenumber=n.profile.phonenumberModel;u.countries=n.countries;f=_.map(u.countries,function(n){return{name:n.countryName+" ("+n.phonePrefix+")",value:n.phonePrefix+n.countryCode}});u.phonePrefixes=_.filter(f,function(n){return n.value});u.activate=function(){i.activateNonNasProfile(u.profile).$promise.then(function(){n.onSuccess()}).catch(function(n){u.errorHeader=n.data.header;u.errors=n.data.messageList})}}var t=angular.module("nas.shared");t.directive("nasActivateProfile",["templateBase",function(t){return{scope:{profile:"=",countries:"=",onSuccess:"="},restrict:"EA",templateUrl:t+"shared/components/activateProfile/activateProfile.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$scope","$translate","activateProfileRes","nasConfig"]}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("activateProfileRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/profile/activateprofile/:action",{},{nonNasProfile:{method:"GET",custom400handling:!1,params:{action:"nonNasProfile"}},activateNonNasProfile:{method:"POST",custom400handling:!0,params:{action:"activateNonNasProfile"}}})}])}(),function(){"use strict";function n(n,t,i,r){function f(n,t){i.open(n,t)}var u=this;u.infoUrlPrivacyStatement=r.get("infoUrlPrivacyPolicy");u.infoUrlTermsSmsUs=r.get("infoUrlTermsSmsUs");u.privacyStatementTitle=t.instant("FlightTrackerPrivacyStatementTitle");u.usSmsTermsOfServiceLink=t.instant("UsSmsTermsOfServiceLink");u.openModal=f}var t=angular.module("nas.shared");t.directive("nasAmericanPhoneTerms",["templateBase",function(t){return{restrict:"EA",templateUrl:t+"shared/components/americanTerms/americanPhoneTerms.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$scope","$translate","infoModal","sitemapSvc"]}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasAncillarySelection",["templateBase","$timeout",function(n){return{restrict:"EA",templateUrl:n+"shared/components/ancillarySelection/ancillarySelection.tpl.html",scope:{ancillaries:"=",groups:"=",travellerlist:"=",userselectedAncillarylist:"="},controller:["$translate","nasConfig",function(n,t){function u(){var n=_.filter(i.userselectedAncillarylist,{routeId:i.ancillaries.routeId}),t=i.groups.split(",");i.selected=_.filter(n,function(n){var i=!1;return _.forEach(t,function(t){n.ancillary.group===t&&(i=!0)}),i?n:void 0})}function f(n){return _.find(i.ancillaries.ancillaryAvailabilities,["priceCode",n])}var i=this,r;i.useReactSelectBoxes=t.useReactSelectBoxes;r=i.travellerlist?i.travellerlist:[];_.forEach(r,function(n){n.fullname=n.firstname+" "+n.lastname});i.travellers=r;i.selectedAncillary="";i.ancillaryQuota="";i.selectedTraveller=i.travellers.length==1?i.travellers[0].paxRef:"";i.selectedCount=0;i.itemsLabel=n.instant("Number");u();_.forEach(i.ancillaries.ancillaryAvailabilities,function(n){n.displayName=n.description+" ("+n.presentedFare+")"});i.ancillarySelected=function(){var c,n,r,u,e;if(i.selectedAncillary){var t=f(i.selectedAncillary),o=0,s=0,h=_.find(i.ancillaries.quotas,function(n){return!!i.selectedAncillary.match(new RegExp("^"+n.code))}),l=_.filter(i.userselectedAncillarylist,function(n){return n.routeId===i.ancillaries.routeId&&n.ancillary.priceCode.match(new RegExp("^"+i.selectedAncillary))});o=_(l).map(function(n){return n.quantity}).reduce(function(n,t){return n+t});c=_.filter(i.userselectedAncillarylist,function(n){return n.routeId===i.ancillaries.routeId&&n.ancillary.priceCode.match(new RegExp("^"+i.selectedAncillary))&&n.paxRef==i.selectedTraveller});s=_(c).map(function(n){return n.quantity}).reduce(function(n,t){return n+t});n=h?h.availableCount-(o||0):100;r=t.quotaPerPaxPerRoute;t.quotaPerPaxPerRouteList&&(u=_.find(t.quotaPerPaxPerRouteList,function(n){return n.paxRef==i.selectedTraveller}),u&&(r=u.availableCount));e=r-(s||0);e<n&&(n=e);i.ancillaryQuota=n>4?4:n;i.ancillaryQuota>0&&(i.selectedCount=1)}};i.add=function(){var n,t,r;i.selectedTraveller&&i.selectedAncillary&&i.selectedCount&&i.selectedCount!==0&&(n=_.find(i.travellers,["paxRef",parseInt(i.selectedTraveller,10)]),t=_.find(i.userselectedAncillarylist,function(t){return t.traveller===n&&t.routeId===i.ancillaries.routeId&&t.ancillary.priceCode===i.selectedAncillary}),t?t.quantity+=i.selectedCount:(r=f(i.selectedAncillary),i.userselectedAncillarylist.push({paxRef:n.paxRef,firstname:n.firstname,lastname:n.lastname,routeId:i.ancillaries.routeId,id:n.id,routeReference:i.ancillaries.routeReference,ancillary:_.pick(r,["fee","group","priceCode","description"]),quantity:i.selectedCount})),i.travellers.length>1&&(i.selectedTraveller=""),i.selectedAncillary="",i.ancillaryQuota="",i.selectedCount=0,u())};i.remove=function(n){var t=i.userselectedAncillarylist.indexOf(n);t>-1&&(i.userselectedAncillarylist.splice(t,1),u())}}],controllerAs:"vm",bindToController:!0}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("cabinBiddingRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/cabinbidding/:action",{},{get:{method:"GET",params:{action:"lookup"},custom400handling:!0,custom500handling:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.controller("CabinBiddingLookupCtrl",["$window","cabinBiddingRes","$translate",function(n,t,i){function u(i){r.errorHeader="";r.errors=[];r.showNotEligibleMessage=!1;t.get({pnr:i.pnr,pnrName:i.pnrName,touchPoint:"MarketingPage"}).$promise.then(function(t){if(t.isEligible){n.location=t.url;return}r.showNotEligibleMessage=!0}).catch(function(n){r.errors=n.data.messageList})}var r=this;r.errorHeader="";r.errors=[];r.search=u;r.showNotEligibleMessage=!1;r.notEligibleMessages=[i.instant("CabinBiddingCheckNotEligible")]}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasCabinBiddingLookup",["$translate","templateBase",function(n,t){return{restrict:"EA",scope:{title:"@",subtitle:"@",button:"@"},templateUrl:t+"shared/components/bidding/cabinBiddingLookup.tpl.html",controller:"CabinBiddingLookupCtrl",controllerAs:"vm"}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("busyConfigRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/busy/config")}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("busyConfigSvc",["$q","$sessionStorage","busyConfigRes",function(n,t,i){function f(n){t.busyConfig=n}var r=t.busyConfig,u=n.defer();return r?u.resolve(r):(r={waitTime:15,maxAttempts:3},f(r),i.get().$promise.then(function(n){r=n;f(r);u.resolve(r)})),{config:u.promise}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasBusyWait",["$translate","$timeout","$window","templateBase","busyConfigSvc",function(n,t,i,r,u){return{restrict:"EA",scope:{refreshClick:"@"},templateUrl:r+"templates/busy-wait.core.tpl.html",controller:["$scope",function(n){function l(n){f=n.waitTime;e=n.maxAttempts;r=!0}function a(){n.attemptsCounter++;n.showBusyScreen=!0}function s(){n.showBusyScreen=!1}function h(){n.repeatAction&&n.repeatAction()}function v(){n.attemptsCounter=0}function c(){n.timeLeft=f;a();t(i,o)}var r,f,e,o=1e3,i;n.attemptsCounter=0;n.showRefresh=!1;n.$watch("attemptsCounter",function(t){n.showRefresh=t>e?!0:!1});n.$on("showBusyScreen",function(t,i){(t.preventDefault(),n.showBusyScreen)||(n.repeatAction=i.repeatAction,r?c():u.config.then(function(n){l(n);c()}))});n.$on("resetBusyScreenAttempts",function(n){n.preventDefault();v()});n.refreshClick=function(){s();h()};i=function(){if(n.timeLeft===0){s();h();return}n.showRefresh||(n.timeLeft--,t(i,o))}}]}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasContinuebutton",["$translate",function(n){return{restrict:"A",template:'<button type="{{buttontype}}" data-ng-click="oncontinue()" class="button {{ cssclassatr }} button--primary" data-ng-disabled="!isenabled">{{ text }}<\/button>',replace:!0,scope:{oncontinue:"&",text:"=?",textKey:"@",isenabled:"=",cssclass:"@",cssclassatr:"=?",causesValidation:"=?"},link:function(t){t.textKey&&n(t.textKey).then(function(n){t.text=n});t.cssclassatr=t.cssclass?t.cssclass:"button--block";var i=t.causesValidation===undefined;i||(i=t.causesValidation==!0);t.buttontype=i?"submit":"button"}}}]);n.directive("nasBackbutton",["$translate",function(n){return{restrict:"A",template:'<button data-ng-click="ongoback()" class="button {{ cssclassatr }} button--primary" data-ng-disabled="!isenabled">{{ text }}<\/button>',replace:!0,scope:{ongoback:"&",text:"=?",textKey:"@",isenabled:"=",cssclass:"@",cssclassatr:"=?"},link:function(t){t.textKey&&n(t.textKey).then(function(n){t.text=n.replace("&lt;","<")});t.cssclassatr=t.cssclass?t.cssclass:"button--block"}}}]);n.directive("nasCancelbutton",["$translate",function(n){return{restrict:"A",template:'<button data-ng-click="oncancel()" class="button {{ cssclassatr }} button--primary" data-ng-disabled="!isenabled">{{ text }}<\/button>',replace:!0,scope:{oncancel:"&",text:"=?",textKey:"@",isenabled:"=",cssclass:"@",cssclassatr:"=?"},link:function(t){t.textKey&&n(t.textKey).then(function(n){t.text=n});t.cssclassatr=t.cssclass?t.cssclass:"button--block"}}}]);n.directive("nasRouteSelectButton",["templateBase","$translate",function(n,t){return{restrict:"A",templateUrl:n+"shared/components/buttons/routeselectbutton.tpl.html",replace:!0,scope:{fareModel:"=",routeId:"=",currencyCode:"=",selectedFare:"="},link:function(n){n.$watch("selectedFare",function(){n.fareModel&&(n.isSelected=n.selectedFare==n.routeId+n.fareModel.type)});n.seatsAvailableLabel=t.instant("AvailableSeats")}}}]);n.directive("nasCheckboxbutton",["deviceSvc","$timeout","templateBase",function(n,t,i){return{restrict:"A",templateUrl:i+"shared/components/buttons/checkboxbutton.tpl.html",transclude:!0,scope:{required:"=?",disabled:"=?",negate:"=?",click:"&?",ngModel:"="},require:"ngModel",link:function(i,r,u,f){function e(){i.disabled||(i.disabled=!1);typeof i.ngModel=="string"&&(i.ngModel=i.ngModel=="true"?!0:!1);i.model=i.ngModel;i.negate===!0&&(i.model=!i.model);(n.isSafari||n.isTravelAssistant||n.isNativeAndroid)&&r.find(".btn-cb .check").removeClass("check").addClass("check-alt")}i.elementId=_.uniqueId("cb_");u.id&&(i.elementId=u.id,r.removeAttr("name"));i.cbLabelId="label_"+i.elementId;e();i.$watch("ngModel",function(){e()});r.on("change",function(){i.disabled||t(function(){i.$apply(function(){f.$setViewValue(i.negate===!0?!i.model:i.model);f.$setTouched(!0);i.click&&t(function(){i.click()})})},100)})}}}]);n.directive("nasRadiobutton",["$timeout","templateBase","keyCodes",function(n,t,i){return{restrict:"A",templateUrl:t+"shared/components/buttons/radiobutton.tpl.html",scope:{model:"=",options:"=",optionLabels:"=?",click:"=?",isreadonly:"=?",useLinebreak:"=?"},compile:function(){return{post:function(t,r){function f(n,t){if(event.target.nodeName==="BUTTON"){var i=Array.prototype.slice.call(r[0].querySelectorAll("button")),f=i.indexOf(event.target),u=f+t;u<i.length&&u>=0?(i[u].focus(),i[u].click()):u>=i.length?(i[0].focus(),i[0].click()):u<0&&(i[i.length-1].focus(),i[i.length-1].click())}}function u(){t.options&&(t.optionList=_.map(t.options,function(n,i){return n===undefined?{}:typeof n=="string"?{value:n,label:t.optionLabels&&t.optionLabels[i]||n}:{value:n.value,label:t.optionLabels&&t.optionLabels[i]||n.label||n.name||n.value}}))}r.attr("tabindex",-1);t.radiogroup=_.uniqueId("radio_");r.on("keydown keypress",function(n){n.which===i.RIGHT||n.which===i.DOWN?f(n.target,1):n.which===i.LEFT||n.which===i.UP?f(n.target,-1):n.which===i.SPACE&&n.target.nodeName==="BUTTON"&&n.target.click()});var e=t.$watch("optionLabels",function(){t.optionLabels&&(e(),u())});t.$watch("options",function(){t.options&&u()});u();t.onClick=function(i){t.isreadonly||(t.model=i,t.click&&n(function(){t.click({selected:i})}))};n(function(){var n=Array.prototype.slice.call(r[0].querySelectorAll("button"));n.length>0&&(_.some(n,function(n){return n.tabIndex>=0})||(n[0].tabIndex=0))})}}}}}])}(),function(){"use strict";function n(n,t,i,r,u){function o(){i.all(e).then(function(n){f.scheduleChangeNoteBodyP2=r.format(n[0],n[1])}).catch(function(n){console.log("Missing translation "+n)})}var e=[t("ScheduleChangeNoteBodyP2"),t("ApplicationSupportPhone")],f=this;f.show=!1;n.alterationinfo()&&(f.show=n.alterationinfo().showCancellationInfoAndOptionsBox,f.linklist=n.alterationinfo().linklist,f.hasAcceptedScheduleChange=u.isPnrAccepted(n.alterationinfo().pnr));o()}var t=angular.module("nas.shared");t.directive("nasCancellationOptionsBox",["templateBase",function(t){return{restrict:"EA",scope:{alterationinfo:"&"},templateUrl:t+"shared/components/cancellation/cancellationInfoAndOptionsBox.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$scope","$translate","$q","stringutils","scheduleChangeSvc"]}(),function(){"use strict";function n(n,t){var i=this;i.show=!1;n.alterationinfo()&&(i.show=n.alterationinfo().showScheduleChangeAcceptBox,i.linklist=n.alterationinfo().linklist,i.hasAcceptedScheduleChange=t.isPnrAccepted(n.alterationinfo().pnr))}var t=angular.module("nas.shared");t.directive("nasSchedulechangeAcceptBox",["templateBase",function(t){return{restrict:"EA",scope:{alterationinfo:"&"},templateUrl:t+"shared/components/cancellation/scheduleChangeAcceptBox.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$scope","scheduleChangeSvc"]}(),function(){"use strict";function n(n){var t=this,i;t.model=n.ngModel;t.model.carList.length===0&&t.model.noAvailabilityUrl&&t.model.noAvailabilityUrl.text&&(t.model.carTrawler="CarTrawler",i=t.model.noAvailabilityUrl.text,t.model.noAvailPreText=i.substring(0,i.indexOf("CarTrawler")),t.model.noAvailPostText=i.substring(i.indexOf("CarTrawler")+t.model.carTrawler.length))}angular.module("nas.shared").directive("nasCartrawlerCrossSale",["templateBase",function(t){return{restrice:"EA",replace:!0,require:"^ngModel",scope:{ngModel:"="},templateUrl:t+"shared/components/cartrawler/cartrawlerCrossSale.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$scope"]}(),function(){"use strict";angular.module("nas.shared").directive("nasCitypair",["templateBase",function(n){return{restrict:"A",replace:!0,scope:{origin:"=",destination:"="},templateUrl:n+"shared/components/citypair/citypair.tpl.html"}}])}(),function(){"use strict";function n(n,t,i,r,u){var f=this,e;f.errors&&(e=f.errors.subscribe(function(n){f.phonenumberForm.number.$setValidity("server",!1);f.phonenumberForm.number.$error.server=typeof f.phonenumberForm.number.$error.server=="boolean"?n:f.phonenumberForm.number.$error.server.concat(n)}));n.$on("$destroy",function(){e&&e.dispose()});f.phonePrefixAndCountry=u.getPrefixAndCountry(f.phoneNumber.prefix,f.phoneNumber.countryCode,f.phonePrefixes);f.cssClasses=f.cssClasses||{row:"row",col1:"col-6--md",col2:"col-6--md"};n.$watch("vm.phonePrefixAndCountry",function(){f.phonePrefixAndCountry?(f.phoneNumber.prefix=f.phonePrefixAndCountry.slice(0,f.phonePrefixAndCountry.length-2),f.phoneNumber.countryCode=f.phonePrefixAndCountry.slice(f.phonePrefixAndCountry.length-2,f.phonePrefixAndCountry.length)):(f.phoneNumber.prefix="",f.phoneNumber.countryCode="")});f.countryRequiredText=r.format(t.instant("FormFieldRequired"),t.instant("Country")).replace(/\"/g,"");f.phoneRequiredText=r.format(t.instant("FormFieldRequired"),f.label).replace(/\"/g,"");f.phoneInvalidText=r.format(t.instant("FormFieldInvalid"),f.label).replace(/\"/g,"");f.phoneShortText=r.format(t.instant("FormFieldShort"),f.label,"5").replace(/\"/g,"");f.phoneLongText=r.format(t.instant("FormFieldLong"),f.label,"25").replace(/\"/g,"")}angular.module("nas.shared").directive("nasPhonenumber",["templateBase","formValidation",function(t,i){return{restrict:"EA",templateUrl:t+"shared/components/contactinfo/phonenumber.tpl.html",scope:{phoneNumber:"=",phonePrefixes:"=",errors:"=",label:"=",isNumberRequired:"=",hideRequiredLabel:"=",cssClasses:"="},require:"^^form",link:function(n,t,r,u){var f=i.findFormElement(t[0]);n.vm.topForm=i.findTopLevelForm(u);f&&n.$on(f.name+":submit",function(){n.vm.phonenumberForm.number.$setValidity("server",!0)});n.focused=!1;n.focus=function(){n.focused=!0};n.blur=function(){n.focused=!1}},controller:n,controllerAs:"vm",bindToController:!0}}]);n.$inject=["$scope","$translate","$q","stringutils","phoneNumberSvc","nasConfig"]}(),function(){"use strict";function n(n,t,i,r,u,f,e){function v(n,t,i){return u.getFlightDelay({flightCode:n,date:t,direction:i}).$promise}function y(n,t,i){return u.get({direction:i,airportCode:n,selectedOffsetDay:t}).$promise}function p(t,i,r,u){n.all([y(t,i,r)]).then(function(n){o.delayInfoList=n[0].resultList;b(n[0].resultAirportList,u);l("airport",n[0].direction)})}function w(i,r,u){n.all([v(i,r,u)]).then(function(n){o.delayInfoList=n[0].resultList;l("flight",n[0].direction)}).catch(function(n){var i=n.data;t.$broadcast("flight_search_controller_exception",i)})}function l(n,t){n==="flight"?(a(!0,!0,!0,!0),o.directionText=t&&t==="Arrival"?h:s):(k(t),t&&t==="Arrival"?a(!0,!1,!1,!0):a(!1,!0,!0,!1))}function a(n,t,i,r){var u=5;n&&u++;t&&u++;i&&u++;r&&u++;o.showFromAirportColumn=n;o.showToAirportColumn=t;o.showDepartureTimeColumn=i;o.showArrivalTimeColumn=r;o.flightStatusColspan=u}function b(n,i){o.resultAirportList=n;i?o.resultFilter.preferredAirport=i:o.resultFilter={};t.$broadcast("setResultAirports",{resultAirports:o.resultAirportList,preferredAirport:i})}function k(n){o.searchBoxModel.fromText=n&&n==="Arrival"?s.toLowerCase():h.toLowerCase();o.searchBoxModel.toText=n&&n==="Arrival"?h.toLowerCase():s.toLowerCase();o.directionText=n&&n==="Arrival"?h:s;t.$broadcast("setDirectionText",{direction:n})}function d(){f.get().$promise.then(function(n){o.phonePrefixes=e.getPhonePrefixes(n.countries)})}var o=this,s=r.instant("DelayInfoArrivalTo"),h=r.instant("DelayInfoDepartureFrom"),c;o.departureFromText=h;o.arrivalToText=s;o.flightStatusColspan=7;o.departureHeaderText=r.instant("FlightTrackerDeparture");o.arrivalHeaderText=r.instant("FlightTrackerArrival");o.gateHeaderText=r.instant("DelayInfoHeaderGate");o.statusHeaderText=r.instant("DelayInfoByAirportStatus");o.delayInfoList=angular.fromJson(i.resultModel||{});o.searchBoxModel=angular.fromJson(i.searchModel||{});o.resultAirportList=angular.fromJson(i.resultAirportModel||{});o.simpleSuggestLanguage=angular.fromJson(i.simpleSuggestLanguage||{});o.filter={selectedAirportName:o.searchBoxModel.preferredAirport,direction:{value:o.searchBoxModel.defaultDirection},offsetDay:{value:o.searchBoxModel.defaultOffsetDay},airportCode:""};o.defaultResultAirport={code:"",cityName:"",displayName:r.instant("FlightStatusAllAirportSelect"),countryName:"",airportName:"",cityCode:""};o.resultFilter={};l("Airport",o.searchBoxModel.defaultDirection);t.$on("tabFocus",function(){o.delayInfoList=angular.fromJson(i.resultModel||{});o.defaultResultAirport={code:"",cityName:"",displayName:r.instant("FlightStatusAllAirportSelect"),countryName:"",airportName:"",cityCode:""}});t.$on("searchForFlight",function(n,t){w(t.flightcode,t.date,t.direction)});t.$on("searchForAirport",function(n,t){p(t.airportcode,t.offsetDay,t.direction,t.resultAirportCode)});c=t.defaultResultAirport;t.$on("resultAirportChanged",function(n,t){t.airport&&t.airport!==c?o.resultFilter.preferredAirport=t.airport:o.resultFilter={preferredAirport:"",selectedAirportName:r.instant("FlightStatusAllAirportSelect"),direction:"",offsetDay:"",airportCode:""};c=o.resultFilter.preferredAirport});t.$on("resetSearchResult",function(){o.delayInfoList=angular.fromJson(i.resultModel||{})});d()}var t=angular.module("nas.shared");t.directive("nasDelayInfo",["templateBase",function(t){return{scope:{searchModel:"&",resultModel:"&",resultAirportModel:"&",simpleSuggestLanguage:"&"},replace:!0,restrict:"EA",templateUrl:t+"shared/components/flightStatus/delayInfo.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$q","$scope","$attrs","$translate","delayInfoRes","countriesRes","phoneNumberSvc"]}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("delayInfoRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/delayInfo/:action",{},{get:{method:"GET",params:{action:"airport"}},getFlightDelay:{method:"GET",params:{action:"flight"},custom400handling:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasDelayInfoAirportSearch",["templateBase",function(n){return{restrict:"EA",scope:{filter:"=",resultFilter:"=",language:"=",searchBoxModel:"=",resultAirportList:"="},templateUrl:n+"shared/components/flightStatus/delayInfoAirportSearch.tpl.html",controller:["$scope","$translate",function(n,t){function e(n){i.fromText=n&&n==="Arrival"?r.toLowerCase():u.toLowerCase();i.toText=n&&n==="Arrival"?u.toLowerCase():r.toLowerCase()}function f(){i.filter.preferredAirport?n.$emit("searchForAirport",{airportcode:i.filter.preferredAirport,offsetDay:i.filter.offsetDay.value,direction:i.filter.direction.value,resultAirportCode:i.resultFilter.preferredAirport}):(i.resultFilter.preferredAirport=null,n.$emit("resetSearchResult"))}var i=this,r,u;i.airportList=n.searchBoxModel.airportList;i.filter=n.filter;i.resultFilter=n.resultFilter;i.preferredAirport=n.searchBoxModel.preferredAirport;i.language=n.language;i.chooseAirportLabel=n.searchBoxModel.chooseAirportLabel;i.directionList=n.searchBoxModel.directionList;i.offsetDayList=n.searchBoxModel.offsetDayList;i.searchText=n.searchBoxModel.searchText;i.fromText=n.searchBoxModel.fromText;i.toText=n.searchBoxModel.toText;i.resultAirportsPlaceholder=[t.instant("FlightStatusAllAirportSelect")];i.filter.preferredAirport=n.searchBoxModel.preferredAirport;i.resultAirportList=n.resultAirportList;r=t.instant("DelayInfoArrivalTo");u=t.instant("DelayInfoDepartureFrom");n.$on("setResultAirports",function(n,t){i.resultAirportList=t.resultAirports;i.resultFilter.preferredAirport=t.preferredAirport});n.$on("setDirectionText",function(n,t){e(t.direction)});i.airportChanged=function(){f()};i.resultAirportChanged=function(){n.$emit("resultAirportChanged",{airport:i.resultFilter.preferredAirport})};i.offsetDayChanged=function(){f()};i.directionChanged=function(){e(i.filter.direction.value);f()}}],controllerAs:"vmAirport"}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasDelayInfoFlightSearch",["templateBase",function(n){return{restrict:"EA",scope:{dateList:"="},templateUrl:n+"shared/components/flightStatus/delayInfoFlightSearch.tpl.html",controller:["$scope","$translate",function(n,t){var i=this;i.dateList=n.dateList;i.selectedDate=i.dateList[0];_.each(i.dateList,function(n){n.selected&&(i.selectedDate=n)});i.destionationTypeLabel=t.instant("FlightTrackerDeparture");i.arrivalTypeLabel=t.instant("FlightTrackerArrival");i.searchTypes={departure:"Departure",arrival:"Arrival"};i.searchType=i.searchTypes.departure;i.search=function(){n.$emit("searchForFlight",{flightcode:i.flightcode,date:i.selectedDate.value,direction:i.searchType})};n.$on("flight_search_controller_exception",function(t,i){n.$broadcast("errorMessageShow",i)})}],controllerAs:"vmFlight"}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasDelayInfoTabCollection",["templateBase","$injector","$timeout",function(n,t,i){return{restrict:"EA",scope:{filter:"=",resultFilter:"=",language:"=",searchBoxModel:"=",resultAirportList:"="},link:function(n,r){function e(t){var i=r[0].querySelectorAll(".tab-box__tabs")[0],u=i.querySelectorAll(".tab-box__tabs__button");u[t-1].focus();n.$emit("tabFocus",t)}var u=t.get("deviceSvc"),f=t.get("smoothScroll");n.setTab=function(t){n.tab=t;u.isTravelAssistant||u.width.lg()||i(function(){var n=r[0].querySelectorAll(".tab-box__tabs")[0];n&&f(n,{duration:400,offset:-(60*(t-1))})});e(t)};n.tab=1},templateUrl:n+"shared/components/flightStatus/delayInfoTabCollection.tpl.html"}}])}(),function(){"use strict";function n(n,t,i,r,u,f,e){function s(){return u.get({originAirport:t.originairport(),destinationAirport:t.destinationairport(),flightCode:t.flightcode(),localDepartureTime:t.localdeparturetimeticks(),offset:t.offset().value}).$promise}function h(){n.all([s()]).then(function(n){o.flightTrackerItem=n[0].resultModel;o.newInfoListList=_.filter(n[0].smsHistoryList,function(n){return n.type!=="Welcome_Subscribers"&&n.type!=="AirPort_Subscribers"});o.smsHistoryList=_.filter(n[0].smsHistoryList,function(n){return n.type==="Welcome_Subscribers"||n.type==="AirPort_Subscribers"});o.getFlightTrackerItemFailed=!1}).catch(function(){o.getFlightTrackerItemFailed=!0;o.errors=[i.instant("FlightTrackerGetItemFailed")]})}function c(n,t){e.open(n,t)}function l(){u.save({originAirport:o.flightTrackerItem.originAirportIataCode,destinationAirport:o.flightTrackerItem.destinationAirportIataCode,flightCode:o.flightTrackerItem.flightCode,localDepartureTime:o.flightTrackerItem.localDepartureDateTimeTicks,countryPrefix:o.phoneNumber.prefix,number:o.phoneNumber.number,smsSignUp:!0}).$promise.then(function(){o.signupSuccess=!0;o.signupFailed=!1}).catch(function(){o.signupSuccess=!1;o.signupFailed=!0})}var o=this;o.phonePrefixes=t.phoneprefixes;o.phoneNumber={prefix:"",number:""};o.trustAsHtml=r.trustAsHtml;o.countryRequiredText=f.format(i.instant("FormFieldRequired"),i.instant("Country")).replace(/\"/g,"");o.mobileRequiredText=f.format(i.instant("FormFieldRequired"),i.instant("PhoneTypeMobile")).replace(/\"/g,"");o.mobileInvalidText=f.format(i.instant("FormFieldInvalid"),i.instant("PhoneTypeMobile")).replace(/\"/g,"");o.mobileShortText=f.format(i.instant("FormFieldShort"),i.instant("PhoneTypeMobile"),"5").replace(/\"/g,"");o.mobileLongText=f.format(i.instant("FormFieldLong"),i.instant("PhoneTypeMobile"),"25").replace(/\"/g,"");h();o.openModal=c;o.save=l}var t=angular.module("nas.shared");t.directive("nasFlightTracker",["templateBase",function(t){return{scope:{originairport:"&",destinationairport:"&",flightcode:"&",localdeparturetimeticks:"&",offset:"&",phoneprefixes:"=",index:"="},replace:!0,restrict:"EA",templateUrl:t+"shared/components/flightStatus/flightTracker.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$q","$scope","$translate","$sce","flightTrackerRes","stringutils","infoModal"]}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("flightTrackerRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/flightTracker",{},{save:{method:"POST",custom400handling:!0,hideSpinner:!0},get:{method:"GET",custom400handling:!0,hideSpinner:!0}})}])}(),function(){"use strict";angular.module("nas.shared").directive("nasHeader",["templateBase",function(n){return{restrict:"A",replace:!0,scope:{title:"=?",titleKey:"@",subtitle:"=?",subtitleKey:"@",breadcrumbTitle:"=?",breadcrumbTitleKey:"@",breadcrumbState:"=",breadcrumbUrl:"=",breadcrumbAction:"=",showProgressState:"="},templateUrl:n+"shared/components/header/header.tpl.html",controller:["$scope","$translate","$state","deviceSvc",function(n,t,i,r){function u(i,r){t(i).then(function(t){n[r]=n[r]||t})}n.isTravelAssistant=r.isTravelAssistant;n.state=i.current.name;n.titleKey&&u(n.titleKey,"title");n.subtitleKey&&u(n.subtitleKey,"subtitle");n.breadcrumbTitleKey&&u(n.breadcrumbTitleKey,"breadcrumbTitle");u("Previous","backLabel")}]}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.controller("HotelCtrl",["$scope","$q","$translate","$cookies","destinationsRes","nasConfig",function(n,t,i,r,u,f){function o(){if(e.request.origin&&e.request.outboundDate&&e.request.departureDate&&e.destinationList){e.destination=_.filter(e.destinationList,function(n){return n.code==e.request.origin?!0:!1});var t=moment(e.request.outboundDate),r=t.format("YYYY-MM"),u=t.format("DD"),i=moment(e.request.departureDate),o=i.format("YYYY-MM"),s=i.format("DD");e.link="http://www.booking.com/searchresults.html?aid=342370&label=nwgn-traveldet-search&iata="+e.destination[0].code+"&iata_orr=1&checkin_monthday="+u+"&checkin_year_month="+r+"&checkout_monthday="+s+"&checkout_year_month="+o+"&ifl=0&selected_currency="+n.soldInCurrency+"&si=ai,ci,re&do_availability_check=on&lang="+f.culture.slice(3)}else e.link=""}function l(){var n=t.defer();return u.get({includeRelations:!0}).$promise.then(function(t){n.resolve(t)}),n.promise}var e=this,s,h,c;e.accessibilityMode=!1;f.cookies.overrideDisplayModeCookie&&(s=r.get(f.cookies.overrideDisplayModeCookie.name),s&&s===f.cookies.overrideDisplayModeCookie.valueMobile&&(e.accessibilityMode=!0));h=moment(n.arrivaltime);c=moment(n.arrivaltime).add(1,"days");n.departuretime&&(c=moment(n.departuretime));e.request={origin:n.suggestion,outboundDate:h,departureDate:c};e.searchLabel=i.instant("HotelsWereToStay");e.noMatchText=i.instant("NoMatches");e.checkInLabel=i.instant("HotelsCheckIn");e.checkOutLabel=i.instant("HotelsCheckOut");e.today=new Date;e.minDate=h;n.$watch("vm.request.origin",function(){o()});n.$watch("vm.request.outboundDate",function(){e.minDate=e.request.outboundDate;o()});n.$watch("vm.request.departureDate",function(){o()});o();t.all([l()]).then(function(n){e.destinationList=_.filter(n[0].destinations,function(n){return n.code.length>3&&n.code.indexOf("ALL")>-1?!1:n.code});o()})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasHotel",["templateBase",function(n){return{restrict:"EA",scope:{suggestion:"=",arrivaltime:"=",departuretime:"=",soldInCurrency:"="},templateUrl:n+"shared/components/hotel/hotel.tpl.html",controller:"HotelCtrl",controllerAs:"vm"}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.controller("HotelNewVendorCtrl",["$scope","$q","$window","$translate","$cookies","destinationsRes","nasConfig","hotelNewVendorRes","hotelSearchNewVendorRes",function(n,t,i,r,u,f,e,o,s){function d(){h.request.destination="";h.request.destinationId="";c()}function g(){v=!1;c()}function nt(n){h.suggestions=n.suggestions||[];c()}function tt(){b=l.destination;h.suggestions=[{code:l.destinationId,destinationId:l.destinationId,displayName:l.destination}];h.request.destinationId=h.suggestions[0].destinationId;h.request.destination=h.suggestions[0].displayName}function it(n){v=!0;s.suggestions({searchText:n}).$promise.then(nt).catch(function(){})}function rt(){return b!==h.request.destination}function ut(){return rt()||a(l.outboundDate)!==h.request.outboundDate||a(l.departureDate)!==h.request.departureDate}function c(){h.canSearch=(h.request.destination||h.request.destinationId)&&h.request.outboundDate&&h.request.departureDate&&h.request.departureDate>=h.request.outboundDate}function ft(n){h.errors=[n]}function et(){h.errors=null}function ot(){if(et(),h.canSearch){if(!ut()){window.location=h.model.deeplink;return}moment(h.request.departureDate).diff(moment(h.request.outboundDate),"days")>28&&(h.request.departureDate=a(moment(h.request.outboundDate).add(28,"days")));var n=a(moment(h.request.outboundDate)),t=a(moment(h.request.departureDate)),i={checkInDate:n,checkOutDate:t,destination:v?h.request.destination:null,destinationId:v?null:h.request.destinationId,rooms:null,flight:h.model.flight,trafficSource:y.trafficSource,trafficSourceCategory:y.trafficSourceCategory};o.deeplink(i).$promise.then(function(n){window.location=n.url}).catch(function(){ft(h.model.errorDeeplinkGenerationFailed)})}}function a(n){return n.format("YYYY-MM-DD")}var v,b,h=this,y,p;h.model=n.model;y={trafficSource:h.model.trafficSource,trafficSourceCategory:h.model.trafficSourceCategory};h.accessibilityMode=!1;e.cookies.overrideDisplayModeCookie&&(p=u.get(e.cookies.overrideDisplayModeCookie.name),p&&p===e.cookies.overrideDisplayModeCookie.valueMobile&&(h.accessibilityMode=!0));var w=moment(h.model.checkInDate),k=moment(h.model.checkOutDate),l={destination:h.model.destination,destinationId:h.model.destinationId,outboundDate:angular.copy(w),departureDate:angular.copy(k)};h.request={destination:h.model.destination,outboundDate:w,departureDate:k};h.getSuggestions=it;h.airportChange=g;h.search=ot;h.today=new Date;h.minDate=w;n.$watch("vm.request.destination",function(){c()});n.$watch("vm.request.destinationId",function(n){n===""&&d();c()});n.$watch("vm.request.outboundDate",function(){h.minDate=h.request.outboundDate;c()});n.$watch("vm.request.departureDate",function(){c()});tt()}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasHotelNewVendor",["templateBase",function(n){return{restrict:"EA",scope:{model:"="},templateUrl:n+"shared/components/hotel/hotel.new.vendor.tpl.html",controller:"HotelNewVendorCtrl",controllerAs:"vm"}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("hotelNewVendorRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/hotelsearchnewvendor/:action",{},{deeplink:{method:"POST",params:{action:"deeplink"},custom400handling:!0,custom500handling:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasHotelSearch",["$window","$cookies","$sce","nasConfig","templateBase","stringutils","hotelSearchRes",function(n,t,i,r,u,f,e){return{restrict:"A",templateUrl:u+"shared/components/hotel/hotelSearch.tpl.html",replace:!1,scope:{fallbackContent:"@",label:"=",model:"="},controller:["$scope",function(u){function v(n){o.bookHotelModel.suggestions=n.suggestions||[];l()}function l(){var n=h?c:s;o.canSearch=n&&o.bookHotelModel.checkinDate}function y(){u.$on("dateViewSwitched",function(n,t){t.name==="checkinDate"?t.date.getMonth()!==new Date(o.bookHotelModel.checkinDate).getMonth()&&(o.bookHotelModel.checkinDate=moment(t.date).date(1).format("YYYY-MM-DD")):t.name==="checkinDate"&&t.date.getMonth()!==new Date(o.bookHotelModel.checkoutDate).getMonth()&&(o.bookHotelModel.checkoutDate=moment(t.date).date(1).format("YYYY-MM-DD"))});u.$watch("vm.bookHotelModel.checkinDate",function(n){n&&(o.bookHotelConfig.checkoutMinDate=typeof n=="string"?n:moment(n).format("YYYY-MM-DD"),!o.accessibilityMode||n instanceof Date||(o.bookHotelModel.checkinDate=new Date(n)))});u.$watch("vm.bookHotelModel.checkoutDate",function(n){n&&(!o.accessibilityMode||n instanceof Date||(bookHotelModel.checkoutDate.checkoutDate=new Date(n)))});u.$watch("vm.bookHotelModel.childrenCount",function(n,t){var i,r;if(n===0)o.bookHotelModel.ages=[];else if(i=n-t,i<0)o.bookHotelModel.ages.splice(n,Math.abs(i));else for(r=0;r<i;r++)o.bookHotelModel.ages.push(0)});u.$watch("vm.bookHotelModel.destinationCode",function(n){s=n===""?null:_.find(o.bookHotelModel.suggestions,function(t){return t.code===n})})}function a(){if(o.hotelSearchEnabled||(o.trustedFallbackContent=i.trustAsHtml(o.fallbackContent)),o.initializationModel){if(o.accessibilityMode=!1,r.cookies.overrideDisplayModeCookie){var n=t.get(r.cookies.overrideDisplayModeCookie.name);n&&n===r.cookies.overrideDisplayModeCookie.valueMobile&&(o.accessibilityMode=!0)}o.bookHotelConfig={vendorUrl:o.initializationModel.config.vendorUrl,label:f.format(o.initializationModel.config.labelFormat,o.label),languageCode:o.initializationModel.config.languageCode,maxDate:o.initializationModel.config.maxDate,checkinMinDate:o.initializationModel.config.minDate,checkoutMinDate:o.initializationModel.config.minDate,selectedCurrency:o.initializationModel.config.bookHotelCurrency||"",aid:o.initializationModel.config.bookHotelAid,childrenMinAge:o.initializationModel.config.childrenMinAge,childrenMaxAge:o.initializationModel.config.childrenMaxAge,roomMinCount:o.initializationModel.config.roomMinCount,roomMaxCount:o.initializationModel.config.roomMaxCount,adultMinCount:o.initializationModel.config.adultMinCount,adultMaxCount:o.initializationModel.config.adultMaxCount,childrenMinCount:o.initializationModel.config.childrenMinCount,childrenMaxCount:o.initializationModel.config.childrenMaxCount,labelBookHotelAdults:o.initializationModel.config.labelBookHotelAdults,labelBookHotelCheckInDate:o.initializationModel.config.labelBookHotelCheckInDate,labelBookHotelCheckOutDate:o.initializationModel.config.labelBookHotelCheckOutDate,labelBookHotelChildren:o.initializationModel.config.labelBookHotelChildren,labelBookHotelDestination:o.initializationModel.config.labelBookHotelDestination,labelBookHotelAges:o.initializationModel.config.labelBookHotelAges,labelBookHotelRooms:o.initializationModel.config.labelBookHotelRooms,noMatchText:o.initializationModel.config.noMatchText,lastSeparatorText:o.initializationModel.config.lastSeparatorText,fromSloganList:o.model.fromSloganList,doAvailabilityCheck:1};o.bookHotelModel={checkinDate:moment(o.initializationModel.checkinDate),checkoutDate:moment(o.initializationModel.checkoutDate),roomCount:o.initializationModel.roomCount,adultCount:o.initializationModel.adultCount,childrenCount:o.initializationModel.childrenCount,ages:[]};o.airportChange=p;o.getSuggestions=b;o.canSearch=!1;l()}}function p(){h=!1;l()}function w(){if(o.hotelSearchEnabled=!1,o.bookHotelConfig={},o.bookHotelModel={checkinDate:moment(new Date),checkoutDate:moment(new Date).add(1,"days")},o.initializationModel){a(o.initializationModel);return}e.initialize().$promise.then(function(n){o.hotelSearchEnabled=n.hotelSearchEnabled;o.initializationModel=n.initializationModel;y();a()}).catch(function(){o.hotelSearchEnabled=!1})}function b(n){c=n;h=!0;e.suggestions({searchText:n}).$promise.then(v).catch(function(){})}var o=this,c,h,s;w();o.search=function(){var t=o.bookHotelConfig.vendorUrl+"?aid="+o.bookHotelConfig.aid+"&do_availability_check=1&lang="+o.bookHotelConfig.languageCode+"&selected_currency="+o.bookHotelConfig.selectedCurrency+"&label="+o.bookHotelConfig.label+"&checkin_monthday="+moment(o.bookHotelModel.checkinDate).format("DD")+"&checkin_year_month="+moment(o.bookHotelModel.checkinDate).format("YYYY-MM")+"&checkout_monthday="+moment(o.bookHotelModel.checkoutDate).format("DD")+"&checkout_year_month="+moment(o.bookHotelModel.checkoutDate).format("YYYY-MM")+"&no_rooms="+o.bookHotelModel.roomCount+"&group_adults="+o.bookHotelModel.adultCount+"&group_children="+o.bookHotelModel.childrenCount;t+=h?"&ss="+c:"&dest_id="+s.destinationId+"&dest_type="+s.destinationType;_.each(o.bookHotelModel.ages,function(n){t+="&age="+n});n.open(t,"_blank")}}],controllerAs:"vm",bindToController:!0}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasHotelSearchNewVendor",["$window","$cookies","$sce","nasConfig","templateBase","stringutils","hotelSearchNewVendorRes",function(n,t,i,r,u,f,e){return{restrict:"A",templateUrl:u+"shared/components/hotel/hotelSearch.new.vendor.tpl.html",replace:!1,scope:{fallbackContent:"@",touchpointId:"=",sloganList:"="},link:{pre:function(t){var r=function(n){t.vm.useDisplayLogicBasedOnStyle=!n.matches},i;n.matchMedia?(i=n.matchMedia("(min-width: 640px)"),t.vm.useDisplayLogicBasedOnStyle=!i.matches,i.addListener(r),r(i),t.$on("$destroy",function(){i.removeListener(r)})):t.vm.useDisplayLogicBasedOnStyle=!0}},controller:["$scope","$timeout",function(n,u){function p(n){f.bookHotelModel.suggestions=n.suggestions||[];c()}function l(){return o?h:s}function c(){f.canSearch=l()&&f.bookHotelModel.checkinDate}function w(){n.$on("dateViewSwitched",function(n,t){t.name==="checkinDate"?t.date.getMonth()!==new Date(f.bookHotelModel.checkinDate).getMonth()&&(f.bookHotelModel.checkinDate=moment(t.date).date(1)):t.name==="checkinDate"&&t.date.getMonth()!==new Date(f.bookHotelModel.checkoutDate).getMonth()&&(f.bookHotelModel.checkoutDate=moment(t.date).date(1))});n.$watch("vm.bookHotelModel.checkinDate",function(n){n&&(f.bookHotelConfig.checkoutMinDate=typeof n=="string"?n:moment(n),!f.accessibilityMode||n instanceof Date||(f.bookHotelModel.checkinDate=new Date(n)))});n.$watch("vm.bookHotelModel.checkoutDate",function(n){n&&(!f.accessibilityMode||n instanceof Date||(bookHotelModel.checkoutDate.checkoutDate=new Date(n)))});n.$watch("vm.bookHotelModel.rooms",function(){_.forEach(f.bookHotelModel.rooms,function(n){n.childrenAges.length>n.childrenCount?n.childrenAges.pop():n.childrenAges.length<n.childrenCount&&(n.childrenAges.length=n.childrenCount)})},!0);n.$watch("vm.bookHotelModel.roomCount",function(n){n>f.bookHotelModel.rooms.length?f.bookHotelModel.rooms.push({adultCount:2,childrenCount:0,childrenAges:[]}):f.bookHotelModel.rooms.length=n||0});n.$watch("vm.bookHotelModel.destinationCode",function(n){n===""?(s=null,y()):s=_.find(f.bookHotelModel.suggestions,function(t){return t.code===n})})}function a(){u(function(){f.expandOptions=l();f.expandOptions?u(function(){f.showOverflow=!0},600):f.showOverflow=!1})}function v(){if(f.hotelSearchEnabled||(f.trustedFallbackContent=i.trustAsHtml(f.fallbackContent)),f.initializationModel){if(f.accessibilityMode=!1,r.cookies.overrideDisplayModeCookie){var n=t.get(r.cookies.overrideDisplayModeCookie.name);n&&n===r.cookies.overrideDisplayModeCookie.valueMobile&&(f.accessibilityMode=!0)}f.bookHotelConfig={pos:f.initializationModel.config.pos,locale:f.initializationModel.config.locale,cid:f.initializationModel.config.cid,trafficSource:f.initializationModel.config.trafficSource,trafficSourceCategory:f.touchpointId,maxDate:f.initializationModel.config.maxDate,checkinMinDate:f.initializationModel.config.minDate,checkoutMinDate:f.initializationModel.config.minDate,childrenMinAge:f.initializationModel.config.childrenMinAge,childrenMaxAge:f.initializationModel.config.childrenMaxAge,roomMinCount:f.initializationModel.config.roomMinCount,roomMaxCount:f.initializationModel.config.roomMaxCount,adultMinCount:f.initializationModel.config.adultMinCount,adultMaxCount:f.initializationModel.config.adultMaxCount,childrenMinCount:f.initializationModel.config.childrenMinCount,childrenMaxCount:f.initializationModel.config.childrenMaxCount,labelBookHotelAdults:f.initializationModel.config.labelBookHotelAdults,labelBookHotelCheckInDate:f.initializationModel.config.labelBookHotelCheckInDate,labelBookHotelCheckOutDate:f.initializationModel.config.labelBookHotelCheckOutDate,labelBookHotelChildren:f.initializationModel.config.labelBookHotelChildren,labelBookHotelDestination:f.initializationModel.config.labelBookHotelDestination,labelBookHotelChildAge:f.initializationModel.config.labelBookHotelChildAge,labelBookHotelRooms:f.initializationModel.config.labelBookHotelRooms,labelBookHotelRoomNumber:f.initializationModel.config.labelBookHotelRoomNumber,errorDeeplinkGenerationFailed:f.initializationModel.config.errorDeeplinkGenerationFailed,noMatchText:f.initializationModel.config.noMatchText,lastSeparatorText:f.initializationModel.config.lastSeparatorText,sloganList:f.sloganList};f.bookHotelModel={checkinDate:moment(f.initializationModel.checkinDate),checkoutDate:moment(f.initializationModel.checkoutDate),rooms:[]};f.airportChange=b;f.getSuggestions=d;f.canSearch=!1;c()}}function b(){o=!1;a();c()}function k(){if(f.hotelSearchEnabled=!1,f.bookHotelConfig={},f.bookHotelModel={checkinDate:moment(new Date),checkoutDate:moment(new Date).add(1,"days")},a(),f.initializationModel){v(f.initializationModel);return}e.initialize().$promise.then(function(n){f.hotelSearchEnabled=n.hotelSearchEnabled;f.initializationModel=n.initializationModel;w();v()}).catch(function(){f.hotelSearchEnabled=!1})}function d(n){h=n;o=!0;e.suggestions({searchText:n}).$promise.then(p).catch(function(){})}function g(n){return n.format("YYYY-MM-DD")}function nt(n){f.errors=[n]}function tt(){f.errors=null}function y(){f.bookHotelModel.destinationCode="";u(function(){f.bookHotelModel.checkinDate=moment(f.initializationModel.checkinDate);u(function(){f.bookHotelModel.checkoutDate=moment(f.initializationModel.checkoutDate)});f.bookHotelModel.roomCount=1},200)}var f=this,h,o,s;f.expandOptions=!1;f.showOverflow=!1;f.clear=y;k();f.search=function(){if(f.canSearch){tt();moment(f.bookHotelModel.checkoutDate).diff(moment(f.bookHotelModel.checkinDate),"days")>28&&(f.bookHotelModel.checkoutDate=g(moment(moment(f.bookHotelModel.checkinDate).add(28,"days"))));var n={checkInDate:f.bookHotelModel.checkinDate,checkOutDate:f.bookHotelModel.checkoutDate,destination:o?h:null,destinationId:o?null:s.code,rooms:f.bookHotelModel.rooms,trafficSource:f.bookHotelConfig.trafficSource,trafficSourceCategory:f.bookHotelConfig.trafficSourceCategory};e.deeplink(n).$promise.then(function(n){window.location=n.url}).catch(function(){nt(f.bookHotelConfig.errorDeeplinkGenerationFailed)})}}}],controllerAs:"vm",bindToController:!0}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("hotelSearchNewVendorRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/hotelsearchnewvendor/:action",{},{suggestions:{method:"GET",params:{action:"suggestions"},custom400handling:!0,custom500handling:!0},deeplink:{method:"POST",params:{action:"deeplink"},custom400handling:!0,custom500handling:!0},initialize:{method:"GET",params:{action:"initialize"},custom400handling:!0,custom500handling:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("hotelSearchRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/hotelsearch/:action",{},{suggestions:{method:"GET",params:{action:"suggestions"},custom400handling:!0,custom500handling:!0},initialize:{method:"GET",params:{action:"initialize"},custom400handling:!0,custom500handling:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.controller("ApisBoxCtrl",["$translate","$q","$scope","stringutils","sitemapSvc",function(n,t,i,r,u){var f=this;f.apisLinkUrl=u.get("pageUrlResUtilAddIdentification")+"?"+i.information.parameters;f.showApis=i.information.showApisInfo;f.paxApisSatisfiedCount=i.information.paxApisSatisfiedCount;f.paxCount=i.information.paxCount;f.infoText=i.information.infoText}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasApisBox",["templateBase",function(n){return{restrict:"EA",scope:{information:"="},templateUrl:n+"shared/components/identification/apisBox.tpl.html",controller:"ApisBoxCtrl",controllerAs:"vm"}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.controller("EstaBoxCtrl",["$translate","$q","$scope","stringutils","infoModal","sitemapSvc",function(n,t,i,r,u,f){function s(){t.all(o).then(function(n){e.infoText=r.format(n[0],i.information.destinationCountry)}).catch(function(n){console.log("Missing translation "+n)})}function h(){u.open(f.get("infoUrlEstaInformation"),"ESTAHeaderText")}var o=[n("RegisterESTAInformationBoxPart1")],e=this;e.showEsta=i.information.showEstaInfo;e.showModal=h;e.externalUrlESTADeepLink=f.get("externalUrlESTADeepLink");s()}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasEstaBox",["templateBase",function(n){return{restrict:"EA",scope:{information:"="},templateUrl:n+"shared/components/identification/estaBox.tpl.html",controller:"EstaBoxCtrl",controllerAs:"vm"}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasEstaInfo",["templateBase",function(n){return{restrict:"A",templateUrl:n+"shared/components/identification/estaInfo.tpl.html",scope:{model:"="},link:function(){}}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasPassportInfo",["$state","deviceSvc","templateBase",function(n,t,i){return{restrict:"A",templateUrl:i+"shared/components/identification/passportInfo.tpl.html",scope:{model:"="},link:function(n){n.isTravelAssistant=t.isTravelAssistant}}}])}(),function(){"use strict";angular.module("nas.shared").directive("nasInfoBox",["$timeout","smoothScroll","templateBase","deviceSvc",function(n,t,i,r){return{restrict:"A",replace:!0,scope:{items:"=?",header:"=",type:"=",showBox:"=?",showIcon:"=?",showList:"=?",showDismissIcon:"=?",action:"=?",actionLabel:"=?",timestamp:"=?",details:"=?",disableFocus:"=?"},templateUrl:i+"shared/components/infoBox/infoBox.tpl.html",link:function(i,u){i.showIcon=i.showIcon==undefined?!0:i.showIcon;i.showBox=i.showBox==undefined?!0:i.showBox;i.showDismissIcon=i.showDismissIcon==undefined?!0:i.showDismissIcon;i.expandDetails=!1;i.dismiss=function(){i.items=[]};i.showDetails=function(){i.expandDetails=!i.expandDetails};i.disableFocus||i.$watch("items",function(f){f&&f.length>0&&(i.enableAnimation=!r.height.lg(),n(function(){i.enableAnimation&&t(angular.element(u)[0],{offset:20});var n=angular.element(u)[0];n&&n.focus()},1e3))})}}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasLinkList",["$translate","templateBase",function(n,t){return{restrict:"A",templateUrl:t+"shared/components/linklist/linklist.tpl.html",replace:!0,scope:{list:"=",isBulleted:"="}}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("loginRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/login",{},{save:{method:"POST",custom400handling:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasLoginBox",["templateBase",function(n){return{restrict:"EA",scope:{onSuccess:"=",isPrimary:"=",hideRegister:"=",forgotpasswordState:"="},templateUrl:n+"shared/components/login/loginBox.tpl.html",controller:["$translate","$scope","stringutils","infoModal","loginRes","sitemapSvc",function(n,t,i,r,u,f){function o(n){n.$invalid||n.$pristine||(e.errorHeader="",e.errors=[],u.save(e.credentials).$promise.then(t.onSuccess).catch(function(n){n.data&&(e.errors=n.data.messageList,e.errorHeader=n.data.header);e.credentials.password="";t.loginBoxForm.password.$setPristine();t.loginBoxForm.password.$touched=!1}))}var e=this;e.login=o;e.credentials={};e.errorHeader="";e.errors=[];e.isPrimary=t.isPrimary;e.hideRegister=t.hideRegister;e.registerUrl=f.get("pageUrlProfileCreate");e.forgotUserNameUrl=f.get("infoUrlProfileForgotUserName");e.forgotPasswordUrl=f.get("pageUrlProfileForgotPwd");e.usernameRequiredText=i.format(n.instant("FormFieldRequired"),n.instant("ProfileEmailLabel")).replace(/\"/g,"");e.passwordRequiredText=i.format(n.instant("FormFieldRequired"),n.instant("ProfileEditPasswordLabel")).replace(/\"/g,"");e.forgotpasswordState=t.forgotpasswordState;e.showModal=function(){r.open(e.forgotUserNameUrl)}}],controllerAs:"vm"}}])}(),function(){"use strict";function n(n,t,i,r){function o(t){t.$invalid||t.$pristine||n.onSearch&&n.onSearch()(u.reservation)}var u=this,f,e;u.errorHeader=n.errorHeader;u.errors=n.errors;u.search=o;u.refrenceRequiredText=i.format(t.instant("FormFieldRequired"),t.instant("MyNorwegianBookingReference")).replace(/\"/g,"");u.lastnameRequiredText=i.format(t.instant("FormFieldRequired"),t.instant("ProfileLastName")).replace(/\"/g,"");f=r.getQuerystringParameter("pnr");e=r.getQuerystringParameter("pnrName");u.reservation={};f&&(u.reservation.pnr=f);e&&(u.reservation.pnrName=e)}var t=angular.module("nas.shared");t.directive("nasLookup",["$translate","templateBase",function(t,i){return{restrict:"EA",scope:{title:"@",subtitle:"@",button:"@",titleKey:"@",subtitleKey:"@",buttonKey:"@",buttonModifier:"=",onSearch:"&?",errors:"=",errorHeader:"=",showTravelReceiptCheckbox:"="},templateUrl:i+"shared/components/lookup/lookup.tpl.html",controller:n,controllerAs:"vm",link:function(n){function i(i,r){t(i).then(function(t){n[r]=n[r]||t})}n.titleKey&&i(n.titleKey,"title");n.subtitleKey&&i(n.subtitleKey,"subtitle");n.buttonKey&&i(n.buttonKey,"button")}}}]);n.$inject=["$scope","$translate","stringutils","urlHelper"]}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("lookupRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/mynorwegian/lookup",{},{get:{method:"GET",custom400handling:!0}})}])}(),function(){"use strict";function n(n,t,i){function u(n){t.get(n).$promise.then(function(){i.onSuccessLookup({pnr:n.pnr,pnrName:n.pnrName})}).catch(function(n){r.errors=n.data.messageList;r.errorHeader=n.data.header})}var r=this;r.errorHeader="";r.errors=[];r.search=u}var t=angular.module("nas.shared");t.directive("nasPreProcessLookup",["$translate","templateBase",function(t,i){return{restrict:"EA",scope:{titleKey:"@",title:"@",onSuccessLookup:"="},templateUrl:i+"shared/components/lookup/preProcessLookup.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$window","lookupRes","$scope"]}(),function(){"use strict";function n(n,t,i){function u(u){t.get(u).$promise.then(function(t){n.location=u.includeCanceled?i.get("pageUrlTravelReceiptPdf")+"?pnr="+u.pnr+"&pnrLocal="+t.pnrLocal:i.get("landingPageBookingDetails")+"?pnr="+u.pnr+"&pnrName="+u.pnrName})["catch"](function(n){r.errors=n.data.messageList;r.errorHeader=n.data.header})}var r=this;r.errorHeader="";r.errors=[];r.search=u}var t=angular.module("nas.shared");t.directive("nasReservationLookup",["$translate","templateBase",function(t,i){return{restrict:"EA",scope:{titleKey:"@",title:"@"},templateUrl:i+"shared/components/lookup/reservationLookup.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$window","lookupRes","sitemapSvc"]}(),function(){"use strict";angular.module("nas.shared").directive("nasNetworkStatus",["templateBase",function(n){return{restrict:"A",scope:{},templateUrl:n+"shared/components/networkStatus/networkStatus.tpl.html",controller:["$window","$timeout","$filter",function(n,t,i){var r=this;r.showOfflineNotification=!1;angular.element(n).bind("offline",function(){r.timestamp=i("outputDateTime")(new Date).toString();t(function(){r.showOfflineNotification=!0})});angular.element(n).bind("online",function(){t(function(){r.showOfflineNotification=!1})})}],controllerAs:"vm"}}])}(),function(){"use strict";angular.module("nas.shared").directive("nasNextTrip",["templateBase",function(n){return{restrict:"EA",templateUrl:n+"shared/components/nextTrip/nextTrip.tpl.html",scope:{trip:"="},controller:["$scope","$window","sitemapSvc",function(n,t,i){var r=this;r.trip=n.trip;r.go=function(n){t.location.href=i.get("landingPageBookingDetails")+"?pnr="+n.pnr}}],controllerAs:"vm"}}])}(),function(){"use strict";angular.module("nas.shared").directive("nasNotifier",["notifierSvc","templateBase",function(n,t){return{restrict:"A",replace:!0,scope:{},templateUrl:t+"shared/components/notifier/notifier.tpl.html",controller:function(){var t=this;t.notifications=n.notifications;t.dismiss=function(){t.items=[]}},controllerAs:"vm"}}]).factory("notifierSvc",["$timeout","$rootScope",function(n,t){function r(t,r,f){(u=!0,n(function(){u=!1},2e3),r.type=t,r.showIcon=r.showIcon==undefined?!1:r.showIcon,f==!0&&e(r))||(i.push(r),r.timeout&&n(function(){i.splice(i.indexOf(r),1)},r.timeout*1e3))}function e(n){if(i.length==0||n.items==undefined||n.items.length==0)return!1;var t=_.find(i,function(t){return t.items&&t.items.length>0&&t.items[0]==n.items[0]});return t?!0:!1}function f(){i.length=0}var i=[],u=!1;return t.$on("showSuccessMessage",function(n,t){r("success",t,!1)}),t.$on("showInfoMessage",function(n,t){r("information",t,!1)}),t.$on("showInfoMessageUnique",function(n,t){r("information",t,!0)}),t.$on("showErrorMessage",function(n,t){r("error",t,!1)}),t.$on("hideMessage",function(n,t){var r,u;i.length>0&&(r=_.find(i,["items",t.items]),r&&(u=i.indexOf(r),i.splice(u,1)))}),t.$on("$stateChangeStart",function(){u||f()}),t.$on("clearMessages",function(){f()}),{addMessage:r,notifications:i}}])}(),function(){"use strict";function n(n,t,i){function f(){u()}function e(){r.mode=1}function u(){r.errorHeader="";r.errors=[];r.oneOffCodeOptionsRequest.pnr=t.pnr;r.oneOffCodeOptionsRequest.pnrName=t.pnrName;i.getOneOffCodeOptions(r.oneOffCodeOptionsRequest).$promise.then(function(n){r.oneOffCodeOptions=n.options;r.sendOneOffCodeSubHeader=n.subHeader}).catch(function(n){n.data&&(r.errors=n.data.messageList,r.errorHeader=n.data.header)})}function o(n){n.$valid&&(r.errorHeader="",r.errors=[],r.oneOffCodeRequest.pnr=t.pnr,r.oneOffCodeRequest.pnrName=t.pnrName,r.oneOffCodeRequest.oneOffCodeType=r.selectedOneOffCodeOption,i.sendOneOffCode(r.oneOffCodeRequest).$promise.then(function(n){r.successfullySentMessage=n.message;r.mode=2}).catch(function(n){n.data&&(r.errors=n.data.messageList,r.errorHeader=n.data.header)}))}function s(n){n.$valid&&(r.errorHeader="",r.errors=[],r.loginOneOffCodeRequest.pnr=t.pnr,r.loginOneOffCodeRequest.pnrName=t.pnrName,i.loginOneOffCode(r.loginOneOffCodeRequest).$promise.then(t.onSuccessLogin).catch(function(n){n.data&&(r.errors=n.data.messageList,r.errorHeader=n.data.header)}))}function h(n){r.selectedOneOffCodeOption=n.selected}var r=this;r.mode=1;r.getOneOffCodeOptions=u;r.sendOneOffCode=o;r.loginOneOffCode=s;r.oneOffCodeOptionSelectedHandler=h;r.goBack=e;r.errorHeader="";r.errors=[];r.oneOffCodeOptionsRequest={};r.oneOffCodeRequest={};r.loginOneOffCodeRequest={};f()}var t=angular.module("nas.shared");t.directive("nasOneOffCode",["templateBase",function(t){return{restrict:"EA",scope:{onSuccessLogin:"=",pnr:"=",pnrName:"=",pnrLocal:"="},templateUrl:t+"shared/components/oneOffCode/oneOffCode.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$state","$scope","oneOffCodeRes"]}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("oneOffCodeRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/oneOffCode/:action",{},{getOneOffCodeOptions:{method:"GET",custom400handling:!0,params:{action:"getOneOffCodeOptions"}},sendOneOffCode:{method:"POST",custom400handling:!0,params:{action:"sendOneOffCode"}},loginOneOffCode:{method:"POST",custom400handling:!0,params:{action:"loginOneOffCode"}}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasPaymentSelection",["templateBase","formValidation",function(n,t){return{restrict:"EA",templateUrl:n+"shared/components/payment/payment.tpl.html",scope:{selection:"=",bypassPayment:"=",paymentOptions:"=",paymentCards:"=",storedCards:"=",isTdsRequired:"=",cardNumberErrors:"=",holderNameErrors:"=",cvc2CodeErrors:"=",cardExpirationErrors:"=",cardTypeErrors:"="},require:"^^form",replace:!0,link:function(n,i,r,u){n.vm.topForm=t.findTopLevelForm(u)},controller:["$scope","$timeout","$translate","optionUtilsSvc","infoModal","sitemapSvc","nasConfig",function(n,i,r,u,f,e,o){function c(){var i=s.cardNumberErrors?s.cardNumberErrors.subscribe(function(n){t.setFieldError(s.paymentSelectionForm,"paymentCcNumber",n)}):undefined,r=s.holderNameErrors?s.holderNameErrors.subscribe(function(n){t.setFieldError(s.paymentSelectionForm,"paymentCcHolderName",n)}):undefined,u=s.cvc2CodeErrors?s.cvc2CodeErrors.subscribe(function(n){t.setFieldError(s.paymentSelectionForm,"paymentCvc",n)}):undefined,f=s.cardExpirationErrors?s.cardExpirationErrors.subscribe(function(n){t.setFieldError(s.paymentSelectionForm,"expirationMonth",n);t.setFieldError(s.paymentSelectionForm,"expirationYear",n)}):undefined,e=s.cardTypeErrors?s.cardTypeErrors.subscribe(function(n){t.setFieldError(s.paymentSelectionForm,"paymentCcType",n)}):undefined;n.$on("$destroy",function(){i&&i.dispose();r&&r.dispose();u&&u.dispose();f&&f.dispose();e&&e.dispose()})}function l(n){s.disableCc=n.selected==="Cashpoints"||n.selected==="Swish";s.disableCvC=s.disableCc;s.disableHolderName=s.disableCc}function a(n,t){f.open(n,t)}function v(n){s.selection.holderName=n?n.holderName:"";s.selection.cardNumber=n?n.number:"";s.selection.cardType=n?n.type:"";s.selection.cardExpirationYear=n?n.expirationYear:"";s.selection.cardExpirationMonth=n?n.expirationMonth:"";s.selection.disableCvC=n?n.cvcDisabled:!1;p()}function y(n,t){return function(i){u.resetSelectedOptions(n);i&&(i.selected=!0);t(i)}}function p(){i(function(){s.paymentSelectionForm.paymentCcNumber.$setValidity("server",!0);s.paymentSelectionForm.paymentCcHolderName.$setValidity("server",!0);s.paymentSelectionForm.paymentCvc.$setValidity("server",!0);s.paymentSelectionForm.expirationMonth.$setValidity("server",!0);s.paymentSelectionForm.expirationYear.$setValidity("server",!0);s.paymentSelectionForm.paymentCcType.$setValidity("server",!0)})}function w(){s.storedCards&&s.storedCards.length!==0&&(_.each(s.storedCards,function(n){n.displayName=n.description?n.number+" - "+n.description:n.number;n.preferred&&(s.selectedStoredPaymentCard=n)}),s.updateStoredPaymentCardSelection=y(s.storedCards,function(n){v(n)}),n.$watch("vm.selection.storedCardId",function(n){var t=_.find(s.storedCards,["id",parseInt(n,10)]);s.updateStoredPaymentCardSelection(t)}),s.selectedStoredPaymentCard&&(s.selection.storedCardId=s.selectedStoredPaymentCard.id))}function b(){s.selection.selectedPaymentOptionType="CreditCard";s.selection.tdsInputModel={userWantTds:{isChecked:!0,isVisible:!0}};s.selection.holderName=s.selection&&s.selection.holderName?s.selection.holderName:"";s.selection.cardType=s.selection&&s.selection.cardType?s.selection.cardType:"";s.selection.cardNumber=s.selection&&s.selection.cardNumber?s.selection.cardNumber:"";s.selection.cvcCode=s.selection&&s.selection.cvcCode?s.selection.cvcCode:"";s.selection.disableCvC=s.selection&&s.selection.disableCvC?s.selection.disableCvC:!1}function k(){o.useLuhnValidation&&i(function(){s.paymentSelectionForm.paymentCcNumber.$validators.luhn=h});b();w();s.infoUrlNorwegianSecurity=e.get("infoUrlNorwegianSecurity");s.infoUrlCvcInfo=e.get("infoUrlNorwegianCvcInfo");s.months=[{value:1,name:"01"},{value:2,name:"02"},{value:3,name:"03"},{value:4,name:"04"},{value:5,name:"05"},{value:6,name:"06"},{value:7,name:"07"},{value:8,name:"08"},{value:9,name:"09"},{value:10,name:"10"},{value:11,name:"11"},{value:12,name:"12"}];s.years=[{value:2016,name:"2016"},{value:2017,name:"2017"},{value:2018,name:"2018"},{value:2019,name:"2019"},{value:2020,name:"2020"},{value:2021,name:"2021"},{value:2022,name:"2022"},{value:2023,name:"2023"},{value:2024,name:"2024"},{value:2025,name:"2025"},{value:2026,name:"2026"}];s.emptyMonth="- "+r.instant("PaymentSelectExpiryMonth")+" -";s.emptyYear="- "+r.instant("PaymentSelectExpiryYear")+" -";s.cvcHeader=r.instant("PaymentCvc");s.termurllist=[];_.forEach([{term:"PaymentTermsReadComplete",url:"infoUrlReadCompleteTermsUrl"},{term:"PaymentConfirmTermsGeneralConditionsLinkText",url:"infoUrlNorwegianGeneralConditionsOfCarriage"},{term:"PaymentConfirmTermsFareRulesLinkText",url:"infoUrlReadCompleteTermsUrl"},{term:"PaymentConfirmTermsBaggageRulesLinkText",url:"infoUrlNorwegianBaggageInfo"},{term:"PaymentConfirmTermsDangerousGoodsLinkText",url:"infoUrlDangerousGoods"}],function(n){var t=r.instant(n.term),i=e.get(n.url);t&&i&&t!==n.term&&s.termurllist.push({url:i,text:t})});n.$watch("vm.selection.cardType",function(n){if(n){var t=_.find(s.paymentCards,["type",n]);t||(t=_.find(s.paymentCards,["type",n.substring(0,2)]),t&&(s.selection.cardType=t.type));s.selection.disableCvC=t!=undefined?t.cvcDisabled:!0;s.disableCvC=s.selection.disableCvC}});n.$watch("vm.disableCc",function(n){n&&s.paymentSelectionForm.expirationMonth&&i(function(){s.paymentSelectionForm.expirationMonth.$setValidity("required",n);s.paymentSelectionForm.expirationYear.$setValidity("required",n);s.paymentSelectionForm.paymentCcType.$setValidity("required",n)})});n.$watch("vm.disableCvC",function(n){n&&s.paymentSelectionForm.paymentCvc&&i(function(){s.paymentSelectionForm.paymentCvc.$setValidity("required",n)})});n.$watch("vm.disableHolderName",function(n){n&&s.paymentSelectionForm.paymentCcHolderName&&i(function(){s.paymentSelectionForm.paymentCcHolderName.$setValidity("required",n)})})}var s=this,h;s.useReactSelectBoxes=o.useReactSelectBoxes;s.selection=n.vm.selection;s.selection.bypassPayment=n.vm.bypassPayment;n.$watch("vm.bypassPayment",function(n){s.selection.bypassPayment=n});s.hideTerms=!1;s.selection.hideTerms&&(s.hideTerms=!0);s.disableCc=s.selection.disableCc==undefined?!1:s.selection.disableCc;s.disableCvC=!1;s.disableHolderName=!1;s.paymentOptions=n.vm.paymentOptions;s.paymentCards=n.vm.paymentCards;s.storedCards=n.vm.storedCards;s.isTdsRequired=n.vm.isTdsRequired;s.openModal=a;s.paymentOptionSelected=l;s.ariaCvcText=r.instant("PaymentCvcExplaination");c();k();h=function(n){return function(t){for(var u=t.length,f=1,i=0,r;u;)r=parseInt(t.charAt(--u),10),i+=(f^=1)?n[r]:r;return i&&i%10==0}}([0,2,4,6,8,1,3,5,7,9])}],controllerAs:"vm",bindToController:!0}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.controller("PaymentCardCtrl",["storedCardsRes","sitemapSvc",function(n,t){var i=this;i.creditcardUrl=t.get("pageUrlProfileCreditCardEdit");n.query().$promise.then(function(n){i.cards=n})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasPaymentCard",["templateBase",function(n){return{restrict:"EA",scope:{},templateUrl:n+"shared/components/paymentCard/paymentCard.tpl.html",controller:"PaymentCardCtrl",controllerAs:"vm"}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("paymentCardsRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/paymentcards",{},{get:{method:"GET"}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("storedCardsRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/storedPaymentCards/:action",{},{get:{method:"GET",custom400handling:!0,isArray:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.controller("ProfileSummaryCtrl",["$scope","$q","rewardSvc","countriesRes","stringutils","$translate","sitemapSvc",function(n,t,i,r,u,f,e){function s(){var n=t.defer();return r.get().$promise.then(function(t){n.resolve(t)}),n.promise}var o=this;o.show=!1;t.all([s(),i.getRewardInfo()]).then(function(n){o.rewardInfo=n[1].reward;var t=n[0].countries.filter(function(n){return n.countryCode==o.profileInfo.country});t.length>0&&(o.profileInfo.countryDisplayName=t[0].countryName);o.show=!0});o.profileInfo={};o.pageUrlClaimCashPointsLookup=e.get("pageUrlClaimCashPointsLookup");o.externalUrlNorwegianRewarDeepLink=e.get("externalUrlNorwegianRewarDeepLink");o.profileInfo=n.profileInfo();o.changeUsernameInfoBoxText=u.format(f.instant("ChangeUsernameInfoTextBox"),"<em>"+o.profileInfo.profile.username+"<\/em>");o.pageUrlProfileEdit=e.get("pageUrlProfileEdit");o.pageUrlShowCashPoints=e.get("pageUrlShowCashPoints")}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasProfileSummary",["templateBase",function(n){return{restrict:"EA",scope:{profileInfo:"&"},templateUrl:n+"shared/components/profileSummary/profileSummary.tpl.html",controller:"ProfileSummaryCtrl",controllerAs:"vm"}}])}(),function(){"use strict";function n(n,t,i,r){var u=this;u.bookingSteps=t.getStepsToDisplay();u.goTo=function(n){n.visited&&t.goToStep(n)};u.activeStepName=n.activeStepName;u.getArialabel=function(n){var t="ProgressionNextStep";return u.activeStepName===n.name&&(t="ProgressionCurrentStep"),n.visited&&(t="ProgressionPreviousStep"),r.format("{0} {1}",i.instant(t),i.instant(n.titleKey))};u.isActiveStep=function(n){return _.includes(n.isActiveFor,u.activeStepName)}}angular.module("nas.shared").directive("nasProgression",["progressionSvc","templateBase",function(t,i){return{restrict:"A",templateUrl:i+"shared/components/progression/progression.tpl.html",scope:{activeStepName:"="},controller:n,controllerAs:"vm"}}]);n.$inject=["$scope","progressionSvc","$translate","stringutils"]}(),function(){"use strict";angular.module("nas.shared").factory("progressionSvc",["$q","$rootScope","$window","$state","progressModelSvc",function(n,t,i,r,u){function e(){return _.find(f,function(n){return n.name===r.$current.name})}function h(){var n=e();return _.find(f.slice(f.indexOf(n)+1),function(n){return n.enabled})}function c(){var n=e();return _.findLast(f.slice(0,f.indexOf(n)),function(n){return n.enabled})}function l(n){var t=h(),i=n?n:t.params;r.go(t.name,i)}function a(){var n=c();n?r.go(n.name,n.params):r.go(u.getFallbackStateName(),u.getFallbackStateParam())}function o(){f=f||[];_.forEach(f.slice(0,f.indexOf(e())),function(n){n.visited=!0})}function s(){_.forEach(f,function(n){n.visited=!1})}function v(n){return _.find(f,function(t){return t.name===n})}function y(){return _.filter(f,function(n){return n.enabled&&n.isActiveFor.length>0})}function p(n){typeof n=="string"&&(n=v(n));r.go(n.name,n.params)}function w(){f=u.getProgressModel();s();o()}var f=u.getProgressModel();return t.$on("$stateChangeSuccess",function(){s();o()}),{init:w,goBack:a,goForward:l,getStepsToDisplay:y,goToStep:p}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.controller("ReceiptCtrl",["$scope","$stateParams","$q","$translate","stringutils","deviceSvc","sitemapSvc","$window","reservationUrlSvc",function(n,t,i,r,u,f,e,o,s){var h=this,c;h.pnr=h.receiptData.booking.pnr;h.pnrLocal=h.receiptData.booking.pnrLocal;h.pnrName=h.receiptData.booking.pnrName;h.receipt=h.receiptData;h.apisEstaInfo=h.receiptData.apisEstaInfo;h.isTravelAssistant=f.isTravelAssistant;h.isPlusSaleHotelEnabled=h.receiptData.isPlusSaleHotelEnabled;h.isPlusSaleHotelNewVendorEnabled=h.receiptData.isPlusSaleHotelNewVendorEnabled;h.hotelSearchModel={};c=h.receiptData.booking.routeList[0].flights;h.hotelSearchModel.destinationFlight=c[c.length-1];h.receiptData.booking.tripType!=="OneWay"&&(h.hotelSearchModel.departureFlight=h.receiptData.booking.routeList[1].flights[0]);h.carTrawlerWidget=h.receiptData.carTrawlerWidget;h.receipt.domesticSpainDiscountText=h.receiptData.subsidyDescription+" "+r.instant("DomesticSpainDiscountApplied");h.toMyReservation=function(){var n={pnr:h.pnr,pnrLocal:h.pnrLocal,pnrName:h.pnrName};o.location.href=s.getReservationUrl(n)}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasReceipt",["$state","templateBase",function(n,t){return{restrict:"A",templateUrl:t+"shared/components/receipt/receipt.tpl.html",scope:{receiptData:"="},controller:"ReceiptCtrl",controllerAs:"vm",bindToController:!0}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasReceiptDetails",["templateBase",function(n){return{restrict:"A",templateUrl:n+"shared/components/receiptDetails/receiptDetails.tpl.html",scope:{model:"=",isFlightDetailsExpandable:"=",isFlightDetailsExpanded:"="},controller:["$scope","$translate","$stateParams","$state","deviceSvc",function(n,t,i,r,u){var f=this;f.model=n.model;f.isFlightDetailsExpandable=n.isFlightDetailsExpandable;f.isFlightDetailsExpanded=n.isFlightDetailsExpanded;f.isTravelAssistant=u.isTravelAssistant;f.isSubsidyApplied=f.model.totalSubsidy>0;f.journeyText=t.instant("Journey");f.outboundFlightText=t.instant("OutboundFlight");f.inboundFlightText=t.instant("InboundFlight");f.getRouteHeader=function(n,t){return n==="TwoWayReturn"&&t===0?f.outboundFlightText:n==="TwoWayReturn"&&t===1?f.inboundFlightText:n==="OneWay"?f.outboundFlightText:f.journeyText.concat(" ",t+1)}}],controllerAs:"vm"}}])}(),function(){"use strict";angular.module("nas.shared").directive("nasRouteList",["templateBase",function(n){return{restrict:"EA",templateUrl:n+"shared/components/routeList/routeList.tpl.html",scope:{routeList:"=",selectedFlight:"="},controller:["$translate","stringutils",function(){var n=this}],controllerAs:"vm"}}])}(),function(){"use strict";angular.module("nas.shared").directive("nasRouteListSelect",["templateBase",function(n){return{restrict:"A",replace:!0,templateUrl:n+"shared/components/routeListSelect/routeListSelect.tpl.html",scope:{routeList:"=",selectedFlight:"=",onFlightChanged:"&"},controller:["$scope",function(){var n=this}],controllerAs:"vm",bindToController:!0}}])}(),function(){"use strict";function n(n,t){function f(){i.isExpanded=!i.isExpanded;u()}function u(){i.detailsText=i.isExpanded?i.detailsTextDoClose:i.detailsTextDoOpen}var r=t.instant("ReservationDetailsFlightDetails"),i=this;i.toggle=f;i.detailsTextDoOpen=r.concat(" (+)");i.detailsTextDoClose=r.concat(" (-)");i.detailsText=i.detailsTextDoOpen;u()}var t=angular.module("nas.shared");t.directive("nasFlightDetails",["templateBase",function(t){return{restrict:"EA",scope:{items:"=",isExpandable:"=",isExpanded:"="},templateUrl:t+"shared/components/routeSummary/flightDetails.tpl.html",controller:n,controllerAs:"vm",bindToController:!0}}]);n.$inject=["$scope","$translate"]}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasFlightDetailsSimple",["templateBase",function(n){return{restrict:"EA",scope:{flight:"="},templateUrl:n+"shared/components/routeSummary/flightDetailsSimple.tpl.html"}}])}(),function(){"use strict";angular.module("nas.shared").directive("nasRouteSummary",["templateBase",function(n){return{restrict:"EA",templateUrl:n+"shared/components/routeSummary/routeSummary.tpl.html",scope:{enableflightdetails:"=",route:"=",hideActionButtons:"=",isFlightDetailsExpandable:"=",isFlightDetailsExpanded:"="},controller:["$translate","stringutils",function(n,t){function u(n){var t=r(n.flights[0].localDepartureDate);angular.forEach(n.flights,function(n){n.offsetDaysDeparture=r(n.localDepartureDate).diff(t,"days");n.offsetDaysArrival=r(n.localArrivalDate).diff(t,"days");n.estimatedDepartureDateFormatted&&(n.offsetDaysEstimatedDeparture=r(n.estimatedDepartureDate).diff(t,"days"))})}function r(n){return moment.utc(n,"YYYY.MM.DD")}function f(){if(u(i.route),i.lastIndex=i.route.flights.length-1,i.route.isTransit){var n=angular.copy(i.route.flights);n.splice(0,1);i.stops=n}}var i=this;i.enableflightdetails=i.enableflightdetails||!1;i.hideActionButtons=i.hideActionButtons||!1;i.isFlightDetailsExpandable=i.isFlightDetailsExpandable||!1;i.isFlightDetailsExpanded=i.isFlightDetailsExpanded||!1;i.route&&(f(),i.myNorwegianDepartureText=n.instant("MyNorwegianDeparture"),i.route.isTransit?(i.route.durationHours>0&&(i.durationText=t.format(n.instant("ReservationDetailsRouteDurationTransitHoursMinutes"),i.route.durationHours,i.route.durationMinutes)),i.route.durationHours===0&&(i.durationText=t.format(n.instant("ReservationDetailsRouteDurationTransitMinutes"),i.routeMinutes))):(i.route.durationHours>0&&(i.durationText=t.format(n.instant("ReservationDetailsRouteDurationHoursMinutes"),i.route.durationHours,i.route.durationMinutes)),i.route.durationHours===0&&(i.durationText=t.format(n.instant("ReservationDetailsRouteDurationMinutes"),i.route.durationMinutes))));i.hourdiff=function(n,t){var i=new Date(n),r=new Date(t),u=i-r;return Math.floor(u%864e5/36e5)};i.mindiff=function(n,t){var i=new Date(n),r=new Date(t),u=i-r;return Math.round(u%864e5%36e5/6e4)}}],controllerAs:"vm",bindToController:!0}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasFareinfo",["$q","$translate","sitemapSvc","stringutils",function(n,t,i,r){return{controller:["$scope","infoModal",function(n,t){n.openModal=function(n,i){t.open(n,i.substring(0,1).toUpperCase()+i.substring(1))}}],template:function(){var u="<button class=\"link\" data-ng-click=\"openModal('{0}', '{1}')\">{1}<\/button>",h=t.instant("ResSelectionFareInfoFullText"),f=t.instant("ResSelectionFareInfoLinkText"),n=t.instant("ResSelectionOptionalChargesFullText"),c=i.get("infoUrlReadCompleteTermsUrl"),l=i.get("infoUrlCreditCardPayment"),a=i.get("infoUrlBaggageCharges"),v=i.get("infoUrlAdditionalFeesPriceList"),e=t.instant("ResSelectionOptionalChargesCreditCardFeeLinkText"),o=t.instant("ResSelectionOptionalChargesBaggageLinkText"),s=t.instant("ResSelectionOptionalChargesOptionalServicesLinkText");return n=n.replace(e,r.format(u,l,e)),n=n.replace(o,r.format(u,a,o)),n=n.replace(s,r.format(u,v,s)),'<div><h3 data-translate="ResSelectionOurFaresHeader"><\/h3>'+h.replace(f,r.format(u,c,f))+'<br><br><h3 data-translate="ResSelectionOptionalChargesHeader"><\/h3>'+n+"<\/div>"},replace:!0}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasResselection",["$q","$translate","stringutils","templateBase",function(n,t,i,r){return{restrict:"A",templateUrl:r+"shared/components/selection/selection.tpl.html",replace:!0,scope:{model:"=",isUpdating:"=",hideHeader:"="},link:function(n){function u(){n.model.cashpointBalance&&(n.cashpointBalanceText=i.format(f,n.model.cashpointBalance,r));n.remainingBalanceText=i.format(e,r)}function o(){var t=!1;return n.model&&(n.model.items&&(t=_.some(n.model.items,function(n){return n.details&&n.details.length>0})),!t&&n.model.routeList&&n.model.routeList.length>0&&_.forEach(n.model.routeList,function(n){t=_.some(n.items,function(n){return n.details&&n.details.lenght>0})})),t}var f=t.instant("LoyaltyTitleBalance"),e=t.instant("TravelDetailsLoyaltyFooter"),r=t.instant("LoyaltyCurrency"),s=n.$watch("model",function(){n.model&&(s(),u(),n.hasExpandableDetails=o())});n.$watch("model.showReceiptDetails",function(t){n.model&&n.model.items&&(u(),_.forEach(n.model.items,function(n){n&&(n.expandDetails=!!t)}),_.forEach(n.model.routeList,function(n){n&&_.forEach(n.items,function(n){n&&(n.expandDetails=!!t)})}))})}}}])}(),function(){"use strict";angular.module("nas.shared").directive("nasTripsList",["templateBase",function(n){return{restrict:"EA",replace:!0,templateUrl:n+"shared/components/tripsList/tripsList.tpl.html",scope:{trips:"&",size:"&",reverse:"&",emptyTexts:"&"},controller:["$scope",function(n){var t=this;t.show=!1;t.emptyTexts=n.emptyTexts();t.allTrips=n.trips();n.reverse()&&t.allTrips.reverse();t.trips=n.size()?n.trips().slice(0,n.size()):n.trips();t.show=!0}],controllerAs:"vm"}}])}(),function(){"use strict";angular.module("nas.shared").directive("nasTripsummary",["templateBase","$translate",function(n,t){return{restrict:"EA",scope:{routelist:"=",header:"="},templateUrl:n+"shared/components/tripSummary/trip.summary.tpl.html",controller:["$scope",function(n){var i=this;i.header=n.header;i.routeList=n.routelist;i.getRouteTypeName=function(n){switch(n){case"Outbound":return t.instant("OutboundFlight");case"Inbound":return t.instant("InboundFlight");default:return t.instant("UnspesifiedFlight")}}}],controllerAs:"vm"}}])}(),function(){"use strict";function t(n,t){for(var r=[],u,i=0;i<n.length;i++)u=n[i][t],r.indexOf(u)==-1&&r.push(u);return r}var n=angular.module("nas.shared");n.filter("airportName",function(){return function(n){return n.displayName+" ("+n.code+")"}});n.filter("airportDisplayname",["airportsSvc",function(n){return function(t){return n.get(t).displayName}}]);n.filter("prefixDisplayName",function(){return function(n){return n.value?{name:n.name+" ("+n.value+")",value:n.value}:n.phonePrefix?{name:n.countryName+" ("+n.phonePrefix+")",value:n.phonePrefix}:n.name||n.countryName}});n.filter("normalizePrefix",function(){return function(n){return _.map(n,function(n){return n.name?{name:n.name+" ("+n.value+")",value:n.value}:n.phonePrefix?{name:n.countryName+" ("+n.phonePrefix+")",value:n.phonePrefix}:n})}});n.filter("timespan",function(){return function(n,t){var r,u,f,i=moment.duration(moment(t).diff(moment(n)));return i.days()>0&&(r=i.days()+"d"),i.hours()>0&&(u=i.hours()+"h"),i.minutes()>0&&(f=i.minutes()+"m"),_.compact([r,u,f]).join(" ")}});n.filter("numberSpaces",function(){return function(n){return n?n.toString().replace(/\B(?=(\d{3})+(?!\d))/g," "):""}});n.filter("sumByKey",function(){return function(n,t){if(typeof n=="undefined"||typeof t=="undefined")return 0;var i=0;return _.forEach(n,function(n){var r=n[t]===""?"0":n[t].replace(/\s+/g,"").replace(/,/g,".");i+=parseFloat(r)}),new Intl.NumberFormat("nb-NO",{minimumFractionDigits:2}).format(i)}});n.filter("fullName",function(){return function(n){return n.firstname+" "+n.lastname}});n.filter("price",function(){return function(n){return angular.isDefined(n)&&n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}});n.filter("groupBy",function(){return function(n,i){if(n!==null)return t(n,i)}});n.filter("range",[function(){return function(n,t,i){for(var r=t;r<=i;r++)n.push(r);return n}}]);n.filter("stripTimeZone",function(){return function(n){var t;return t=n instanceof Date&&!isNaN(n.valueOf())?n.toISOString():""+n,new Date(t.substring(0,t.length-6))}});n.filter("outputDateTime",["$filter",function(n){return function(t){return n("date")(t,"mediumDate")+" "+n("date")(t,"shortTime")}}]);n.filter("routeCount",function(){return function(n,t,i,r){return _.filter(n,function(n,u){return u<i||!n.isTransit||n.routeId==t||r})}})}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("agreementCodesRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/profile/agreementcodes",{},{get:{method:"GET",custom400handling:!0,isArray:!0},save:{method:"POST",custom400handling:!0,isArray:!0},"delete":{method:"DELETE",custom400handling:!0,isArray:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("availabilitySearchRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/availabilitySearch/:action",{},{init:{method:"GET",params:{action:"init"}}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("countriesRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/countries",{},{get:{method:"GET",cache:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("currencyRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/currency",{agreementCode:""})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("destinations",["$http","nasConfig",function(n,t){return{get:function(i){return n.get(t.resourcePrefix+"/api/destinations",{params:{destinationModel:i||"AirportModel",includeRelations:!1,v:t.cacheBuster,sortByCountryAndName:!1}})}}}]);n.factory("destinationsRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/destinations/:action",{destinationModel:"AirportModel",includeRelations:!1,v:t.cacheBuster,sortByCountryAndName:!1},{get:{method:"GET"},suggestions:{method:"GET",params:{action:"suggestions"},custom400handling:!0,custom500handling:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("newsletterRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/profile/newsletter/:action",{},{get:{method:"GET",custom400handling:!0},save:{method:"POST",custom400handling:!0,params:{action:"saveNewsletter"}},supportedAirports:{method:"GET",custom400handling:!0,params:{action:"supportedAirports"}}})}])}(),function(){"use strict";angular.module("nas.shared").factory("availabilitySearchSvc",["$q","$window","urlHelper","userSelectionSvc","availabilitySearchRes",function(n,t,i,r,u){function f(t){var f=n.defer(),i;return t?(i=t,i.userSelection=r.init(i.userSelection),f.resolve(i)):u.init().$promise.then(function(n){i=n;i.userSelection=r.init(i.userSelection);f.resolve(i)}),f.promise}function e(n,u){n.isRoundTrip=n.tripType==="OneWay"?!1:!0;var f=r.getStateParams(n);t.location.href=n.isGroupSearch||n.isGroupBooking?i.buildUrl(u.pageUrlGroupTravelAvaDay,f):n.isAllotmentSearch?i.buildUrl(u.pageUrlAllotmentBooking,f):n.resultType==="AvaDay"?i.buildUrl(u.pageUrlAvailabilityAvaDay,f):i.buildUrl(u.pageUrlAvailabilityFareCalendar,f)}return{init:f,search:e}}])}(),function(){"use strict";angular.module("nas.shared").factory("currencySvc",["currencyRes",function(n){var t=_.memoize(function(t){return n.get({agreementCode:t})});return{getCurrencies:t}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("airportsSvc",["destinations","$sessionStorage","$q",function(n,t,i){var u=i.defer(),r=t.airports;return r||(r=t.airports=[]),r&&r.length>0?u.resolve(r):n.get().success(function(n){r=t.airports=n.destinations;u.resolve(r)}),{airports:u.promise,get:function(n){return _.find(r,function(t){return t.code===n})||"-"}}}])}(),function(){"use strict";angular.module("nas.shared").factory("phoneNumberSvc",[function(){function t(t){if(!n||n.length===0){var i=_.filter(t,function(n){return n.phonePrefix!==""});n=_.map(i,function(n){return{prefix:n.phonePrefix,name:n.countryName+" ("+n.phonePrefix+")",value:n.phonePrefix+n.countryCode}})}return n}function i(n,t,i){if(t)return n?n+t:"";if(n){var r=_.find(i,function(t){return t.prefix==n});if(r)return r.value}return""}var n;return{getPhonePrefixes:t,getPrefixAndCountry:i}}])}(),function(){"use strict";angular.module("nas.shared").factory("bookingTemporaryDataSvc",["$sessionStorage",function(n){function t(t){n.bookingTemporaryData.paxData=t}function i(){n.bookingTemporaryData.paxData={}}function r(){return n.bookingTemporaryData&&n.bookingTemporaryData.paxData?angular.copy(n.bookingTemporaryData.paxData):null}return n.bookingTemporaryData=n.bookingTemporaryData||{},{storePaxData:t,getPaxData:r,clearPaxData:i}}])}(),function(){"use strict";angular.module("nas.shared").factory("codeSelectionSvc",["$sessionStorage","agreementCodesRes",function(n,t){function u(n){n?typeof n=="string"?(i.agreementCode=n,i.campaignCode=""):n.id&&(i.agreementCode=n.id,i.campaignCode=""):i.agreementCode="-1"}function f(n){n?(i.campaignCode=n.toUpperCase(),i.agreementCode=""):i.campaignCode=""}function e(){return i.agreementCodes}function o(){return i.agreementCode}function s(){return i.campaignCode}function h(n){r.finally(n)}var i=n.codeSelection,r=t.get().$promise;return i||(i=n.codeSelection={agreementCodes:[]}),r.then(function(n){i.agreementCodes=n}).catch(function(){i.agreementCode=""}),{done:h,setAgreementCode:u,setCampaignCode:f,getAgreementCodes:e,getAgreementCode:o,getCampaignCode:s}}])}(),function(){"use strict";angular.module("nas.shared").factory("progressModelSvc",["$sessionStorage",function(n){function t(t){t&&(n.progressModel=t)}function i(){return n.progressModel}function r(t){t&&(n.progressFallbackStateName=t)}function u(){return n.progressFallbackStateName}function f(t){t&&(n.progressFallbackStateParam=t)}function e(){return n.progressFallbackStateParam}return{setProgressModel:t,getProgressModel:i,setFallbackStateName:r,getFallbackStateName:u,setFallbackStateParam:f,getFallbackStateParam:e}}])}(),function(){"use strict";angular.module("nas.shared").factory("reservationDetailsSvc",["$sessionStorage",function(n){function t(t){n.updatedReservationDetailsModel=t}function i(){var t=null;return n.updatedReservationDetailsModel&&(t=angular.copy(n.updatedReservationDetailsModel),sessionStorage.removeItem("ngStorage-updatedReservationDetailsModel"),delete n.updatedReservationDetailsModel),t}return{store:t,tryGetAndRemove:i}}])}(),function(){"use strict";angular.module("nas.shared").factory("scheduleChangeSvc",["$sessionStorage",function(n){function t(t){var i=null;return n.acceptedPnrListForSC&&(i=_.filter(n.acceptedPnrListForSC,function(n){return n===t})),i}function i(t){n.acceptedPnrListForSC||(n.acceptedPnrListForSC=[]);n.acceptedPnrListForSC.push(t)}return{isPnrAccepted:t,addAcceptedPnr:i}}])}(),function(){"use strict";angular.module("nas.shared").factory("userSelectionSvc",["$sessionStorage",function(n){function f(n){var t=_.pick(n,["fareType","type","flights"]),i=_.pick(n.bundle,["isIncluded","priceCode"]);return t.bundle=i,t}function e(n){return n.charAt(0).toLowerCase()+n.slice(1)}function i(n,t){var i=_.pick(n,["routeId","selectedFare","flightList","origin","destination"]);return i.selectedFare=f(n[e(t)]),i}function r(){if(t.outboundRoute&&t.inboundRoute){var n=t.outboundRoute.flightList.length;_(t.inboundRoute.flightList).forEach(function(t,i){t.legRef=n+i+1})}}var t=n.userSelectionData||{},o=function(n){if(n){var i=moment(),r="00",u=i.month()+1,h=r.substring(0,r.length-u.toString().length)+u,f=moment((n.D_Month||i.year()+""+h)+(n.D_Day||i.date()),"YYYYMMDD"),c=n.R_Month&&n.R_Day?moment(n.R_Month+n.R_Day,"YYYYMMDD"):f,e=parseInt(n.AdultCount),o=parseInt(n.ChildCount),s=parseInt(n.InfantCount);t.origin=n.D_City||t.origin;t.destination=n.A_City||t.destination;t.outboundDate=f.format("YYYY-MM-DD")||t.outboundDate;t.inboundDate=c.format("YYYY-MM-DD")||t.inboundDate;t.adultCount=isNaN(e)?t.adultCount:e;t.childCount=isNaN(o)?t.childCount:o;t.infantCount=isNaN(s)?t.infantCount:s;t.isRoundTrip=parseInt(n.TripType)===1?!1:!0;t.includeTransit=""+n.IncludeTransit=="false"?!1:!0;t.campaignCode=n.AgreementCode||t.campaignCode;t.agreementCodeFK=n.AgreementCodeFK||t.agreementCodeFK;t.currencyCode=n.CurrencyCode||t.currencyCode;t.isSsrNeeded=""+n.IsSsrNeeded=="true"?!0:!1;t.tripType=t.isRoundTrip?"TwoWayReturn":"OneWay";t.domesticSpainModel={subsidyDefinitionId:n.SubsidyDefinitionId};t.resultType=t.resultType?t.resultType:"AvaDay";t.subsidyDefinitionId=typeof t.domesticSpainModel=="undefined"?null:t.domesticSpainModel.subsidyDefinitionId}},s=function(i){return n.userSelectionData||(t=n.userSelectionData=i),t},h=function(){var n=t,i={destination:n.destination,origin:n.origin,outboundDate:n.outboundDate,inboundDate:n.inboundDate,outboundFareType:n.outboundFareType,inboundFareType:n.inboundFareType,includeTransit:""+n.includeTransit=="false"?!1:!0,isRoundTrip:n.isRoundTrip,adultCount:n.adultCount||1,childCount:n.childCount||0,infantCount:n.infantCount||0,currencyCode:n.currencyCode||"NOK",agreementCode:n.campaignCode||null,agreementCodeFK:!n.campaignCode&&n.agreementCodeFK?n.agreementCodeFK:null,fasttrackSelection:n.fasttrackSelection||[],isSsrNeeded:n.isSsrNeeded,subsidyDefinitionId:typeof n.domesticSpainModel=="undefined"?null:n.domesticSpainModel.subsidyDefinitionId};return n.outboundRoute&&(i.routeIds=[n.outboundRoute.routeId],n.isRoundTrip&&n.inboundRoute&&i.routeIds.push(n.inboundRoute.routeId)),i},c=function(n){var i=t;_.assign(i,n);var u=moment(i.outboundDate),f=moment(i.inboundDate),r={D_Day:u.format("DD"),R_Day:f.format("DD"),D_Month:u.format("YYYYMM"),R_Month:f.format("YYYYMM"),AdultCount:i.adultCount||1,ChildCount:i.childCount||0,InfantCount:i.infantCount||0,IncludeTransit:""+i.includeTransit=="false"?!1:!0,TripType:i.isRoundTrip?2:1};return i.origin&&(r.D_City=i.origin),i.destination&&(r.A_City=i.destination),i.flightCodeOutbound&&(r.FC_O=i.flightCodeOutbound),i.flightCodeReturn&&(r.FC_R=i.flightCodeReturn),i.externalReference&&(r.E_Ref=i.externalReference),i.currencyCode&&(r.CurrencyCode=i.currencyCode),i.soldInLanguage&&(r.SoldInLanguage=i.soldInLanguage),i.currencyCode&&(r.CurrencyCode=i.currencyCode),i.dFare&&(r.dFare=i.dFare),i.rFare&&(r.rFare=i.rFare),i.campaignCode&&(r.AgreementCode=i.campaignCode),i.agreementCodeFK&&(r.AgreementCodeFK=i.agreementCodeFK),i.isSsrNeeded&&(r.IsSsrNeeded=i.isSsrNeeded),i.domesticSpainModel&&i.domesticSpainModel.subsidyDefinitionId&&(r.SubsidyDefinitionId=t.domesticSpainModel.subsidyDefinitionId),r},l=function(){n.userSelectionData&&(sessionStorage.removeItem("ngStorage-userSelectionData"),delete n.userSelectionData)},a=function(){delete t.inboundRoute;delete t.inboundFareType;delete t.outboundRoute;delete t.outboundFareType;delete t.isCancellationProtectionSelected;delete t.fasttrackSelection;t.paymentInfo={};t.ancillaries=[];t.selectedInboundSeats=[];t.selectedOutboundSeats=[]},v=function(n,u){t.inboundRoute=i(n,u);t.inboundFareType=u;r()},y=function(n,u){t.outboundRoute=i(n,u);t.outboundFareType=u;r()},u=function(n){t.inboundDate!=n.replace(/(\+.*$)/,"")&&(t.inboundDate=n,t.inboundRoute=null,t.inboundFareType="")},p=function(n){t.outboundDate!=n.replace(/(\+.*$)/,"")&&(t.outboundDate=n,t.outboundRoute=null,t.outboundFareType="",(!t.inboundDate||t.inboundDate<n)&&u(n))},w=function(n){return t.outboundRoute.routeId==n?t.outboundRoute:t.inboundRoute.routeId==n?t.inboundRoute:undefined},b=function(n){t.isUnregisteredBooking=n},k=function(n){t.isSsrNeeded=n};return{selection:t,setInboundRoute:v,setOutboundRoute:y,setInboundDate:u,setOutboundDate:p,getRoute:w,unregistered:b,init:s,reset:l,activateSsr:k,setSelectionFromStateParams:o,getStateParams:c,clearFareData:a,getAvailabilityRequest:h}}])}()