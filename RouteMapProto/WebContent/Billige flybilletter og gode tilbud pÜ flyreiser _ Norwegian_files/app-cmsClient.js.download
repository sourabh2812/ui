(function(){"use strict";var n=angular.module("nas",["ngResource","ngSanitize","ngStorage","ngAria","ngCookies","ngMessages","ui.bootstrap","pascalprecht.translate","nas.core","nas.bootstrap","nas.shared","nas.availability","nas.cartrawler","nas.holidays","nas.cmstemplates","nas.bootstraptemplates","nas.brand","nas.modals","nas.reward","smoothScroll","react"])})(),function(){"use strict";var n=angular.module("nas.core");n.factory("deviceSvc",function(){var i=parseInt((/WebKit\/([0-9]+)/.exec(navigator.appVersion)||0)[1],10)||void 0,r=navigator.userAgent.indexOf("TravelAssistant")!=-1,n=navigator.userAgent.indexOf("Android")!=-1,u=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,f=n&&i<=534&&navigator.vendor.indexOf("Google")>=0,t=navigator.userAgent.indexOf("Chrome")!=-1,e=navigator.userAgent.indexOf("Safari")!=-1&&!t;return{height:{md:function(){return Modernizr.mq("(min-height: 380px)")},lg:function(){return Modernizr.mq("(min-height: 668px)")},xl:function(){return Modernizr.mq("(min-height: 924px)")}},width:{md:function(){return Modernizr.mq("(min-width: 640px)")},lg:function(){return Modernizr.mq("(min-width: 1000px)")},xl:function(){return Modernizr.mq("(min-width: 1280px)")}},isTravelAssistant:r,isNativeAndroid:f,isAndroid:n,isIos:u,isChrome:t,isSafari:e}});n.provider("device",function(){this._device={};this.$get=["deviceSvc",function(n){var t=new Device(n);return t.setDevice(this._device),t}];this.setDevice=function(n){this._device=n}})}(),function(){"use strict";var n=angular.module("nas.core");n.constant("keyCodes",{TAB:9,ENTER:13,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32})}(),function(){"use strict";angular.module("nas.availability",[])}(),function(){"use strict";function n(n,t,i,r,u,f){function v(){e.destinationFocusValue=!0}function y(){e.destinationFocusValue=!1}function p(){l();s()}function l(n){if(n&&(e.model.originAirportList=n.destinations,e.model.airportRelations=n.relations),!e.model.userSelection.origin){e.model.destinationAirportList=[{displayName:e.model.selectDepartureFirstText}];return}var t=e.model.airportRelations[e.model.userSelection.origin];t||(t=e.model.airportRelations[e.model.userSelection.origin.toLowerCase()]);t.indexOf(e.model.userSelection.destination)===-1&&(e.model.userSelection.destination="");e.model.destinationAirportList=_.filter(e.model.originAirportList,function(n){return t.indexOf(n.code)!==-1})}function s(){i(function(){e.expandOptions=e.model.userSelection.origin&&e.model.userSelection.destination||e.isAllotmentSearch;e.expandOptions?i(function(){e.showOverflow=!0},600):e.showOverflow=!1})}function w(){e.model.userSelection.origin="";e.model.userSelection.destination="";i(function(){e.model.userSelection.outboundDate="";i(function(){e.model.userSelection.inboundDate=""});e.model.userSelection.adultCount=1;e.model.userSelection.childCount=0;e.model.userSelection.infantCount=0;e.toggleChild=!1;e.model.userSelection.tripType=e.tripTypes.twoWayReturn;e.model.userSelection.includeTransit=!0},200)}function a(){var n=new Date;return moment(new Date(n.getFullYear(),n.getMonth(),n.getDate())).format("YYYY-MM-DD")}function b(){e.model.resultType&&(e.model.userSelection.resultType=e.model.resultType);e.clearDestinationOnActivation&&(e.model.userSelection.destination=undefined);u.get({includeRelations:!0}).$promise.then(l);s();f.useLocationBasedSuggestions?u.suggestions().$promise.then(function(n){e.model.fromSuggestions=n.origins;e.model.toSuggestions=n.destinations}).catch(function(){e.model.fromSuggestions=e.model.fromSuggestionList;e.model.toSuggestions=e.model.toSuggestionList}):(e.model.fromSuggestions=e.model.fromSuggestionList,e.model.toSuggestions=e.model.toSuggestionList)}var e=this,o,h,c;e.model=e.model();e.accessibilityMode=!1;f.cookies.overrideDisplayModeCookie&&(o=r.get(f.cookies.overrideDisplayModeCookie.name),o&&o===f.cookies.overrideDisplayModeCookie.valueMobile&&(e.accessibilityMode=!0));e.useClientDate&&(e.model.userSelection.outboundDate=a(),e.model.userSelection.inboundDate=a());e.accessibilityMode&&(e.model.userSelection.outboundDate instanceof Date||(h=new Date(e.model.userSelection.outboundDate?e.model.userSelection.outboundDate:e.model.minDate),e.model.userSelection.outboundDate=h),e.model.userSelection.inboundDate instanceof Date||(c=new Date(e.model.userSelection.inboundDate?e.model.userSelection.inboundDate:e.model.minDate),e.model.userSelection.inboundDate=c));e.user={preferredAirport:"",selectedAirportName:""};e.originFocusValue=!1;e.destinationFocusValue=!1;e.toggleChild=e.model.userSelection.childCount>0||e.model.userSelection.infantCount>0;e.expandOptions=!1;e.showOverflow=!1;e.outboundMinDate=e.model.minDate;e.inboundMinDate=e.model.minDate;e.maxDate=e.model.maxDate;e.trustAsHtml=t.trustAsHtml;e.originAirportChange=p;e.destinationAirportChange=s;e.destinationSetFocus=v;e.destinationSetBlur=y;e.clear=w;e.tripTypes={oneWay:"OneWay",twoWayReturn:"TwoWayReturn"};e.resultTypes={fareCalendar:"FareCalendar",fareSelection:"AvaDay"};e.onSearchClick=function(){if(e.model&&e.model.userSelection&&(e.isAllotmentSearch||e.model.userSelection.origin&&e.model.userSelection.destination&&e.model.userSelection.outboundDate)){var n=angular.copy(e.model.userSelection);n.outboundDate=moment(e.model.userSelection.outboundDate).format("YYYY-MM-DD");n.inboundDate=moment(e.model.userSelection.inboundDate).format("YYYY-MM-DD");e.search(n,e.model.urlList)}};e.originSetFocus=function(){e.originFocusValue=!0};e.originSetBlur=function(){e.originFocusValue=!1};b()}var t=angular.module("nas.availability");t.directive("nasAvailabilitySearch",["$window","$timeout","$translate","stringutils","templateBase","dateAvailabilitySearchRes",function(t,i,r,u,f,e){return{priority:10,restrict:"A",templateUrl:f+"availability/availabilitysearch.tpl.html",replace:!1,scope:{model:"&",search:"=",clearDestinationOnActivation:"=?",useClientDate:"=",isGroupSearch:"@",isAllotmentSearch:"@"},link:{pre:function(n){function b(){return n.vm.model.userSelection.adultCount+n.vm.model.userSelection.childCount>9}function k(){return t.innerWidth>=640}function tt(){n.vm.isAnimationAllowed=k();angular.element(t).bind("resize",function(){return n.vm.isAnimationAllowed=k(),n.$apply()});f()}function f(){v&&i.cancel(v);v=i(function(){it()},100)}function it(){var t={origin:n.vm.model.userSelection.origin,destination:n.vm.model.userSelection.destination,outboundDate:l,inboundDate:a,isRoundTrip:n.vm.model.userSelection.tripType===n.vm.tripTypes.twoWayReturn,adultCount:n.vm.model.userSelection.adultCount,childCount:n.vm.model.userSelection.childCount},i;t.origin&&t.destination&&(n.vm.isUpdatingDatePicker=!0,i=angular.toJson(t),y[i]?(d(y[i]),n.vm.isUpdatingDatePicker=!1):e.get(t).$promise.then(function(t){d(t);n.vm.isUpdatingDatePicker=!1;y[i]=t},function(t){t.data&&(w=!0,n.messageList=t.data.messageList,n.messageListType="error",n.expandOptions=!1,n.canSearch=!1,n.vm.isUpdatingDatePicker=!1)}))}function d(t){g(t.outboundResult,h);g(t.inboundResult,c);n.vm.enableDateAvailabilitySearch=t.enableDateAvailabilitySearch;n.messageList=[];n.$broadcast("refreshDatepickers");n.vm.footerMessageOutbound=h.length===0?p:"";n.vm.footerMessageInbound=c.length===0?p:""}function g(n,t){t.length=0;n.forEach(function(n){var i=n.year+"-"+("0"+n.month).slice(-2)+"-"+("0"+n.day).slice(-2);t.push(moment(i).toDate())})}function nt(t,i,r){if(w||!n.vm.enableDateAvailabilitySearch||r==="month")return!1;if(t.length===0||i.getMonth()!==t[0].getMonth())return!0;var u=!0;return t.forEach(function(n){if(n.getDate()===i.getDate()&&n.getMonth()===i.getMonth()){u=!1;return}}),u}var s=function(t){n.vm.useDisplayLogicBasedOnStyle=!t.matches},h=[],c=[],l=moment(n.vm.model.userSelection.outboundDate).date(1).format("YYYY-MM-DD"),a=moment(n.vm.model.userSelection.inboundDate).date(1).format("YYYY-MM-DD"),p=r.instant("AvailabilityNoFlightsFound"),v,w=!1,y={},o;n.vm.isUpdatingDatePicker=!1;n.vm.enableDateAvailabilitySearch=!1;n.vm.outboundDisabled=function(n,t){return nt(h,n,t)};n.vm.inboundDisabled=function(n,t){return nt(c,n,t)};t.matchMedia?(o=t.matchMedia("(min-width: 640px)"),n.vm.useDisplayLogicBasedOnStyle=!o.matches,o.addListener(s),s(o),n.$on("$destroy",function(){o.removeListener(s)})):n.vm.useDisplayLogicBasedOnStyle=!0;tt();n.$on("dateViewSwitched",function(n,t){t.name==="availabilityOutboundDate"?t.date.getMonth()!==new Date(l).getMonth()&&(l=moment(t.date).date(1).format("YYYY-MM-DD"),f()):t.name==="availabilityInboundDate"&&t.date.getMonth()!==new Date(a).getMonth()&&(a=moment(t.date).date(1).format("YYYY-MM-DD"),f())});n.$watch("vm.model.userSelection.tripType",function(t,r){t!==r&&t===n.vm.tripTypes.twoWayReturn&&(n.vm.model.userSelection.inboundDate=n.vm.model.userSelection.outboundDate);angular.element(document.getElementById("returnDate")).addClass("animation__pop-in-from-top");i(function(){angular.element(document.getElementById("returnDate")).removeClass("animation__pop-in-from-top")},400);f()});n.vm.isGroupSearch||(n.$watch("vm.model.userSelection.adultCount",function(t){n.vm.model.userSelection.isGroupBooking=t&&b();n.vm.increaseAdultsText=u.format(r.instant("SearchBoxIncreaseAdultsLabel"),t+1);n.vm.decreaseAdultsText=u.format(r.instant("SearchBoxDecreaseAdultsLabel"),t-1)}),n.$watch("vm.model.userSelection.childCount",function(t){n.vm.model.userSelection.isGroupBooking=t&&b();n.vm.increaseChildsText=u.format(r.instant("SearchBoxIncreaseChildsLabel"),t+1);n.vm.decreaseChildsText=u.format(r.instant("SearchBoxDecreaseChildsLabel"),t-1)}),n.$watch("vm.model.userSelection.infantCount",function(t){n.vm.increaseInfantsText=u.format(r.instant("SearchBoxIncreaseInfantsLabel"),t+1);n.vm.decreaseInfantsText=u.format(r.instant("SearchBoxDecreaseInfantsLabel"),t-1)}));n.$watch("vm.model.userSelection.outboundDate",function(t){t&&(n.vm.inboundMinDate=typeof t=="string"?t:moment(t).format("YYYY-MM-DD"),!n.vm.accessibilityMode||t instanceof Date||(n.vm.model.userSelection.outboundDate=new Date(t)))});n.$watch("vm.model.userSelection.inboundDate",function(t){t&&(!n.vm.accessibilityMode||t instanceof Date||(n.vm.model.userSelection.inboundDate=new Date(t)))});n.$watch("vm.model.userSelection.origin",function(t){t&&n.vm.model.userSelection.destination&&f()});n.$watch("vm.model.userSelection.destination",function(t){t&&n.vm.model.userSelection.origin&&f()})}},controller:n,controllerAs:"vm",bindToController:!0}}]);n.$inject=["$window","$sce","$timeout","$cookies","destinationsRes","nasConfig"]}(),function(){"use strict";var n=angular.module("nas.availability");n.factory("dateAvailabilitySearchRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/booking/dateAvailabilitySearch",{},{get:{method:"GET",custom400handling:!0,custom500handling:!0,hideSpinner:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared",[]);n.run(["airportsSvc",function(){}])}(),function(){"use strict";angular.module("nas.cartrawler",[])}(),function(){"use strict";angular.module("nas.reward",[])}(),function(){"use strict";var n=angular.module("nas.availabilitysearch",["rx","ngResource","ngStorage","ngSanitize","ngLocale","ngAnimate","ngAria","ngCookies","ngAria","ngMessages","pascalprecht.translate","ui.bootstrap","ui.router","nas.bootstrap","nas.brand","nas.core","nas.cartrawler","nas.holidays","nas.shared","nas.experiment","nas.modals","nas.templates","nas.bootstraptemplates","smoothScroll","react"]);n.config(["$stateProvider","$urlRouterProvider","$cookiesProvider","templateBase","$ariaProvider",function(n,t,i,r,u){i.defaults.path="/";t.otherwise("/");u.config({tabindex:!1});n.state("fullSearch",{url:"/",templateUrl:r+"availabilitySearch/fullsearch.tpl.html",controller:"FullSearchCtrl",controllerAs:"vm",resolve:{destinations:["destinationsRes","$q",function(n,t){var i=t.defer();return n.get({includeRelations:!0}).$promise.then(function(n){i.resolve(n)}).catch(function(n){n.status===404&&i.resolve([]);i.reject(n)}),i.promise}],searchModel:["$q","availabilitySearchSvc","bootstrappedData",function(n,t,i){var r=n.defer();return t.init(i.pageModel).then(function(n){r.resolve(n)}),r.promise}]},data:{pageTitleKey:"DelayInfoByAirportBookThisFlight"}}).state("search",{url:"/search",templateUrl:r+"availabilitySearch/search.tpl.html",controller:"SearchCtrl",controllerAs:"vm",resolve:{destinations:["destinationsRes","$q",function(n,t){var i=t.defer();return n.get({includeRelations:!0}).$promise.then(function(n){i.resolve(n)}).catch(function(n){n.status===404&&i.resolve([]);i.reject(n)}),i.promise}],searchModel:["$q","availabilitySearchSvc","bootstrappedData",function(n,t,i){var r=n.defer();return t.init(i.pageModel).then(function(n){r.resolve(n)}),r.promise}]},data:{pageTitleKey:"DelayInfoByAirportBookThisFlight"}}).state("error",{params:{error:{}},url:"/error",templateUrl:r+"core/errorMessage.tpl.html",controller:["$scope","$stateParams",function(n,t){n.messageModel=t.error}],controllerAs:"vm"}).state("travelassistant",{}).state("travelassistant.done",{url:"/done"})}]);n.filter("origin",["userSelectionSvc",function(n){return function(t){var i=n.getRoute(t);if(i)return i.origin.displayName}}]);n.filter("destination",["userSelectionSvc",function(n){return function(t){var i=n.getRoute(t);if(i)return i.destination.displayName}}]);n.config(["$animateProvider",function(n){n.classNameFilter(/panel-collapse/)}])}(),function(){"use strict";angular.module("nas").controller("AccordionCtrl",["$scope",function(n){n.active=[];n.setActive=function(t){if(t){var i=n.active.indexOf(t);i>-1?n.active.splice(i,1):n.active.push(t)}};n.isActive=function(t){return n.active.indexOf(t)>-1?!0:!1}}])}(),function(){"use strict";angular.module("nas").controller("AirCargoTrackingBlockCtrl",["$scope","$window","$translate","stringutils",function(n,t,i,r){function u(n,t){return n.test(t)}function h(n){return u(o,n)}function c(n){return u(s,n)}function l(n,t){var i=parseInt(n),r=parseInt(t);return i<=0&&(i=f),r<=0&&(r=e),"height="+i+",width="+r}var f=600,e=500,o=new RegExp("^[0-9]{3}$"),s=new RegExp("^[0-9]{8}$");n.trackCargo=function(t,u,f){var e,o,s;return n.aircargotrackingform.$invalid?!1:(e=!0,o=[],h(n.inputPrefix)||(o.push(i.instant("CargoTracking_WrongAWBPrefix")),e=!1),c(n.input)||(o.push(i.instant("CargoTracking_WrongAWBNumber")),e=!1),!e)?(n.errors=o,!1):(s=r.format(t,n.inputPrefix,n.input),window.open(s,"_blank",l(u,f)),!0)}}])}(),function(){"use strict";angular.module("nas").controller("BusyBlockCtrl",["$scope","$interval","busyService",function(n,t,i){function r(){if(i.attemptsLeft()==0)n.isMaxAttemptsReached=!0;else if(n.secondsUntilRefresh==0){var t=i.getReturnUrl();t&&window.location.assign(t)}else n.secondsUntilRefresh=n.secondsUntilRefresh-1}n.secondsUntilRefresh=i.getTimer()/100;t(r,1e3)}])}(),function(){"use strict";var n=angular.module("nas");n.factory("epiFindSearchRes",["$resource",function(n){return n("/api/epifind",{},{get:{params:{method:"GET"},isArray:!0,custom400handling:!0,hideSpinner:!0}})}])}(),function(){"use strict";angular.module("nas").controller("EpiFindSearchBlockCtrl",["$attrs","$window","epiFindSearchRes",function(n,t,i){var r=this;r.data=[];r.input="";r.query=function(t){i.get({searchString:t,take:n.take}).$promise.then(function(n){r.data=_.map(n,function(n){return{displayName:n,code:n}})}).catch(function(n){scope.errors=n.data.messageList;scope.errorHeader=n.data.header})};r.submit=function(n,i,r,u){var f="";f=r?r:i.airportsearch.$viewValue;t.location.href=u+"?page=1&q="+f}}])}(),function(){"use strict";angular.module("nas").controller("NewsletterblockCtrl",["$scope","infoModal",function(n,t){function i(n,i){t.open(n,i)}n.submitPressed=!1;n.openModal=i;n.submit=function(t){n.submitPressed=!0;n.newslettersignupform.$invalid&&t.preventDefault()}}])}(),function(){"use strict";angular.module("nas").controller("QuickSearchBlockCtrl",["$scope","$window",function(n,t){n.submit=function(i,r){n.quicksearchform.input.$invalid&&i.preventDefault();var u=n.input;return u=u.replace("+","%2b"),u=u.replace("/","%2f"),t.location.href=r+"?qs="+u,!1}}])}(),function(){"use strict";angular.module("nas").controller("ResponsysNewsletterblockCtrl",["infoModal","nasConfig","stringutils","$translate",function(n,t,i,r){var u=this;u.submitPressed=!1;u.emailRegex=t.emailRegex;u.firstnameRequiredText=i.format(r.instant("FormFieldRequired"),r.instant("ProfileFirstnameLabel")).replace(/\"/g,"");u.lastnameRequiredText=i.format(r.instant("FormFieldRequired"),r.instant("ProfileLastnameLabel")).replace(/\"/g,"");u.travelagencyRequiredText=i.format(r.instant("FormFieldRequired"),r.instant("AgencyInfoSectionTitle")).replace(/\"/g,"");u.profileEmailTitle=r.instant("ProfileEmailTitle");u.agencyInfoSectionTitle=r.instant("AgencyInfoSectionTitle");u.newsletterSignupEmailmissing=r.instant("NewsletterSignupEmailmissing");u.newsletterSignupEmailInvalid=r.instant("NewsletterSignupEmailInvalid");u.submit=function(n,t){u.submitPressed=!0;t.$invalid&&n.preventDefault()};u.openModal=function(t,i){n.open(t,i.substring(0,1).toUpperCase()+i.substring(1))}}])}(),function(){"use strict";angular.module("nas").controller("SearchBoxBlockCtrl",["$scope","$attrs","$timeout","$window","userSelectionSvc","nasConfig","smoothScroll","deviceSvc","availabilitySearchSvc","$translate","rewardRes","cartrawlerSvc",function(n,t,i,r,u,f,e,o,s,h,c,l){function w(n){var t=document.getElementsByClassName("tab-box__tabs")[0],i=t.querySelectorAll(".tab-box__tabs__button");i[n-1].focus()}function b(n){for(var u=window.location.search.substring(1),r=u.split("&"),i,t=0;t<r.length;t++)if(i=r[t].split("="),decodeURIComponent(i[0])==n)return decodeURIComponent(i[1])}var p={"nb-NO":"NO","da-DK":"DK","sv-SE":"SE","fi-FI":"FI","en-UK":"EN","en-GB":"EN","es-ES":"ES"},v,a,y;n.searchModel=null;n.hotelSearchModel=null;n.initSearchModel=function(t){t&&s.init(t).then(function(t){n.searchModel=t})};n.initHotelSearchModel=function(t){t&&(n.hotelSearchModel=t)};v=function(n,t,i){t&&r._gaq&&r._gaq.push(["_trackEvent",n,t,i])};a="";n.search=function(t,i){v("SearchBox",a,t.resultType+" - "+t.origin+" - "+t.destination);n.$emit("loadingStatusActive");s.search(t,i)};n.groupSearch=function(t,i){t.isGroupSearch=!0;n.search(t,i)};n.allotmentSearch=function(t,i){t.isAllotmentSearch=!0;n.search(t,i)};n.carSearch=function(t,i){v("SearchBox",a,"https://cars.cartrawler.com/norwegian-new/");i.clientId="242532";n.$emit("loadingStatusActive");r.location=l.getCartrawlerUrl(t,i)};n.holidaySearch=function(t){var i,u;v("SearchBox",a,"https://www.norwegianholidays.com/travel/");n.$emit("loadingStatusActive");i="airport%3A"+t.destination;t.norwegianHolidayAreaType&&t.norwegianHolidayAreaType.length>0&&(i=t.norwegianHolidayAreaType+"%3A"+t.norwegianHolidayAreaId);u=t.holidaySearchOrigin?"&origin="+t.holidaySearchOrigin:"";r.location="https://www.norwegianholidays.com/travel/arc_waiting.cfm?nav="+(p[f.culture]||"EU")+"earn&air_room_car_radio="+t.searchType+"&area1=%7Cairport%3A"+t.origin+"&area2=%7C"+i+"&date1="+t.outboundDate+"&date2="+t.inboundDate+"&time1=0&time2=0&num_rooms="+t.roomCount+"&room_info="+t.roomInfo+u};n.setTab=function(t){n.tab=t;o.isTravelAssistant||o.width.lg()||i(function(){var n=document.getElementsByClassName("tab-box__tabs")[0];n&&e(n,{duration:400,offset:-(60*(t-1))})});w(t)};n.setSelectedBannerName=function(n){a=n};n.getHotelWidgetSloganList=function(){return n.hotelSearchModel.fromSloganList};n.rewardModel={joinConfirmed:!1};n.signUpUserAsFrequentFlyer=function(){n.rewardModel.joinConfirmed?(n.$emit("loadingStatusActive"),c.save().$promise.then(function(t){t.messageModel&&t.messageModel.hasMessage?n.$emit("errorMessageShow",t.messageModel):(n.$emit("loadingStatusActive"),r.location.href=r.location.href+"?tab=5")})["catch"](function(t){n.$emit("errorMessageShow",t)})):alert(h.instant("ErrorRewardSignupConfirmNotChecked"))};y=b("tab");y!=undefined&&y!=""?n.setTab(y):n.tab=1}])}(),function(){"use strict";angular.module("nas").directive("nasTabCollection",["$injector","$timeout",function(n,t){return{restrict:"EA",link:function(i,r){function e(n){var t=r[0].querySelectorAll(".tab-box__tabs")[0],i=t.querySelectorAll(".tab-box__tabs__button");i[n-1].focus()}var u=n.get("deviceSvc"),f=n.get("smoothScroll");i.setTab=function(n){i.tab=n;u.isTravelAssistant||u.width.lg()||t(function(){var t=r[0].querySelectorAll(".tab-box__tabs")[0];t&&f(t,{duration:400,offset:-(60*(n-1))})});e(n)};i.tab=1}}}])}(),function(){"use strict";var n=angular.module("nas");n.controller("ContactInfoController",["$attrs",function(n){var t=this;if(!n.model)throw new Error("No model for contactInfoController");t.model=angular.fromJson(n.model||{});t.regionChanged=function(){var n=_.find(t.model.regionList,function(n){return t.region===n.code});n?t.currentCountryList=n.countryList:(t.country=null,t.currentCountryList=null)}}])}(),function(){"use strict";angular.module("nas").controller("LoginblockCtrl",["stringutils","$translate",function(n,t){var i=this;i.submitted=!1;i.usernameRequiredText=n.format(t.instant("FormFieldRequired"),t.instant("ExtranetUsernameLabel")).replace(/\"/g,"");i.passwordRequiredText=n.format(t.instant("FormFieldRequired"),t.instant("ProfileEditPasswordLabel")).replace(/\"/g,"");i.submit=function(n,t){i.submitted=!0;t.$invalid&&n.preventDefault()}}])}(),function(){"use strict";var n=angular.module("nas");n.controller("LoginPageCtrl",["$scope","$window","sitemapSvc",function(n,t,i){function r(){var n={},t=window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,i,r){n[i]=r});return n}var u=r().returnHash;n.loginSuccess=function(n){var f="",e;r().state&&r().state==="myBooking"&&r().pnr&&(r().pnrLocal||r().pnrName)&&(f=i.get("pageUrlProfileMyReservation")+"?pnr="+r().pnr+"&pnrLocal="+r().pnrLocal+"&pnrName="+r().pnrName);n.forwardAction&&n.forwardAction!="Success"?t.location.href=n.forwardAction=="ForceChgPwd"?i.get("pageUrlRedirectTo")+"?redirectUrl="+i.get("pageUrlProfileMyNorwegianChangePwd")+"?userId="+n.username:n.forwardAction=="ForceUpdateProfile"?i.get("pageUrlRedirectTo")+"?redirectUrl="+i.get("pageUrlProfileEdit"):n.forwardAction=="SuccessNotNasProfile"?i.get("pageUrlRedirectTo")+"?redirectUrl="+i.get("pageUrlProfileActivate"):i.get("landingPageMyNorwegian"):f&&f!="undefined"?t.location.href=i.get("pageUrlRedirectTo")+"?redirectUrl="+encodeURIComponent(t.location.origin+f):u&&typeof u=="string"?(e=r().code,u=="updateUsername"?t.location.href=i.get("pageUrlRedirectTo")+"?redirectUrl="+t.location.origin+i.get("pageUrlProfileMyNorwegianChangeUsername")+"?code="+e:u=="updateEmail"?t.location.href=i.get("pageUrlRedirectTo")+"?redirectUrl="+t.location.origin+i.get("pageUrlProfileMyNorwegianChangeEmail")+"?code="+e:u.indexOf("profileloggedout")==-1&&(t.location.href=t.location.origin+i.get("landingPageMyNorwegian")+u)):t.location.href=i.get("landingPageMyNorwegian")}}])}(),function(){"use strict";var n=angular.module("nas");n.factory("lowfarecalendar",["$resource",function(n){return n("/api/lowfarecalendar",{},{get:{params:{method:"GET"},custom400handling:!0,hideSpinner:!0}})}])}(),function(){"use strict";var n=angular.module("nas");n.controller("lowfarecalendarblockController",["$scope","$attrs","$localStorage","$sce","$timeout","destinationsRes","lowfarecalendar","nasConfig",function(n,t,i,r,u,f,e,o){function l(){e.get(h,function(t){n.fares=t;n.fares.url=s.url+"?";t!=null&&t.dates&&t.dates.length!=0||(n.friendlyMessage.show=!0,n.friendlyMessage.header=c.noDataHeader,n.friendlyMessage.messageList=[c.noDataText],n.showLowFareCalendar=!1,n.isBusy=!1)},function(t){n.showLowFareCalendar=!1;n.friendlyMessage.show=!0;n.friendlyMessage.header=t.data.header;n.friendlyMessage.messageList=t.data.messageList;n.isBusy=!1;t.status===503&&u(function(){$rootScope.$broadcast("loadingStatusInactive");$rootScope.$broadcast("showBusyScreen",{repeatAction:function(){l()}})})})}var h,s,c;if(!t.model)throw new Error("No model for lowfarecalendarblockController");h={};s=angular.fromJson(t.model||{});h.destination=s.destination;h.currencyCode=s.currencyCode;h.outboundDateStart=s.outboundDateStart;h.numberOfMonthsToShow=s.numberOfMonthsToShow;c=angular.fromJson(t.translations||{});n.user={preferredAirport:s.origin,selectedAirportName:""};n.showLowFareCalendar=!1;n.showOriginsList=!1;n.airportList=[];n.friendlyMessage={show:!1};n.$storage=i;n.isBusy=!1;f.get(function(t){t.destinations&&(_.remove(t.destinations,function(n){return n.code==s.destination}),n.airportList=t.destinations,n.showOriginsList=!0)});s.allowOverrideOfUserPreferredAirportCode&&n.$storage.preferredOriginAirportCode&&n.$storage.preferredOriginAirportCode[o.culture]&&n.$storage.preferredOriginAirportCode[o.culture]!=s.destination&&(n.user.preferredAirport=n.$storage.preferredOriginAirportCode[o.culture]);n.loadingCallback=function(t){n.isBusy=t};n.$watch("user.preferredAirport",function(t,i){t&&(h.origin=t,(s.allowOverrideOfUserPreferredAirportCode||i!==t)&&(n.$storage.preferredOriginAirportCode||(n.$storage.preferredOriginAirportCode={}),(typeof n.$storage.preferredOriginAirportCode=="string"||n.$storage.preferredOriginAirportCode instanceof String)&&(n.$storage.preferredOriginAirportCode={}),n.$storage.preferredOriginAirportCode[o.culture]=t),n.showLowFareCalendar=!0,n.friendlyMessage.show=!1,n.fares={},l())})}])}(),function(){"use strict";angular.module("nas").controller("QuickBookingActionCtrl",["$window","$translate","sitemapSvc","quickBookingActionRes",function(n,t,i,r){var u=this;u.optionList=[{value:"landingPageBookingDetails",label:t.instant("ShortCutShowTravel")},{value:"landingPageSeatingSale",label:t.instant("ShortCutReserveSeat")},{value:"landingPageExcessLuggage",label:t.instant("ShortCutShowExcessLuggage")},{value:"landingPageAncillaryStart",label:t.instant("ShortCutSpecialBaggage")},{value:"pageUrlTravelDocTravelDocuments",label:t.instant("ShortCutGetTravelDoc")},{value:"pageUrlTravelReceiptPdf",label:t.instant("ShortCutGetTravelReceipt")}];u.selectedOption="landingPageBookingDetails";u.submit=function(t,f,e,o){if(f.$invalid)return!1;r.get({pnr:e}).$promise.then(function(t){var r=i.get(o);n.location.href=r+"?pnr="+e+"&pnrLocal="+t.pnrLocal})["catch"](function(n){u.errorHeader=n.data.header;u.errors=n.data.messageList})}}])}(),function(){"use strict";var n=angular.module("nas");n.factory("quickBookingActionRes",["$resource",function(n){return n("/api/businesslookup",{},{get:{method:"GET",custom400handling:!0}})}])}(),function(n){"use strict";(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();n.filter("price",function(){return function(n){return angular.isDefined(n)&&n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}})}(angular.module("nas")),function(){"use strict";var n=angular.module("nas");n.factory("traveltip",["$resource",function(n){return n("/api/traveltip",{},{get:{params:{method:"GET"}}})}])}(),function(){"use strict";var n=angular.module("nas");n.controller("traveltipblockController",["$rootScope","$scope","$attrs","$localStorage","$sce","traveltip","stringutils","urlHelper","destinationsRes","infoModal","nasConfig","$timeout","$translate","$cookies",function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){function it(n){var i,t;n&&et&&(i=document.querySelector("link[rel='canonical']"),i&&document.head.removeChild(i),t=document.createElement("link"),t.rel="canonical",t.href=n,document.head.appendChild(t))}function ot(n){history&&history.pushState(null,"",n)}function rt(n){if(n){var t=document.getElementsByTagName("title")[0];t.textContent=n}}function ut(n){v.put(c.cookies.preferredAirPortCookie.name,n);(!t.$storage.preferredOriginAirportCode||typeof t.$storage.preferredOriginAirportCode=="string"||t.$storage.preferredOriginAirportCode instanceof String)&&(t.$storage.preferredOriginAirportCode={});t.$storage.preferredOriginAirportCode[c.culture]=n}function g(n,t){if(n&&t){var i=n+t.currencyPresentation;return t.currencyPrefix&&(i=t.currencyPresentation+n),i}return n}function ft(){var n=document.getElementById("destinations");n.innerHTML="";l(function(){n.innerHTML=a.instant("TravelTipFlightResultsUpdated")},200)}function nt(){t.loading=!0;t.pristine=!1;var n=t.result.resultList;t.filters.budget<t.currentBudgetSlider.maxPrice&&(n=_.filter(n,function(n){for(var r,i=0;i<n.priceItemList.length;i++)if(r=n.priceItemList[i],r.fare>0&&r.fare<=t.filters.budget)return!0;return!1}));t.showResult=n.length>0;t.loading=!1;t.filteredResult=n;ft()}function w(){tt=!1;t.loading=!0;y.d_City=t.user.preferredAirport;t.filters.destinationGroup&&(y.destinationGroup=t.filters.destinationGroup.id);t.filters.currency&&(y.currencyCode=t.filters.currency.value);t.filters.includeTransit&&t.filters.includeTransit.value&&(y.includeTransit=t.filters.includeTransit.value);t.filters.splitDatesInto&&(y.splitDatesInto=t.filters.splitDatesInto);t.filters.yearmonth&&(t.lastRequest=angular.copy(y),y.d_Day="01",y.d_Day_End="31",y.d_Month=t.filters.yearmonth,y.d_Month_End=t.filters.yearmonth,t.filters.yearmonth=null);t.filters.agreementCode&&(y.agreementCode=t.filters.agreementCode);f.get(y,function(i){t.loading=!1;t.result=i;t.pristine=!1;i&&(it(i.canonicalUrl),ot(i.canonicalUrl),rt(i.title),y=i.requestParameters,t.showZoomOutButton=i.requestParameters.splitDatesInto==2,t.showDeeplink&&(t.deeplink=window.location.href.split("?")[0]+"?"+i.deepLinkQueryString));i!=null&&i.resultList&&i.resultList.length!=0?nt():(t.friendlyMessage.show=!0,t.friendlyMessage.header=k.noDataHeader,t.friendlyMessage.messageList=[k.noDataText],t.showResult=!1,ft());n.$broadcast("resetBusyScreenAttempts")},function(i){t.loading=!1;t.friendlyMessage.show=!0;t.friendlyMessage.header=i.data.header;t.friendlyMessage.messageList=i.data.messageList;i.status===503&&l(function(){n.$broadcast("loadingStatusInactive");n.$broadcast("showBusyScreen",{repeatAction:function(){w()}})})})}function st(n){var r,i,u;p.airportList=n.destinations;p.airportList&&p.airportList.length>0&&(t.$storage.preferredOriginAirportCode&&t.$storage.preferredOriginAirportCode[c.culture]&&p.allowOverrideOfUserPreferredAirportCode&&(i=t.$storage.preferredOriginAirportCode[c.culture],t.user.preferredAirport!==i&&(t.user.preferredAirport=i)),r=_.find(p.airportList,{code:t.user.preferredAirport}),r||(console.warn("Default selected airport is not in airportlist",t.user.preferredAirport),u=p.airportList[0],t.user.preferredAirport=u.code),p.allowOverrideOfUserPreferredAirportCode&&ut(t.user.preferredAirport),y.d_City!=t.user.preferredAirport&&(t.pristine=!1,w()))}function ht(){var r,i;s.get({includeRelations:!0,sortByCountryAndName:!0}).$promise.then(st);t.filters={transitOptions:p.transitOptionList,currencyOptions:p.currencyOptionList,destinationGroupList:p.destinationGroupList,agreementCode:p.agreementCode};t.filters.currencyOptions.length>0&&(r=_.find(t.filters.currencyOptions,{value:b.requestParameters.currencyCode}),r&&(t.filters.currency=r,t.currentBudgetSlider=p.budget.budgetSlider[r.value.toLowerCase()],p.budget.defaultBudget>0?(t.filters.budget=p.budget.defaultBudget,t.pristine=!1,nt()):t.filters.budget=t.currentBudgetSlider.maxPrice,t.budgetPresentation=g(t.filters.budget,t.currentBudgetSlider),t.maxPriceInfo=e.format(k.traveltipMaxPriceInfo,t.budgetPresentation)));t.filters.destinationGroupList.length>0&&(i=_.find(t.filters.destinationGroupList,function(n){return n.isSelected}),i||(i=_.find(t.filters.destinationGroupList,function(n){return n.id===b.requestParameters.destinationGroup})),t.filters.destinationGroup=i!=null?i:t.filters.destinationGroupList[0]);tt&&l(function(){n.$broadcast("loadingStatusInactive");n.$broadcast("showBusyScreen",{repeatAction:function(){w()}})},2e3)}function ct(n,t){h.open(n,t)}var d;if(!i.model)throw new Error("No model for traveltipblockController");var tt=i.isBusy.indexOf("True")!=-1,p=angular.fromJson(i.model||{}),b=angular.fromJson(i.result||{}),et=angular.fromJson(i.allowQueryParameters||!1),y=b.requestParameters,k=angular.fromJson(i.translations||{});it(b.canonicalUrl);rt(b.title);t.showDeeplink=!1;t.deeplink="";window.location.search.indexOf("showQuerystring=true")>-1&&(t.showDeeplink=!0);t.$storage=r;d=y.d_City;t.$storage.preferredOriginAirportCode&&t.$storage.preferredOriginAirportCode[c.culture]&&p.allowOverrideOfUserPreferredAirportCode&&(d=t.$storage.preferredOriginAirportCode[c.culture]);t.user={preferredAirport:d,selectedAirportName:""};t.showResult=!1;t.pristine=!0;t.result=b;t.filteredResult=[];t.model=p;t.loading=!1;t.trustAsHtml=u.trustAsHtml;t.displayAsteriks=i.displayasteriks==="True";t.showZoomOutButton=y.splitDatesInto==2;t.friendlyMessage={show:!1};t.zoomIn=function(n){t.filters.splitDatesInto=2;t.filters.yearmonth=n;w()};t.zoomOut=function(){t.lastRequest?y=t.lastRequest:y.d_Day_End="";t.filters.splitDatesInto=3;w()};t.displayNextInterval=function(){t.result.nextInterval&&(y=t.result.nextInterval,w())};t.displayPreviousInterval=function(){t.result.previousInterval&&(y=t.result.previousInterval,w())};t.runScript=function(gaScript){gaScript&&eval(gaScript)};t.getDestinationUrl=function(n,t){return!p.allowOverrideOfUserPreferredAirportCode&&t&&n.indexOf(t)<0?n.indexOf("?")>-1?n+"&"+t:n+"?"+t:n};t.$watch("user.preferredAirport",function(n,t){n&&t!==n&&(ut(n),w())});t.$watch("filters.includeTransit",function(n,t){t&&n&&t!=n&&w()});t.$watch("filters.budget",function(n,i){i!=n&&(nt(),t.budgetPresentation=g(n,t.currentBudgetSlider),t.maxPriceInfo=e.format(k.traveltipMaxPriceInfo,t.budgetPresentation))});t.$watch("filters.destinationGroup.id",function(n,t){t&&n&&t!==n&&w()});t.$watch("filters.currency.value",function(n,i){i&&n&&i!==n&&(w(),t.currentBudgetSlider=p.budget.budgetSlider[n.toLowerCase()],t.budgetPresentation=g(t.filters.budget,t.currentBudgetSlider),t.maxPriceInfo=e.format(k.traveltipMaxPriceInfo,t.budgetPresentation))});t.openModal=ct;ht()}])}(),function(){"use strict";angular.module("nas.holidays",["nas.availability"])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasKeyNavigation",["keyCodes",function(n){return{restrict:"EA",scope:{tabcallback:"&"},link:function(t,i){var u=i[0],r;u&&(r=u.querySelectorAll("a"),t.numberoftabs=r.length,angular.forEach(r,function(i){angular.element(i).on("keydown keypress",function(i){var u=i.target.attributes["data-tabnumber"],r;u&&u.value&&(r=parseInt(u.value,0),(i.which===n.LEFT||i.which===n.UP)&&(r=r>1?r-1:1,t.$apply(t.tabcallback({number:r}))),(i.which===n.RIGHT||i.which===n.DOWN)&&(r=r===t.numberoftabs?t.numberoftabs:r+1,t.$apply(t.tabcallback({number:r}))))})}))}}}])}(),function(){"use strict";var n=angular.module("nas.shared"),t=React.createClass({displayName:"nas-select",propTypes:{items:React.PropTypes.array.isRequired,displayProp:React.PropTypes.string,valueProp:React.PropTypes.string,emptyOption:React.PropTypes.string,label:React.PropTypes.string,id:React.PropTypes.string,ngModel:React.PropTypes.node,ngModelCtrl:React.PropTypes.object,props:React.PropTypes.object,onChange:React.PropTypes.func,disabled:React.PropTypes.bool},render:function(){function y(t){n.$setViewValue(t.target.value);e&&e(t.target.value)}function p(){n.clearServerErrors&&n.clearServerErrors()}var c=this.props.items,t=this.props.displayProp,i=this.props.valueProp,r=this.props.emptyOption,l=this.props.ngModel,u=this.props.label,f=this.props.id,e=this.props.onChange,n=this.props.ngModelCtrl,a=this.props.disabled,v=this.props.props,o=c.map(function(n,r){var u=i?n[i]:n;return React.DOM.option({key:r,value:u,selected:u==l},t?n[t]:n)}),s,h;return r&&o.unshift(React.DOM.option({value:"",key:"empty"},r)),s=Object.assign({key:"select",onChange:y,id:f,disabled:a,onBlur:p},v),h=React.DOM.select(s,o),React.DOM.div(null,[u?React.DOM.label({className:"select__label",key:"label",htmlFor:f},u):null,h])}});n.value("Options",t);n.directive("nasSelect",["reactDirective",function(n){function u(){var n=arguments[3],t=arguments[2].name;t&&(delete arguments[2].name,n.$$parentForm[t]=n,arguments[1].removeAttr("name"));arguments[2].ngModelCtrl=function(){return n};r.apply(i,arguments)}var i=n(t,null,{restrict:"A",require:"^ngModel"}),r=i.link;return i.link=u,i}])}(),function(){"use strict";function n(n,t,i,r){var u=this,f;u.emailRegex=r.emailRegex;u.errorHeader="";u.errors=[];u.profile=n.profile;u.profile.phonenumber=n.profile.phonenumberModel;u.countries=n.countries;f=_.map(u.countries,function(n){return{name:n.countryName+" ("+n.phonePrefix+")",value:n.phonePrefix+n.countryCode}});u.phonePrefixes=_.filter(f,function(n){return n.value});u.activate=function(){i.activateNonNasProfile(u.profile).$promise.then(function(){n.onSuccess()}).catch(function(n){u.errorHeader=n.data.header;u.errors=n.data.messageList})}}var t=angular.module("nas.shared");t.directive("nasActivateProfile",["templateBase",function(t){return{scope:{profile:"=",countries:"=",onSuccess:"="},restrict:"EA",templateUrl:t+"shared/components/activateProfile/activateProfile.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$scope","$translate","activateProfileRes","nasConfig"]}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("activateProfileRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/profile/activateprofile/:action",{},{nonNasProfile:{method:"GET",custom400handling:!1,params:{action:"nonNasProfile"}},activateNonNasProfile:{method:"POST",custom400handling:!0,params:{action:"activateNonNasProfile"}}})}])}(),function(){"use strict";function n(n,t,i,r){function f(n,t){i.open(n,t)}var u=this;u.infoUrlPrivacyStatement=r.get("infoUrlPrivacyPolicy");u.infoUrlTermsSmsUs=r.get("infoUrlTermsSmsUs");u.privacyStatementTitle=t.instant("FlightTrackerPrivacyStatementTitle");u.usSmsTermsOfServiceLink=t.instant("UsSmsTermsOfServiceLink");u.openModal=f}var t=angular.module("nas.shared");t.directive("nasAmericanPhoneTerms",["templateBase",function(t){return{restrict:"EA",templateUrl:t+"shared/components/americanTerms/americanPhoneTerms.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$scope","$translate","infoModal","sitemapSvc"]}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasAncillarySelection",["templateBase","$timeout",function(n){return{restrict:"EA",templateUrl:n+"shared/components/ancillarySelection/ancillarySelection.tpl.html",scope:{ancillaries:"=",groups:"=",travellerlist:"=",userselectedAncillarylist:"="},controller:["$translate","nasConfig",function(n,t){function u(){var n=_.filter(i.userselectedAncillarylist,{routeId:i.ancillaries.routeId}),t=i.groups.split(",");i.selected=_.filter(n,function(n){var i=!1;return _.forEach(t,function(t){n.ancillary.group===t&&(i=!0)}),i?n:void 0})}function f(n){return _.find(i.ancillaries.ancillaryAvailabilities,["priceCode",n])}var i=this,r;i.useReactSelectBoxes=t.useReactSelectBoxes;r=i.travellerlist?i.travellerlist:[];_.forEach(r,function(n){n.fullname=n.firstname+" "+n.lastname});i.travellers=r;i.selectedAncillary="";i.ancillaryQuota="";i.selectedTraveller=i.travellers.length==1?i.travellers[0].paxRef:"";i.selectedCount=0;i.itemsLabel=n.instant("Number");u();_.forEach(i.ancillaries.ancillaryAvailabilities,function(n){n.displayName=n.description+" ("+n.presentedFare+")"});i.ancillarySelected=function(){var c,n,r,u,e;if(i.selectedAncillary){var t=f(i.selectedAncillary),o=0,s=0,h=_.find(i.ancillaries.quotas,function(n){return!!i.selectedAncillary.match(new RegExp("^"+n.code))}),l=_.filter(i.userselectedAncillarylist,function(n){return n.routeId===i.ancillaries.routeId&&n.ancillary.priceCode.match(new RegExp("^"+i.selectedAncillary))});o=_(l).map(function(n){return n.quantity}).reduce(function(n,t){return n+t});c=_.filter(i.userselectedAncillarylist,function(n){return n.routeId===i.ancillaries.routeId&&n.ancillary.priceCode.match(new RegExp("^"+i.selectedAncillary))&&n.paxRef==i.selectedTraveller});s=_(c).map(function(n){return n.quantity}).reduce(function(n,t){return n+t});n=h?h.availableCount-(o||0):100;r=t.quotaPerPaxPerRoute;t.quotaPerPaxPerRouteList&&(u=_.find(t.quotaPerPaxPerRouteList,function(n){return n.paxRef==i.selectedTraveller}),u&&(r=u.availableCount));e=r-(s||0);e<n&&(n=e);i.ancillaryQuota=n>4?4:n;i.ancillaryQuota>0&&(i.selectedCount=1)}};i.add=function(){var n,t,r;i.selectedTraveller&&i.selectedAncillary&&i.selectedCount&&i.selectedCount!==0&&(n=_.find(i.travellers,["paxRef",parseInt(i.selectedTraveller,10)]),t=_.find(i.userselectedAncillarylist,function(t){return t.traveller===n&&t.routeId===i.ancillaries.routeId&&t.ancillary.priceCode===i.selectedAncillary}),t?t.quantity+=i.selectedCount:(r=f(i.selectedAncillary),i.userselectedAncillarylist.push({paxRef:n.paxRef,firstname:n.firstname,lastname:n.lastname,routeId:i.ancillaries.routeId,id:n.id,routeReference:i.ancillaries.routeReference,ancillary:_.pick(r,["fee","group","priceCode","description"]),quantity:i.selectedCount})),i.travellers.length>1&&(i.selectedTraveller=""),i.selectedAncillary="",i.ancillaryQuota="",i.selectedCount=0,u())};i.remove=function(n){var t=i.userselectedAncillarylist.indexOf(n);t>-1&&(i.userselectedAncillarylist.splice(t,1),u())}}],controllerAs:"vm",bindToController:!0}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("cabinBiddingRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/cabinbidding/:action",{},{get:{method:"GET",params:{action:"lookup"},custom400handling:!0,custom500handling:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.controller("CabinBiddingLookupCtrl",["$window","cabinBiddingRes","$translate",function(n,t,i){function u(i){r.errorHeader="";r.errors=[];r.showNotEligibleMessage=!1;t.get({pnr:i.pnr,pnrName:i.pnrName,touchPoint:"MarketingPage"}).$promise.then(function(t){if(t.isEligible){n.location=t.url;return}r.showNotEligibleMessage=!0}).catch(function(n){r.errors=n.data.messageList})}var r=this;r.errorHeader="";r.errors=[];r.search=u;r.showNotEligibleMessage=!1;r.notEligibleMessages=[i.instant("CabinBiddingCheckNotEligible")]}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasCabinBiddingLookup",["$translate","templateBase",function(n,t){return{restrict:"EA",scope:{title:"@",subtitle:"@",button:"@"},templateUrl:t+"shared/components/bidding/cabinBiddingLookup.tpl.html",controller:"CabinBiddingLookupCtrl",controllerAs:"vm"}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("busyConfigRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/busy/config")}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("busyConfigSvc",["$q","$sessionStorage","busyConfigRes",function(n,t,i){function f(n){t.busyConfig=n}var r=t.busyConfig,u=n.defer();return r?u.resolve(r):(r={waitTime:15,maxAttempts:3},f(r),i.get().$promise.then(function(n){r=n;f(r);u.resolve(r)})),{config:u.promise}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasBusyWait",["$translate","$timeout","$window","templateBase","busyConfigSvc",function(n,t,i,r,u){return{restrict:"EA",scope:{refreshClick:"@"},templateUrl:r+"templates/busy-wait.core.tpl.html",controller:["$scope",function(n){function l(n){f=n.waitTime;e=n.maxAttempts;r=!0}function a(){n.attemptsCounter++;n.showBusyScreen=!0}function s(){n.showBusyScreen=!1}function h(){n.repeatAction&&n.repeatAction()}function v(){n.attemptsCounter=0}function c(){n.timeLeft=f;a();t(i,o)}var r,f,e,o=1e3,i;n.attemptsCounter=0;n.showRefresh=!1;n.$watch("attemptsCounter",function(t){n.showRefresh=t>e?!0:!1});n.$on("showBusyScreen",function(t,i){(t.preventDefault(),n.showBusyScreen)||(n.repeatAction=i.repeatAction,r?c():u.config.then(function(n){l(n);c()}))});n.$on("resetBusyScreenAttempts",function(n){n.preventDefault();v()});n.refreshClick=function(){s();h()};i=function(){if(n.timeLeft===0){s();h();return}n.showRefresh||(n.timeLeft--,t(i,o))}}]}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasContinuebutton",["$translate",function(n){return{restrict:"A",template:'<button type="{{buttontype}}" data-ng-click="oncontinue()" class="button {{ cssclassatr }} button--primary" data-ng-disabled="!isenabled">{{ text }}<\/button>',replace:!0,scope:{oncontinue:"&",text:"=?",textKey:"@",isenabled:"=",cssclass:"@",cssclassatr:"=?",causesValidation:"=?"},link:function(t){t.textKey&&n(t.textKey).then(function(n){t.text=n});t.cssclassatr=t.cssclass?t.cssclass:"button--block";var i=t.causesValidation===undefined;i||(i=t.causesValidation==!0);t.buttontype=i?"submit":"button"}}}]);n.directive("nasBackbutton",["$translate",function(n){return{restrict:"A",template:'<button data-ng-click="ongoback()" class="button {{ cssclassatr }} button--primary" data-ng-disabled="!isenabled">{{ text }}<\/button>',replace:!0,scope:{ongoback:"&",text:"=?",textKey:"@",isenabled:"=",cssclass:"@",cssclassatr:"=?"},link:function(t){t.textKey&&n(t.textKey).then(function(n){t.text=n.replace("&lt;","<")});t.cssclassatr=t.cssclass?t.cssclass:"button--block"}}}]);n.directive("nasCancelbutton",["$translate",function(n){return{restrict:"A",template:'<button data-ng-click="oncancel()" class="button {{ cssclassatr }} button--primary" data-ng-disabled="!isenabled">{{ text }}<\/button>',replace:!0,scope:{oncancel:"&",text:"=?",textKey:"@",isenabled:"=",cssclass:"@",cssclassatr:"=?"},link:function(t){t.textKey&&n(t.textKey).then(function(n){t.text=n});t.cssclassatr=t.cssclass?t.cssclass:"button--block"}}}]);n.directive("nasRouteSelectButton",["templateBase","$translate",function(n,t){return{restrict:"A",templateUrl:n+"shared/components/buttons/routeselectbutton.tpl.html",replace:!0,scope:{fareModel:"=",routeId:"=",currencyCode:"=",selectedFare:"="},link:function(n){n.$watch("selectedFare",function(){n.fareModel&&(n.isSelected=n.selectedFare==n.routeId+n.fareModel.type)});n.seatsAvailableLabel=t.instant("AvailableSeats")}}}]);n.directive("nasCheckboxbutton",["deviceSvc","$timeout","templateBase",function(n,t,i){return{restrict:"A",templateUrl:i+"shared/components/buttons/checkboxbutton.tpl.html",transclude:!0,scope:{required:"=?",disabled:"=?",negate:"=?",click:"&?",ngModel:"="},require:"ngModel",link:function(i,r,u,f){function e(){i.disabled||(i.disabled=!1);typeof i.ngModel=="string"&&(i.ngModel=i.ngModel=="true"?!0:!1);i.model=i.ngModel;i.negate===!0&&(i.model=!i.model);(n.isSafari||n.isTravelAssistant||n.isNativeAndroid)&&r.find(".btn-cb .check").removeClass("check").addClass("check-alt")}i.elementId=_.uniqueId("cb_");u.id&&(i.elementId=u.id,r.removeAttr("name"));i.cbLabelId="label_"+i.elementId;e();i.$watch("ngModel",function(){e()});r.on("change",function(){i.disabled||t(function(){i.$apply(function(){f.$setViewValue(i.negate===!0?!i.model:i.model);f.$setTouched(!0);i.click&&t(function(){i.click()})})},100)})}}}]);n.directive("nasRadiobutton",["$timeout","templateBase","keyCodes",function(n,t,i){return{restrict:"A",templateUrl:t+"shared/components/buttons/radiobutton.tpl.html",scope:{model:"=",options:"=",optionLabels:"=?",click:"=?",isreadonly:"=?",useLinebreak:"=?"},compile:function(){return{post:function(t,r){function f(n,t){if(event.target.nodeName==="BUTTON"){var i=Array.prototype.slice.call(r[0].querySelectorAll("button")),f=i.indexOf(event.target),u=f+t;u<i.length&&u>=0?(i[u].focus(),i[u].click()):u>=i.length?(i[0].focus(),i[0].click()):u<0&&(i[i.length-1].focus(),i[i.length-1].click())}}function u(){t.options&&(t.optionList=_.map(t.options,function(n,i){return n===undefined?{}:typeof n=="string"?{value:n,label:t.optionLabels&&t.optionLabels[i]||n}:{value:n.value,label:t.optionLabels&&t.optionLabels[i]||n.label||n.name||n.value}}))}r.attr("tabindex",-1);t.radiogroup=_.uniqueId("radio_");r.on("keydown keypress",function(n){n.which===i.RIGHT||n.which===i.DOWN?f(n.target,1):n.which===i.LEFT||n.which===i.UP?f(n.target,-1):n.which===i.SPACE&&n.target.nodeName==="BUTTON"&&n.target.click()});var e=t.$watch("optionLabels",function(){t.optionLabels&&(e(),u())});t.$watch("options",function(){t.options&&u()});u();t.onClick=function(i){t.isreadonly||(t.model=i,t.click&&n(function(){t.click({selected:i})}))};n(function(){var n=Array.prototype.slice.call(r[0].querySelectorAll("button"));n.length>0&&(_.some(n,function(n){return n.tabIndex>=0})||(n[0].tabIndex=0))})}}}}}])}(),function(){"use strict";function n(n,t,i,r,u){function o(){i.all(e).then(function(n){f.scheduleChangeNoteBodyP2=r.format(n[0],n[1])}).catch(function(n){console.log("Missing translation "+n)})}var e=[t("ScheduleChangeNoteBodyP2"),t("ApplicationSupportPhone")],f=this;f.show=!1;n.alterationinfo()&&(f.show=n.alterationinfo().showCancellationInfoAndOptionsBox,f.linklist=n.alterationinfo().linklist,f.hasAcceptedScheduleChange=u.isPnrAccepted(n.alterationinfo().pnr));o()}var t=angular.module("nas.shared");t.directive("nasCancellationOptionsBox",["templateBase",function(t){return{restrict:"EA",scope:{alterationinfo:"&"},templateUrl:t+"shared/components/cancellation/cancellationInfoAndOptionsBox.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$scope","$translate","$q","stringutils","scheduleChangeSvc"]}(),function(){"use strict";function n(n,t){var i=this;i.show=!1;n.alterationinfo()&&(i.show=n.alterationinfo().showScheduleChangeAcceptBox,i.linklist=n.alterationinfo().linklist,i.hasAcceptedScheduleChange=t.isPnrAccepted(n.alterationinfo().pnr))}var t=angular.module("nas.shared");t.directive("nasSchedulechangeAcceptBox",["templateBase",function(t){return{restrict:"EA",scope:{alterationinfo:"&"},templateUrl:t+"shared/components/cancellation/scheduleChangeAcceptBox.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$scope","scheduleChangeSvc"]}(),function(){"use strict";function n(n){var t=this,i;t.model=n.ngModel;t.model.carList.length===0&&t.model.noAvailabilityUrl&&t.model.noAvailabilityUrl.text&&(t.model.carTrawler="CarTrawler",i=t.model.noAvailabilityUrl.text,t.model.noAvailPreText=i.substring(0,i.indexOf("CarTrawler")),t.model.noAvailPostText=i.substring(i.indexOf("CarTrawler")+t.model.carTrawler.length))}angular.module("nas.shared").directive("nasCartrawlerCrossSale",["templateBase",function(t){return{restrice:"EA",replace:!0,require:"^ngModel",scope:{ngModel:"="},templateUrl:t+"shared/components/cartrawler/cartrawlerCrossSale.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$scope"]}(),function(){"use strict";angular.module("nas.shared").directive("nasCitypair",["templateBase",function(n){return{restrict:"A",replace:!0,scope:{origin:"=",destination:"="},templateUrl:n+"shared/components/citypair/citypair.tpl.html"}}])}(),function(){"use strict";function n(n,t,i,r,u){var f=this,e;f.errors&&(e=f.errors.subscribe(function(n){f.phonenumberForm.number.$setValidity("server",!1);f.phonenumberForm.number.$error.server=typeof f.phonenumberForm.number.$error.server=="boolean"?n:f.phonenumberForm.number.$error.server.concat(n)}));n.$on("$destroy",function(){e&&e.dispose()});f.phonePrefixAndCountry=u.getPrefixAndCountry(f.phoneNumber.prefix,f.phoneNumber.countryCode,f.phonePrefixes);f.cssClasses=f.cssClasses||{row:"row",col1:"col-6--md",col2:"col-6--md"};n.$watch("vm.phonePrefixAndCountry",function(){f.phonePrefixAndCountry?(f.phoneNumber.prefix=f.phonePrefixAndCountry.slice(0,f.phonePrefixAndCountry.length-2),f.phoneNumber.countryCode=f.phonePrefixAndCountry.slice(f.phonePrefixAndCountry.length-2,f.phonePrefixAndCountry.length)):(f.phoneNumber.prefix="",f.phoneNumber.countryCode="")});f.countryRequiredText=r.format(t.instant("FormFieldRequired"),t.instant("Country")).replace(/\"/g,"");f.phoneRequiredText=r.format(t.instant("FormFieldRequired"),f.label).replace(/\"/g,"");f.phoneInvalidText=r.format(t.instant("FormFieldInvalid"),f.label).replace(/\"/g,"");f.phoneShortText=r.format(t.instant("FormFieldShort"),f.label,"5").replace(/\"/g,"");f.phoneLongText=r.format(t.instant("FormFieldLong"),f.label,"25").replace(/\"/g,"")}angular.module("nas.shared").directive("nasPhonenumber",["templateBase","formValidation",function(t,i){return{restrict:"EA",templateUrl:t+"shared/components/contactinfo/phonenumber.tpl.html",scope:{phoneNumber:"=",phonePrefixes:"=",errors:"=",label:"=",isNumberRequired:"=",hideRequiredLabel:"=",cssClasses:"="},require:"^^form",link:function(n,t,r,u){var f=i.findFormElement(t[0]);n.vm.topForm=i.findTopLevelForm(u);f&&n.$on(f.name+":submit",function(){n.vm.phonenumberForm.number.$setValidity("server",!0)});n.focused=!1;n.focus=function(){n.focused=!0};n.blur=function(){n.focused=!1}},controller:n,controllerAs:"vm",bindToController:!0}}]);n.$inject=["$scope","$translate","$q","stringutils","phoneNumberSvc","nasConfig"]}(),function(){"use strict";function n(n,t,i,r,u,f,e){function v(n,t,i){return u.getFlightDelay({flightCode:n,date:t,direction:i}).$promise}function y(n,t,i){return u.get({direction:i,airportCode:n,selectedOffsetDay:t}).$promise}function p(t,i,r,u){n.all([y(t,i,r)]).then(function(n){o.delayInfoList=n[0].resultList;b(n[0].resultAirportList,u);l("airport",n[0].direction)})}function w(i,r,u){n.all([v(i,r,u)]).then(function(n){o.delayInfoList=n[0].resultList;l("flight",n[0].direction)}).catch(function(n){var i=n.data;t.$broadcast("flight_search_controller_exception",i)})}function l(n,t){n==="flight"?(a(!0,!0,!0,!0),o.directionText=t&&t==="Arrival"?h:s):(k(t),t&&t==="Arrival"?a(!0,!1,!1,!0):a(!1,!0,!0,!1))}function a(n,t,i,r){var u=5;n&&u++;t&&u++;i&&u++;r&&u++;o.showFromAirportColumn=n;o.showToAirportColumn=t;o.showDepartureTimeColumn=i;o.showArrivalTimeColumn=r;o.flightStatusColspan=u}function b(n,i){o.resultAirportList=n;i?o.resultFilter.preferredAirport=i:o.resultFilter={};t.$broadcast("setResultAirports",{resultAirports:o.resultAirportList,preferredAirport:i})}function k(n){o.searchBoxModel.fromText=n&&n==="Arrival"?s.toLowerCase():h.toLowerCase();o.searchBoxModel.toText=n&&n==="Arrival"?h.toLowerCase():s.toLowerCase();o.directionText=n&&n==="Arrival"?h:s;t.$broadcast("setDirectionText",{direction:n})}function d(){f.get().$promise.then(function(n){o.phonePrefixes=e.getPhonePrefixes(n.countries)})}var o=this,s=r.instant("DelayInfoArrivalTo"),h=r.instant("DelayInfoDepartureFrom"),c;o.departureFromText=h;o.arrivalToText=s;o.flightStatusColspan=7;o.departureHeaderText=r.instant("FlightTrackerDeparture");o.arrivalHeaderText=r.instant("FlightTrackerArrival");o.gateHeaderText=r.instant("DelayInfoHeaderGate");o.statusHeaderText=r.instant("DelayInfoByAirportStatus");o.delayInfoList=angular.fromJson(i.resultModel||{});o.searchBoxModel=angular.fromJson(i.searchModel||{});o.resultAirportList=angular.fromJson(i.resultAirportModel||{});o.simpleSuggestLanguage=angular.fromJson(i.simpleSuggestLanguage||{});o.filter={selectedAirportName:o.searchBoxModel.preferredAirport,direction:{value:o.searchBoxModel.defaultDirection},offsetDay:{value:o.searchBoxModel.defaultOffsetDay},airportCode:""};o.defaultResultAirport={code:"",cityName:"",displayName:r.instant("FlightStatusAllAirportSelect"),countryName:"",airportName:"",cityCode:""};o.resultFilter={};l("Airport",o.searchBoxModel.defaultDirection);t.$on("tabFocus",function(){o.delayInfoList=angular.fromJson(i.resultModel||{});o.defaultResultAirport={code:"",cityName:"",displayName:r.instant("FlightStatusAllAirportSelect"),countryName:"",airportName:"",cityCode:""}});t.$on("searchForFlight",function(n,t){w(t.flightcode,t.date,t.direction)});t.$on("searchForAirport",function(n,t){p(t.airportcode,t.offsetDay,t.direction,t.resultAirportCode)});c=t.defaultResultAirport;t.$on("resultAirportChanged",function(n,t){t.airport&&t.airport!==c?o.resultFilter.preferredAirport=t.airport:o.resultFilter={preferredAirport:"",selectedAirportName:r.instant("FlightStatusAllAirportSelect"),direction:"",offsetDay:"",airportCode:""};c=o.resultFilter.preferredAirport});t.$on("resetSearchResult",function(){o.delayInfoList=angular.fromJson(i.resultModel||{})});d()}var t=angular.module("nas.shared");t.directive("nasDelayInfo",["templateBase",function(t){return{scope:{searchModel:"&",resultModel:"&",resultAirportModel:"&",simpleSuggestLanguage:"&"},replace:!0,restrict:"EA",templateUrl:t+"shared/components/flightStatus/delayInfo.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$q","$scope","$attrs","$translate","delayInfoRes","countriesRes","phoneNumberSvc"]}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("delayInfoRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/delayInfo/:action",{},{get:{method:"GET",params:{action:"airport"}},getFlightDelay:{method:"GET",params:{action:"flight"},custom400handling:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasDelayInfoAirportSearch",["templateBase",function(n){return{restrict:"EA",scope:{filter:"=",resultFilter:"=",language:"=",searchBoxModel:"=",resultAirportList:"="},templateUrl:n+"shared/components/flightStatus/delayInfoAirportSearch.tpl.html",controller:["$scope","$translate",function(n,t){function e(n){i.fromText=n&&n==="Arrival"?r.toLowerCase():u.toLowerCase();i.toText=n&&n==="Arrival"?u.toLowerCase():r.toLowerCase()}function f(){i.filter.preferredAirport?n.$emit("searchForAirport",{airportcode:i.filter.preferredAirport,offsetDay:i.filter.offsetDay.value,direction:i.filter.direction.value,resultAirportCode:i.resultFilter.preferredAirport}):(i.resultFilter.preferredAirport=null,n.$emit("resetSearchResult"))}var i=this,r,u;i.airportList=n.searchBoxModel.airportList;i.filter=n.filter;i.resultFilter=n.resultFilter;i.preferredAirport=n.searchBoxModel.preferredAirport;i.language=n.language;i.chooseAirportLabel=n.searchBoxModel.chooseAirportLabel;i.directionList=n.searchBoxModel.directionList;i.offsetDayList=n.searchBoxModel.offsetDayList;i.searchText=n.searchBoxModel.searchText;i.fromText=n.searchBoxModel.fromText;i.toText=n.searchBoxModel.toText;i.resultAirportsPlaceholder=[t.instant("FlightStatusAllAirportSelect")];i.filter.preferredAirport=n.searchBoxModel.preferredAirport;i.resultAirportList=n.resultAirportList;r=t.instant("DelayInfoArrivalTo");u=t.instant("DelayInfoDepartureFrom");n.$on("setResultAirports",function(n,t){i.resultAirportList=t.resultAirports;i.resultFilter.preferredAirport=t.preferredAirport});n.$on("setDirectionText",function(n,t){e(t.direction)});i.airportChanged=function(){f()};i.resultAirportChanged=function(){n.$emit("resultAirportChanged",{airport:i.resultFilter.preferredAirport})};i.offsetDayChanged=function(){f()};i.directionChanged=function(){e(i.filter.direction.value);f()}}],controllerAs:"vmAirport"}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasDelayInfoFlightSearch",["templateBase",function(n){return{restrict:"EA",scope:{dateList:"="},templateUrl:n+"shared/components/flightStatus/delayInfoFlightSearch.tpl.html",controller:["$scope","$translate",function(n,t){var i=this;i.dateList=n.dateList;i.selectedDate=i.dateList[0];_.each(i.dateList,function(n){n.selected&&(i.selectedDate=n)});i.destionationTypeLabel=t.instant("FlightTrackerDeparture");i.arrivalTypeLabel=t.instant("FlightTrackerArrival");i.searchTypes={departure:"Departure",arrival:"Arrival"};i.searchType=i.searchTypes.departure;i.search=function(){n.$emit("searchForFlight",{flightcode:i.flightcode,date:i.selectedDate.value,direction:i.searchType})};n.$on("flight_search_controller_exception",function(t,i){n.$broadcast("errorMessageShow",i)})}],controllerAs:"vmFlight"}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasDelayInfoTabCollection",["templateBase","$injector","$timeout",function(n,t,i){return{restrict:"EA",scope:{filter:"=",resultFilter:"=",language:"=",searchBoxModel:"=",resultAirportList:"="},link:function(n,r){function e(t){var i=r[0].querySelectorAll(".tab-box__tabs")[0],u=i.querySelectorAll(".tab-box__tabs__button");u[t-1].focus();n.$emit("tabFocus",t)}var u=t.get("deviceSvc"),f=t.get("smoothScroll");n.setTab=function(t){n.tab=t;u.isTravelAssistant||u.width.lg()||i(function(){var n=r[0].querySelectorAll(".tab-box__tabs")[0];n&&f(n,{duration:400,offset:-(60*(t-1))})});e(t)};n.tab=1},templateUrl:n+"shared/components/flightStatus/delayInfoTabCollection.tpl.html"}}])}(),function(){"use strict";function n(n,t,i,r,u,f,e){function s(){return u.get({originAirport:t.originairport(),destinationAirport:t.destinationairport(),flightCode:t.flightcode(),localDepartureTime:t.localdeparturetimeticks(),offset:t.offset().value}).$promise}function h(){n.all([s()]).then(function(n){o.flightTrackerItem=n[0].resultModel;o.newInfoListList=_.filter(n[0].smsHistoryList,function(n){return n.type!=="Welcome_Subscribers"&&n.type!=="AirPort_Subscribers"});o.smsHistoryList=_.filter(n[0].smsHistoryList,function(n){return n.type==="Welcome_Subscribers"||n.type==="AirPort_Subscribers"});o.getFlightTrackerItemFailed=!1}).catch(function(){o.getFlightTrackerItemFailed=!0;o.errors=[i.instant("FlightTrackerGetItemFailed")]})}function c(n,t){e.open(n,t)}function l(){u.save({originAirport:o.flightTrackerItem.originAirportIataCode,destinationAirport:o.flightTrackerItem.destinationAirportIataCode,flightCode:o.flightTrackerItem.flightCode,localDepartureTime:o.flightTrackerItem.localDepartureDateTimeTicks,countryPrefix:o.phoneNumber.prefix,number:o.phoneNumber.number,smsSignUp:!0}).$promise.then(function(){o.signupSuccess=!0;o.signupFailed=!1}).catch(function(){o.signupSuccess=!1;o.signupFailed=!0})}var o=this;o.phonePrefixes=t.phoneprefixes;o.phoneNumber={prefix:"",number:""};o.trustAsHtml=r.trustAsHtml;o.countryRequiredText=f.format(i.instant("FormFieldRequired"),i.instant("Country")).replace(/\"/g,"");o.mobileRequiredText=f.format(i.instant("FormFieldRequired"),i.instant("PhoneTypeMobile")).replace(/\"/g,"");o.mobileInvalidText=f.format(i.instant("FormFieldInvalid"),i.instant("PhoneTypeMobile")).replace(/\"/g,"");o.mobileShortText=f.format(i.instant("FormFieldShort"),i.instant("PhoneTypeMobile"),"5").replace(/\"/g,"");o.mobileLongText=f.format(i.instant("FormFieldLong"),i.instant("PhoneTypeMobile"),"25").replace(/\"/g,"");h();o.openModal=c;o.save=l}var t=angular.module("nas.shared");t.directive("nasFlightTracker",["templateBase",function(t){return{scope:{originairport:"&",destinationairport:"&",flightcode:"&",localdeparturetimeticks:"&",offset:"&",phoneprefixes:"=",index:"="},replace:!0,restrict:"EA",templateUrl:t+"shared/components/flightStatus/flightTracker.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$q","$scope","$translate","$sce","flightTrackerRes","stringutils","infoModal"]}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("flightTrackerRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/flightTracker",{},{save:{method:"POST",custom400handling:!0,hideSpinner:!0},get:{method:"GET",custom400handling:!0,hideSpinner:!0}})}])}(),function(){"use strict";angular.module("nas.shared").directive("nasHeader",["templateBase",function(n){return{restrict:"A",replace:!0,scope:{title:"=?",titleKey:"@",subtitle:"=?",subtitleKey:"@",breadcrumbTitle:"=?",breadcrumbTitleKey:"@",breadcrumbState:"=",breadcrumbUrl:"=",breadcrumbAction:"=",showProgressState:"="},templateUrl:n+"shared/components/header/header.tpl.html",controller:["$scope","$translate","$state","deviceSvc",function(n,t,i,r){function u(i,r){t(i).then(function(t){n[r]=n[r]||t})}n.isTravelAssistant=r.isTravelAssistant;n.state=i.current.name;n.titleKey&&u(n.titleKey,"title");n.subtitleKey&&u(n.subtitleKey,"subtitle");n.breadcrumbTitleKey&&u(n.breadcrumbTitleKey,"breadcrumbTitle");u("Previous","backLabel")}]}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.controller("HotelCtrl",["$scope","$q","$translate","$cookies","destinationsRes","nasConfig",function(n,t,i,r,u,f){function o(){if(e.request.origin&&e.request.outboundDate&&e.request.departureDate&&e.destinationList){e.destination=_.filter(e.destinationList,function(n){return n.code==e.request.origin?!0:!1});var t=moment(e.request.outboundDate),r=t.format("YYYY-MM"),u=t.format("DD"),i=moment(e.request.departureDate),o=i.format("YYYY-MM"),s=i.format("DD");e.link="http://www.booking.com/searchresults.html?aid=342370&label=nwgn-traveldet-search&iata="+e.destination[0].code+"&iata_orr=1&checkin_monthday="+u+"&checkin_year_month="+r+"&checkout_monthday="+s+"&checkout_year_month="+o+"&ifl=0&selected_currency="+n.soldInCurrency+"&si=ai,ci,re&do_availability_check=on&lang="+f.culture.slice(3)}else e.link=""}function l(){var n=t.defer();return u.get({includeRelations:!0}).$promise.then(function(t){n.resolve(t)}),n.promise}var e=this,s,h,c;e.accessibilityMode=!1;f.cookies.overrideDisplayModeCookie&&(s=r.get(f.cookies.overrideDisplayModeCookie.name),s&&s===f.cookies.overrideDisplayModeCookie.valueMobile&&(e.accessibilityMode=!0));h=moment(n.arrivaltime);c=moment(n.arrivaltime).add(1,"days");n.departuretime&&(c=moment(n.departuretime));e.request={origin:n.suggestion,outboundDate:h,departureDate:c};e.searchLabel=i.instant("HotelsWereToStay");e.noMatchText=i.instant("NoMatches");e.checkInLabel=i.instant("HotelsCheckIn");e.checkOutLabel=i.instant("HotelsCheckOut");e.today=new Date;e.minDate=h;n.$watch("vm.request.origin",function(){o()});n.$watch("vm.request.outboundDate",function(){e.minDate=e.request.outboundDate;o()});n.$watch("vm.request.departureDate",function(){o()});o();t.all([l()]).then(function(n){e.destinationList=_.filter(n[0].destinations,function(n){return n.code.length>3&&n.code.indexOf("ALL")>-1?!1:n.code});o()})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasHotel",["templateBase",function(n){return{restrict:"EA",scope:{suggestion:"=",arrivaltime:"=",departuretime:"=",soldInCurrency:"="},templateUrl:n+"shared/components/hotel/hotel.tpl.html",controller:"HotelCtrl",controllerAs:"vm"}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.controller("HotelNewVendorCtrl",["$scope","$q","$window","$translate","$cookies","destinationsRes","nasConfig","hotelNewVendorRes","hotelSearchNewVendorRes",function(n,t,i,r,u,f,e,o,s){function d(){h.request.destination="";h.request.destinationId="";c()}function g(){v=!1;c()}function nt(n){h.suggestions=n.suggestions||[];c()}function tt(){b=l.destination;h.suggestions=[{code:l.destinationId,destinationId:l.destinationId,displayName:l.destination}];h.request.destinationId=h.suggestions[0].destinationId;h.request.destination=h.suggestions[0].displayName}function it(n){v=!0;s.suggestions({searchText:n}).$promise.then(nt).catch(function(){})}function rt(){return b!==h.request.destination}function ut(){return rt()||a(l.outboundDate)!==h.request.outboundDate||a(l.departureDate)!==h.request.departureDate}function c(){h.canSearch=(h.request.destination||h.request.destinationId)&&h.request.outboundDate&&h.request.departureDate&&h.request.departureDate>=h.request.outboundDate}function ft(n){h.errors=[n]}function et(){h.errors=null}function ot(){if(et(),h.canSearch){if(!ut()){window.location=h.model.deeplink;return}moment(h.request.departureDate).diff(moment(h.request.outboundDate),"days")>28&&(h.request.departureDate=a(moment(h.request.outboundDate).add(28,"days")));var n=a(moment(h.request.outboundDate)),t=a(moment(h.request.departureDate)),i={checkInDate:n,checkOutDate:t,destination:v?h.request.destination:null,destinationId:v?null:h.request.destinationId,rooms:null,flight:h.model.flight,trafficSource:y.trafficSource,trafficSourceCategory:y.trafficSourceCategory};o.deeplink(i).$promise.then(function(n){window.location=n.url}).catch(function(){ft(h.model.errorDeeplinkGenerationFailed)})}}function a(n){return n.format("YYYY-MM-DD")}var v,b,h=this,y,p;h.model=n.model;y={trafficSource:h.model.trafficSource,trafficSourceCategory:h.model.trafficSourceCategory};h.accessibilityMode=!1;e.cookies.overrideDisplayModeCookie&&(p=u.get(e.cookies.overrideDisplayModeCookie.name),p&&p===e.cookies.overrideDisplayModeCookie.valueMobile&&(h.accessibilityMode=!0));var w=moment(h.model.checkInDate),k=moment(h.model.checkOutDate),l={destination:h.model.destination,destinationId:h.model.destinationId,outboundDate:angular.copy(w),departureDate:angular.copy(k)};h.request={destination:h.model.destination,outboundDate:w,departureDate:k};h.getSuggestions=it;h.airportChange=g;h.search=ot;h.today=new Date;h.minDate=w;n.$watch("vm.request.destination",function(){c()});n.$watch("vm.request.destinationId",function(n){n===""&&d();c()});n.$watch("vm.request.outboundDate",function(){h.minDate=h.request.outboundDate;c()});n.$watch("vm.request.departureDate",function(){c()});tt()}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasHotelNewVendor",["templateBase",function(n){return{restrict:"EA",scope:{model:"="},templateUrl:n+"shared/components/hotel/hotel.new.vendor.tpl.html",controller:"HotelNewVendorCtrl",controllerAs:"vm"}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("hotelNewVendorRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/hotelsearchnewvendor/:action",{},{deeplink:{method:"POST",params:{action:"deeplink"},custom400handling:!0,custom500handling:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasHotelSearch",["$window","$cookies","$sce","nasConfig","templateBase","stringutils","hotelSearchRes",function(n,t,i,r,u,f,e){return{restrict:"A",templateUrl:u+"shared/components/hotel/hotelSearch.tpl.html",replace:!1,scope:{fallbackContent:"@",label:"=",model:"="},controller:["$scope",function(u){function v(n){o.bookHotelModel.suggestions=n.suggestions||[];l()}function l(){var n=h?c:s;o.canSearch=n&&o.bookHotelModel.checkinDate}function y(){u.$on("dateViewSwitched",function(n,t){t.name==="checkinDate"?t.date.getMonth()!==new Date(o.bookHotelModel.checkinDate).getMonth()&&(o.bookHotelModel.checkinDate=moment(t.date).date(1).format("YYYY-MM-DD")):t.name==="checkinDate"&&t.date.getMonth()!==new Date(o.bookHotelModel.checkoutDate).getMonth()&&(o.bookHotelModel.checkoutDate=moment(t.date).date(1).format("YYYY-MM-DD"))});u.$watch("vm.bookHotelModel.checkinDate",function(n){n&&(o.bookHotelConfig.checkoutMinDate=typeof n=="string"?n:moment(n).format("YYYY-MM-DD"),!o.accessibilityMode||n instanceof Date||(o.bookHotelModel.checkinDate=new Date(n)))});u.$watch("vm.bookHotelModel.checkoutDate",function(n){n&&(!o.accessibilityMode||n instanceof Date||(bookHotelModel.checkoutDate.checkoutDate=new Date(n)))});u.$watch("vm.bookHotelModel.childrenCount",function(n,t){var i,r;if(n===0)o.bookHotelModel.ages=[];else if(i=n-t,i<0)o.bookHotelModel.ages.splice(n,Math.abs(i));else for(r=0;r<i;r++)o.bookHotelModel.ages.push(0)});u.$watch("vm.bookHotelModel.destinationCode",function(n){s=n===""?null:_.find(o.bookHotelModel.suggestions,function(t){return t.code===n})})}function a(){if(o.hotelSearchEnabled||(o.trustedFallbackContent=i.trustAsHtml(o.fallbackContent)),o.initializationModel){if(o.accessibilityMode=!1,r.cookies.overrideDisplayModeCookie){var n=t.get(r.cookies.overrideDisplayModeCookie.name);n&&n===r.cookies.overrideDisplayModeCookie.valueMobile&&(o.accessibilityMode=!0)}o.bookHotelConfig={vendorUrl:o.initializationModel.config.vendorUrl,label:f.format(o.initializationModel.config.labelFormat,o.label),languageCode:o.initializationModel.config.languageCode,maxDate:o.initializationModel.config.maxDate,checkinMinDate:o.initializationModel.config.minDate,checkoutMinDate:o.initializationModel.config.minDate,selectedCurrency:o.initializationModel.config.bookHotelCurrency||"",aid:o.initializationModel.config.bookHotelAid,childrenMinAge:o.initializationModel.config.childrenMinAge,childrenMaxAge:o.initializationModel.config.childrenMaxAge,roomMinCount:o.initializationModel.config.roomMinCount,roomMaxCount:o.initializationModel.config.roomMaxCount,adultMinCount:o.initializationModel.config.adultMinCount,adultMaxCount:o.initializationModel.config.adultMaxCount,childrenMinCount:o.initializationModel.config.childrenMinCount,childrenMaxCount:o.initializationModel.config.childrenMaxCount,labelBookHotelAdults:o.initializationModel.config.labelBookHotelAdults,labelBookHotelCheckInDate:o.initializationModel.config.labelBookHotelCheckInDate,labelBookHotelCheckOutDate:o.initializationModel.config.labelBookHotelCheckOutDate,labelBookHotelChildren:o.initializationModel.config.labelBookHotelChildren,labelBookHotelDestination:o.initializationModel.config.labelBookHotelDestination,labelBookHotelAges:o.initializationModel.config.labelBookHotelAges,labelBookHotelRooms:o.initializationModel.config.labelBookHotelRooms,noMatchText:o.initializationModel.config.noMatchText,lastSeparatorText:o.initializationModel.config.lastSeparatorText,fromSloganList:o.model.fromSloganList,doAvailabilityCheck:1};o.bookHotelModel={checkinDate:moment(o.initializationModel.checkinDate),checkoutDate:moment(o.initializationModel.checkoutDate),roomCount:o.initializationModel.roomCount,adultCount:o.initializationModel.adultCount,childrenCount:o.initializationModel.childrenCount,ages:[]};o.airportChange=p;o.getSuggestions=b;o.canSearch=!1;l()}}function p(){h=!1;l()}function w(){if(o.hotelSearchEnabled=!1,o.bookHotelConfig={},o.bookHotelModel={checkinDate:moment(new Date),checkoutDate:moment(new Date).add(1,"days")},o.initializationModel){a(o.initializationModel);return}e.initialize().$promise.then(function(n){o.hotelSearchEnabled=n.hotelSearchEnabled;o.initializationModel=n.initializationModel;y();a()}).catch(function(){o.hotelSearchEnabled=!1})}function b(n){c=n;h=!0;e.suggestions({searchText:n}).$promise.then(v).catch(function(){})}var o=this,c,h,s;w();o.search=function(){var t=o.bookHotelConfig.vendorUrl+"?aid="+o.bookHotelConfig.aid+"&do_availability_check=1&lang="+o.bookHotelConfig.languageCode+"&selected_currency="+o.bookHotelConfig.selectedCurrency+"&label="+o.bookHotelConfig.label+"&checkin_monthday="+moment(o.bookHotelModel.checkinDate).format("DD")+"&checkin_year_month="+moment(o.bookHotelModel.checkinDate).format("YYYY-MM")+"&checkout_monthday="+moment(o.bookHotelModel.checkoutDate).format("DD")+"&checkout_year_month="+moment(o.bookHotelModel.checkoutDate).format("YYYY-MM")+"&no_rooms="+o.bookHotelModel.roomCount+"&group_adults="+o.bookHotelModel.adultCount+"&group_children="+o.bookHotelModel.childrenCount;t+=h?"&ss="+c:"&dest_id="+s.destinationId+"&dest_type="+s.destinationType;_.each(o.bookHotelModel.ages,function(n){t+="&age="+n});n.open(t,"_blank")}}],controllerAs:"vm",bindToController:!0}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasHotelSearchNewVendor",["$window","$cookies","$sce","nasConfig","templateBase","stringutils","hotelSearchNewVendorRes",function(n,t,i,r,u,f,e){return{restrict:"A",templateUrl:u+"shared/components/hotel/hotelSearch.new.vendor.tpl.html",replace:!1,scope:{fallbackContent:"@",touchpointId:"=",sloganList:"="},link:{pre:function(t){var r=function(n){t.vm.useDisplayLogicBasedOnStyle=!n.matches},i;n.matchMedia?(i=n.matchMedia("(min-width: 640px)"),t.vm.useDisplayLogicBasedOnStyle=!i.matches,i.addListener(r),r(i),t.$on("$destroy",function(){i.removeListener(r)})):t.vm.useDisplayLogicBasedOnStyle=!0}},controller:["$scope","$timeout",function(n,u){function p(n){f.bookHotelModel.suggestions=n.suggestions||[];c()}function l(){return o?h:s}function c(){f.canSearch=l()&&f.bookHotelModel.checkinDate}function w(){n.$on("dateViewSwitched",function(n,t){t.name==="checkinDate"?t.date.getMonth()!==new Date(f.bookHotelModel.checkinDate).getMonth()&&(f.bookHotelModel.checkinDate=moment(t.date).date(1)):t.name==="checkinDate"&&t.date.getMonth()!==new Date(f.bookHotelModel.checkoutDate).getMonth()&&(f.bookHotelModel.checkoutDate=moment(t.date).date(1))});n.$watch("vm.bookHotelModel.checkinDate",function(n){n&&(f.bookHotelConfig.checkoutMinDate=typeof n=="string"?n:moment(n),!f.accessibilityMode||n instanceof Date||(f.bookHotelModel.checkinDate=new Date(n)))});n.$watch("vm.bookHotelModel.checkoutDate",function(n){n&&(!f.accessibilityMode||n instanceof Date||(bookHotelModel.checkoutDate.checkoutDate=new Date(n)))});n.$watch("vm.bookHotelModel.rooms",function(){_.forEach(f.bookHotelModel.rooms,function(n){n.childrenAges.length>n.childrenCount?n.childrenAges.pop():n.childrenAges.length<n.childrenCount&&(n.childrenAges.length=n.childrenCount)})},!0);n.$watch("vm.bookHotelModel.roomCount",function(n){n>f.bookHotelModel.rooms.length?f.bookHotelModel.rooms.push({adultCount:2,childrenCount:0,childrenAges:[]}):f.bookHotelModel.rooms.length=n||0});n.$watch("vm.bookHotelModel.destinationCode",function(n){n===""?(s=null,y()):s=_.find(f.bookHotelModel.suggestions,function(t){return t.code===n})})}function a(){u(function(){f.expandOptions=l();f.expandOptions?u(function(){f.showOverflow=!0},600):f.showOverflow=!1})}function v(){if(f.hotelSearchEnabled||(f.trustedFallbackContent=i.trustAsHtml(f.fallbackContent)),f.initializationModel){if(f.accessibilityMode=!1,r.cookies.overrideDisplayModeCookie){var n=t.get(r.cookies.overrideDisplayModeCookie.name);n&&n===r.cookies.overrideDisplayModeCookie.valueMobile&&(f.accessibilityMode=!0)}f.bookHotelConfig={pos:f.initializationModel.config.pos,locale:f.initializationModel.config.locale,cid:f.initializationModel.config.cid,trafficSource:f.initializationModel.config.trafficSource,trafficSourceCategory:f.touchpointId,maxDate:f.initializationModel.config.maxDate,checkinMinDate:f.initializationModel.config.minDate,checkoutMinDate:f.initializationModel.config.minDate,childrenMinAge:f.initializationModel.config.childrenMinAge,childrenMaxAge:f.initializationModel.config.childrenMaxAge,roomMinCount:f.initializationModel.config.roomMinCount,roomMaxCount:f.initializationModel.config.roomMaxCount,adultMinCount:f.initializationModel.config.adultMinCount,adultMaxCount:f.initializationModel.config.adultMaxCount,childrenMinCount:f.initializationModel.config.childrenMinCount,childrenMaxCount:f.initializationModel.config.childrenMaxCount,labelBookHotelAdults:f.initializationModel.config.labelBookHotelAdults,labelBookHotelCheckInDate:f.initializationModel.config.labelBookHotelCheckInDate,labelBookHotelCheckOutDate:f.initializationModel.config.labelBookHotelCheckOutDate,labelBookHotelChildren:f.initializationModel.config.labelBookHotelChildren,labelBookHotelDestination:f.initializationModel.config.labelBookHotelDestination,labelBookHotelChildAge:f.initializationModel.config.labelBookHotelChildAge,labelBookHotelRooms:f.initializationModel.config.labelBookHotelRooms,labelBookHotelRoomNumber:f.initializationModel.config.labelBookHotelRoomNumber,errorDeeplinkGenerationFailed:f.initializationModel.config.errorDeeplinkGenerationFailed,noMatchText:f.initializationModel.config.noMatchText,lastSeparatorText:f.initializationModel.config.lastSeparatorText,sloganList:f.sloganList};f.bookHotelModel={checkinDate:moment(f.initializationModel.checkinDate),checkoutDate:moment(f.initializationModel.checkoutDate),rooms:[]};f.airportChange=b;f.getSuggestions=d;f.canSearch=!1;c()}}function b(){o=!1;a();c()}function k(){if(f.hotelSearchEnabled=!1,f.bookHotelConfig={},f.bookHotelModel={checkinDate:moment(new Date),checkoutDate:moment(new Date).add(1,"days")},a(),f.initializationModel){v(f.initializationModel);return}e.initialize().$promise.then(function(n){f.hotelSearchEnabled=n.hotelSearchEnabled;f.initializationModel=n.initializationModel;w();v()}).catch(function(){f.hotelSearchEnabled=!1})}function d(n){h=n;o=!0;e.suggestions({searchText:n}).$promise.then(p).catch(function(){})}function g(n){return n.format("YYYY-MM-DD")}function nt(n){f.errors=[n]}function tt(){f.errors=null}function y(){f.bookHotelModel.destinationCode="";u(function(){f.bookHotelModel.checkinDate=moment(f.initializationModel.checkinDate);u(function(){f.bookHotelModel.checkoutDate=moment(f.initializationModel.checkoutDate)});f.bookHotelModel.roomCount=1},200)}var f=this,h,o,s;f.expandOptions=!1;f.showOverflow=!1;f.clear=y;k();f.search=function(){if(f.canSearch){tt();moment(f.bookHotelModel.checkoutDate).diff(moment(f.bookHotelModel.checkinDate),"days")>28&&(f.bookHotelModel.checkoutDate=g(moment(moment(f.bookHotelModel.checkinDate).add(28,"days"))));var n={checkInDate:f.bookHotelModel.checkinDate,checkOutDate:f.bookHotelModel.checkoutDate,destination:o?h:null,destinationId:o?null:s.code,rooms:f.bookHotelModel.rooms,trafficSource:f.bookHotelConfig.trafficSource,trafficSourceCategory:f.bookHotelConfig.trafficSourceCategory};e.deeplink(n).$promise.then(function(n){window.location=n.url}).catch(function(){nt(f.bookHotelConfig.errorDeeplinkGenerationFailed)})}}}],controllerAs:"vm",bindToController:!0}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("hotelSearchNewVendorRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/hotelsearchnewvendor/:action",{},{suggestions:{method:"GET",params:{action:"suggestions"},custom400handling:!0,custom500handling:!0},deeplink:{method:"POST",params:{action:"deeplink"},custom400handling:!0,custom500handling:!0},initialize:{method:"GET",params:{action:"initialize"},custom400handling:!0,custom500handling:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("hotelSearchRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/hotelsearch/:action",{},{suggestions:{method:"GET",params:{action:"suggestions"},custom400handling:!0,custom500handling:!0},initialize:{method:"GET",params:{action:"initialize"},custom400handling:!0,custom500handling:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.controller("ApisBoxCtrl",["$translate","$q","$scope","stringutils","sitemapSvc",function(n,t,i,r,u){var f=this;f.apisLinkUrl=u.get("pageUrlResUtilAddIdentification")+"?"+i.information.parameters;f.showApis=i.information.showApisInfo;f.paxApisSatisfiedCount=i.information.paxApisSatisfiedCount;f.paxCount=i.information.paxCount;f.infoText=i.information.infoText}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasApisBox",["templateBase",function(n){return{restrict:"EA",scope:{information:"="},templateUrl:n+"shared/components/identification/apisBox.tpl.html",controller:"ApisBoxCtrl",controllerAs:"vm"}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.controller("EstaBoxCtrl",["$translate","$q","$scope","stringutils","infoModal","sitemapSvc",function(n,t,i,r,u,f){function s(){t.all(o).then(function(n){e.infoText=r.format(n[0],i.information.destinationCountry)}).catch(function(n){console.log("Missing translation "+n)})}function h(){u.open(f.get("infoUrlEstaInformation"),"ESTAHeaderText")}var o=[n("RegisterESTAInformationBoxPart1")],e=this;e.showEsta=i.information.showEstaInfo;e.showModal=h;e.externalUrlESTADeepLink=f.get("externalUrlESTADeepLink");s()}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasEstaBox",["templateBase",function(n){return{restrict:"EA",scope:{information:"="},templateUrl:n+"shared/components/identification/estaBox.tpl.html",controller:"EstaBoxCtrl",controllerAs:"vm"}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasEstaInfo",["templateBase",function(n){return{restrict:"A",templateUrl:n+"shared/components/identification/estaInfo.tpl.html",scope:{model:"="},link:function(){}}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasPassportInfo",["$state","deviceSvc","templateBase",function(n,t,i){return{restrict:"A",templateUrl:i+"shared/components/identification/passportInfo.tpl.html",scope:{model:"="},link:function(n){n.isTravelAssistant=t.isTravelAssistant}}}])}(),function(){"use strict";angular.module("nas.shared").directive("nasInfoBox",["$timeout","smoothScroll","templateBase","deviceSvc",function(n,t,i,r){return{restrict:"A",replace:!0,scope:{items:"=?",header:"=",type:"=",showBox:"=?",showIcon:"=?",showList:"=?",showDismissIcon:"=?",action:"=?",actionLabel:"=?",timestamp:"=?",details:"=?",disableFocus:"=?"},templateUrl:i+"shared/components/infoBox/infoBox.tpl.html",link:function(i,u){i.showIcon=i.showIcon==undefined?!0:i.showIcon;i.showBox=i.showBox==undefined?!0:i.showBox;i.showDismissIcon=i.showDismissIcon==undefined?!0:i.showDismissIcon;i.expandDetails=!1;i.dismiss=function(){i.items=[]};i.showDetails=function(){i.expandDetails=!i.expandDetails};i.disableFocus||i.$watch("items",function(f){f&&f.length>0&&(i.enableAnimation=!r.height.lg(),n(function(){i.enableAnimation&&t(angular.element(u)[0],{offset:20});var n=angular.element(u)[0];n&&n.focus()},1e3))})}}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasLinkList",["$translate","templateBase",function(n,t){return{restrict:"A",templateUrl:t+"shared/components/linklist/linklist.tpl.html",replace:!0,scope:{list:"=",isBulleted:"="}}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("loginRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/login",{},{save:{method:"POST",custom400handling:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasLoginBox",["templateBase",function(n){return{restrict:"EA",scope:{onSuccess:"=",isPrimary:"=",hideRegister:"=",forgotpasswordState:"="},templateUrl:n+"shared/components/login/loginBox.tpl.html",controller:["$translate","$scope","stringutils","infoModal","loginRes","sitemapSvc",function(n,t,i,r,u,f){function o(n){n.$invalid||n.$pristine||(e.errorHeader="",e.errors=[],u.save(e.credentials).$promise.then(t.onSuccess).catch(function(n){n.data&&(e.errors=n.data.messageList,e.errorHeader=n.data.header);e.credentials.password="";t.loginBoxForm.password.$setPristine();t.loginBoxForm.password.$touched=!1}))}var e=this;e.login=o;e.credentials={};e.errorHeader="";e.errors=[];e.isPrimary=t.isPrimary;e.hideRegister=t.hideRegister;e.registerUrl=f.get("pageUrlProfileCreate");e.forgotUserNameUrl=f.get("infoUrlProfileForgotUserName");e.forgotPasswordUrl=f.get("pageUrlProfileForgotPwd");e.usernameRequiredText=i.format(n.instant("FormFieldRequired"),n.instant("ProfileEmailLabel")).replace(/\"/g,"");e.passwordRequiredText=i.format(n.instant("FormFieldRequired"),n.instant("ProfileEditPasswordLabel")).replace(/\"/g,"");e.forgotpasswordState=t.forgotpasswordState;e.showModal=function(){r.open(e.forgotUserNameUrl)}}],controllerAs:"vm"}}])}(),function(){"use strict";function n(n,t,i,r){function o(t){t.$invalid||t.$pristine||n.onSearch&&n.onSearch()(u.reservation)}var u=this,f,e;u.errorHeader=n.errorHeader;u.errors=n.errors;u.search=o;u.refrenceRequiredText=i.format(t.instant("FormFieldRequired"),t.instant("MyNorwegianBookingReference")).replace(/\"/g,"");u.lastnameRequiredText=i.format(t.instant("FormFieldRequired"),t.instant("ProfileLastName")).replace(/\"/g,"");f=r.getQuerystringParameter("pnr");e=r.getQuerystringParameter("pnrName");u.reservation={};f&&(u.reservation.pnr=f);e&&(u.reservation.pnrName=e)}var t=angular.module("nas.shared");t.directive("nasLookup",["$translate","templateBase",function(t,i){return{restrict:"EA",scope:{title:"@",subtitle:"@",button:"@",titleKey:"@",subtitleKey:"@",buttonKey:"@",buttonModifier:"=",onSearch:"&?",errors:"=",errorHeader:"=",showTravelReceiptCheckbox:"="},templateUrl:i+"shared/components/lookup/lookup.tpl.html",controller:n,controllerAs:"vm",link:function(n){function i(i,r){t(i).then(function(t){n[r]=n[r]||t})}n.titleKey&&i(n.titleKey,"title");n.subtitleKey&&i(n.subtitleKey,"subtitle");n.buttonKey&&i(n.buttonKey,"button")}}}]);n.$inject=["$scope","$translate","stringutils","urlHelper"]}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("lookupRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/mynorwegian/lookup",{},{get:{method:"GET",custom400handling:!0}})}])}(),function(){"use strict";function n(n,t,i){function u(n){t.get(n).$promise.then(function(){i.onSuccessLookup({pnr:n.pnr,pnrName:n.pnrName})}).catch(function(n){r.errors=n.data.messageList;r.errorHeader=n.data.header})}var r=this;r.errorHeader="";r.errors=[];r.search=u}var t=angular.module("nas.shared");t.directive("nasPreProcessLookup",["$translate","templateBase",function(t,i){return{restrict:"EA",scope:{titleKey:"@",title:"@",onSuccessLookup:"="},templateUrl:i+"shared/components/lookup/preProcessLookup.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$window","lookupRes","$scope"]}(),function(){"use strict";function n(n,t,i){function u(u){t.get(u).$promise.then(function(t){n.location=u.includeCanceled?i.get("pageUrlTravelReceiptPdf")+"?pnr="+u.pnr+"&pnrLocal="+t.pnrLocal:i.get("landingPageBookingDetails")+"?pnr="+u.pnr+"&pnrName="+u.pnrName})["catch"](function(n){r.errors=n.data.messageList;r.errorHeader=n.data.header})}var r=this;r.errorHeader="";r.errors=[];r.search=u}var t=angular.module("nas.shared");t.directive("nasReservationLookup",["$translate","templateBase",function(t,i){return{restrict:"EA",scope:{titleKey:"@",title:"@"},templateUrl:i+"shared/components/lookup/reservationLookup.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$window","lookupRes","sitemapSvc"]}(),function(){"use strict";angular.module("nas.shared").directive("nasNetworkStatus",["templateBase",function(n){return{restrict:"A",scope:{},templateUrl:n+"shared/components/networkStatus/networkStatus.tpl.html",controller:["$window","$timeout","$filter",function(n,t,i){var r=this;r.showOfflineNotification=!1;angular.element(n).bind("offline",function(){r.timestamp=i("outputDateTime")(new Date).toString();t(function(){r.showOfflineNotification=!0})});angular.element(n).bind("online",function(){t(function(){r.showOfflineNotification=!1})})}],controllerAs:"vm"}}])}(),function(){"use strict";angular.module("nas.shared").directive("nasNextTrip",["templateBase",function(n){return{restrict:"EA",templateUrl:n+"shared/components/nextTrip/nextTrip.tpl.html",scope:{trip:"="},controller:["$scope","$window","sitemapSvc",function(n,t,i){var r=this;r.trip=n.trip;r.go=function(n){t.location.href=i.get("landingPageBookingDetails")+"?pnr="+n.pnr}}],controllerAs:"vm"}}])}(),function(){"use strict";angular.module("nas.shared").directive("nasNotifier",["notifierSvc","templateBase",function(n,t){return{restrict:"A",replace:!0,scope:{},templateUrl:t+"shared/components/notifier/notifier.tpl.html",controller:function(){var t=this;t.notifications=n.notifications;t.dismiss=function(){t.items=[]}},controllerAs:"vm"}}]).factory("notifierSvc",["$timeout","$rootScope",function(n,t){function r(t,r,f){(u=!0,n(function(){u=!1},2e3),r.type=t,r.showIcon=r.showIcon==undefined?!1:r.showIcon,f==!0&&e(r))||(i.push(r),r.timeout&&n(function(){i.splice(i.indexOf(r),1)},r.timeout*1e3))}function e(n){if(i.length==0||n.items==undefined||n.items.length==0)return!1;var t=_.find(i,function(t){return t.items&&t.items.length>0&&t.items[0]==n.items[0]});return t?!0:!1}function f(){i.length=0}var i=[],u=!1;return t.$on("showSuccessMessage",function(n,t){r("success",t,!1)}),t.$on("showInfoMessage",function(n,t){r("information",t,!1)}),t.$on("showInfoMessageUnique",function(n,t){r("information",t,!0)}),t.$on("showErrorMessage",function(n,t){r("error",t,!1)}),t.$on("hideMessage",function(n,t){var r,u;i.length>0&&(r=_.find(i,["items",t.items]),r&&(u=i.indexOf(r),i.splice(u,1)))}),t.$on("$stateChangeStart",function(){u||f()}),t.$on("clearMessages",function(){f()}),{addMessage:r,notifications:i}}])}(),function(){"use strict";function n(n,t,i){function f(){u()}function e(){r.mode=1}function u(){r.errorHeader="";r.errors=[];r.oneOffCodeOptionsRequest.pnr=t.pnr;r.oneOffCodeOptionsRequest.pnrName=t.pnrName;i.getOneOffCodeOptions(r.oneOffCodeOptionsRequest).$promise.then(function(n){r.oneOffCodeOptions=n.options;r.sendOneOffCodeSubHeader=n.subHeader}).catch(function(n){n.data&&(r.errors=n.data.messageList,r.errorHeader=n.data.header)})}function o(n){n.$valid&&(r.errorHeader="",r.errors=[],r.oneOffCodeRequest.pnr=t.pnr,r.oneOffCodeRequest.pnrName=t.pnrName,r.oneOffCodeRequest.oneOffCodeType=r.selectedOneOffCodeOption,i.sendOneOffCode(r.oneOffCodeRequest).$promise.then(function(n){r.successfullySentMessage=n.message;r.mode=2}).catch(function(n){n.data&&(r.errors=n.data.messageList,r.errorHeader=n.data.header)}))}function s(n){n.$valid&&(r.errorHeader="",r.errors=[],r.loginOneOffCodeRequest.pnr=t.pnr,r.loginOneOffCodeRequest.pnrName=t.pnrName,i.loginOneOffCode(r.loginOneOffCodeRequest).$promise.then(t.onSuccessLogin).catch(function(n){n.data&&(r.errors=n.data.messageList,r.errorHeader=n.data.header)}))}function h(n){r.selectedOneOffCodeOption=n.selected}var r=this;r.mode=1;r.getOneOffCodeOptions=u;r.sendOneOffCode=o;r.loginOneOffCode=s;r.oneOffCodeOptionSelectedHandler=h;r.goBack=e;r.errorHeader="";r.errors=[];r.oneOffCodeOptionsRequest={};r.oneOffCodeRequest={};r.loginOneOffCodeRequest={};f()}var t=angular.module("nas.shared");t.directive("nasOneOffCode",["templateBase",function(t){return{restrict:"EA",scope:{onSuccessLogin:"=",pnr:"=",pnrName:"=",pnrLocal:"="},templateUrl:t+"shared/components/oneOffCode/oneOffCode.tpl.html",controller:n,controllerAs:"vm"}}]);n.$inject=["$state","$scope","oneOffCodeRes"]}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("oneOffCodeRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/oneOffCode/:action",{},{getOneOffCodeOptions:{method:"GET",custom400handling:!0,params:{action:"getOneOffCodeOptions"}},sendOneOffCode:{method:"POST",custom400handling:!0,params:{action:"sendOneOffCode"}},loginOneOffCode:{method:"POST",custom400handling:!0,params:{action:"loginOneOffCode"}}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasPaymentSelection",["templateBase","formValidation",function(n,t){return{restrict:"EA",templateUrl:n+"shared/components/payment/payment.tpl.html",scope:{selection:"=",bypassPayment:"=",paymentOptions:"=",paymentCards:"=",storedCards:"=",isTdsRequired:"=",cardNumberErrors:"=",holderNameErrors:"=",cvc2CodeErrors:"=",cardExpirationErrors:"=",cardTypeErrors:"="},require:"^^form",replace:!0,link:function(n,i,r,u){n.vm.topForm=t.findTopLevelForm(u)},controller:["$scope","$timeout","$translate","optionUtilsSvc","infoModal","sitemapSvc","nasConfig",function(n,i,r,u,f,e,o){function c(){var i=s.cardNumberErrors?s.cardNumberErrors.subscribe(function(n){t.setFieldError(s.paymentSelectionForm,"paymentCcNumber",n)}):undefined,r=s.holderNameErrors?s.holderNameErrors.subscribe(function(n){t.setFieldError(s.paymentSelectionForm,"paymentCcHolderName",n)}):undefined,u=s.cvc2CodeErrors?s.cvc2CodeErrors.subscribe(function(n){t.setFieldError(s.paymentSelectionForm,"paymentCvc",n)}):undefined,f=s.cardExpirationErrors?s.cardExpirationErrors.subscribe(function(n){t.setFieldError(s.paymentSelectionForm,"expirationMonth",n);t.setFieldError(s.paymentSelectionForm,"expirationYear",n)}):undefined,e=s.cardTypeErrors?s.cardTypeErrors.subscribe(function(n){t.setFieldError(s.paymentSelectionForm,"paymentCcType",n)}):undefined;n.$on("$destroy",function(){i&&i.dispose();r&&r.dispose();u&&u.dispose();f&&f.dispose();e&&e.dispose()})}function l(n){s.disableCc=n.selected==="Cashpoints"||n.selected==="Swish";s.disableCvC=s.disableCc;s.disableHolderName=s.disableCc}function a(n,t){f.open(n,t)}function v(n){s.selection.holderName=n?n.holderName:"";s.selection.cardNumber=n?n.number:"";s.selection.cardType=n?n.type:"";s.selection.cardExpirationYear=n?n.expirationYear:"";s.selection.cardExpirationMonth=n?n.expirationMonth:"";s.selection.disableCvC=n?n.cvcDisabled:!1;p()}function y(n,t){return function(i){u.resetSelectedOptions(n);i&&(i.selected=!0);t(i)}}function p(){i(function(){s.paymentSelectionForm.paymentCcNumber.$setValidity("server",!0);s.paymentSelectionForm.paymentCcHolderName.$setValidity("server",!0);s.paymentSelectionForm.paymentCvc.$setValidity("server",!0);s.paymentSelectionForm.expirationMonth.$setValidity("server",!0);s.paymentSelectionForm.expirationYear.$setValidity("server",!0);s.paymentSelectionForm.paymentCcType.$setValidity("server",!0)})}function w(){s.storedCards&&s.storedCards.length!==0&&(_.each(s.storedCards,function(n){n.displayName=n.description?n.number+" - "+n.description:n.number;n.preferred&&(s.selectedStoredPaymentCard=n)}),s.updateStoredPaymentCardSelection=y(s.storedCards,function(n){v(n)}),n.$watch("vm.selection.storedCardId",function(n){var t=_.find(s.storedCards,["id",parseInt(n,10)]);s.updateStoredPaymentCardSelection(t)}),s.selectedStoredPaymentCard&&(s.selection.storedCardId=s.selectedStoredPaymentCard.id))}function b(){s.selection.selectedPaymentOptionType="CreditCard";s.selection.tdsInputModel={userWantTds:{isChecked:!0,isVisible:!0}};s.selection.holderName=s.selection&&s.selection.holderName?s.selection.holderName:"";s.selection.cardType=s.selection&&s.selection.cardType?s.selection.cardType:"";s.selection.cardNumber=s.selection&&s.selection.cardNumber?s.selection.cardNumber:"";s.selection.cvcCode=s.selection&&s.selection.cvcCode?s.selection.cvcCode:"";s.selection.disableCvC=s.selection&&s.selection.disableCvC?s.selection.disableCvC:!1}function k(){o.useLuhnValidation&&i(function(){s.paymentSelectionForm.paymentCcNumber.$validators.luhn=h});b();w();s.infoUrlNorwegianSecurity=e.get("infoUrlNorwegianSecurity");s.infoUrlCvcInfo=e.get("infoUrlNorwegianCvcInfo");s.months=[{value:1,name:"01"},{value:2,name:"02"},{value:3,name:"03"},{value:4,name:"04"},{value:5,name:"05"},{value:6,name:"06"},{value:7,name:"07"},{value:8,name:"08"},{value:9,name:"09"},{value:10,name:"10"},{value:11,name:"11"},{value:12,name:"12"}];s.years=[{value:2016,name:"2016"},{value:2017,name:"2017"},{value:2018,name:"2018"},{value:2019,name:"2019"},{value:2020,name:"2020"},{value:2021,name:"2021"},{value:2022,name:"2022"},{value:2023,name:"2023"},{value:2024,name:"2024"},{value:2025,name:"2025"},{value:2026,name:"2026"}];s.emptyMonth="- "+r.instant("PaymentSelectExpiryMonth")+" -";s.emptyYear="- "+r.instant("PaymentSelectExpiryYear")+" -";s.cvcHeader=r.instant("PaymentCvc");s.termurllist=[];_.forEach([{term:"PaymentTermsReadComplete",url:"infoUrlReadCompleteTermsUrl"},{term:"PaymentConfirmTermsGeneralConditionsLinkText",url:"infoUrlNorwegianGeneralConditionsOfCarriage"},{term:"PaymentConfirmTermsFareRulesLinkText",url:"infoUrlReadCompleteTermsUrl"},{term:"PaymentConfirmTermsBaggageRulesLinkText",url:"infoUrlNorwegianBaggageInfo"},{term:"PaymentConfirmTermsDangerousGoodsLinkText",url:"infoUrlDangerousGoods"}],function(n){var t=r.instant(n.term),i=e.get(n.url);t&&i&&t!==n.term&&s.termurllist.push({url:i,text:t})});n.$watch("vm.selection.cardType",function(n){if(n){var t=_.find(s.paymentCards,["type",n]);t||(t=_.find(s.paymentCards,["type",n.substring(0,2)]),t&&(s.selection.cardType=t.type));s.selection.disableCvC=t!=undefined?t.cvcDisabled:!0;s.disableCvC=s.selection.disableCvC}});n.$watch("vm.disableCc",function(n){n&&s.paymentSelectionForm.expirationMonth&&i(function(){s.paymentSelectionForm.expirationMonth.$setValidity("required",n);s.paymentSelectionForm.expirationYear.$setValidity("required",n);s.paymentSelectionForm.paymentCcType.$setValidity("required",n)})});n.$watch("vm.disableCvC",function(n){n&&s.paymentSelectionForm.paymentCvc&&i(function(){s.paymentSelectionForm.paymentCvc.$setValidity("required",n)})});n.$watch("vm.disableHolderName",function(n){n&&s.paymentSelectionForm.paymentCcHolderName&&i(function(){s.paymentSelectionForm.paymentCcHolderName.$setValidity("required",n)})})}var s=this,h;s.useReactSelectBoxes=o.useReactSelectBoxes;s.selection=n.vm.selection;s.selection.bypassPayment=n.vm.bypassPayment;n.$watch("vm.bypassPayment",function(n){s.selection.bypassPayment=n});s.hideTerms=!1;s.selection.hideTerms&&(s.hideTerms=!0);s.disableCc=s.selection.disableCc==undefined?!1:s.selection.disableCc;s.disableCvC=!1;s.disableHolderName=!1;s.paymentOptions=n.vm.paymentOptions;s.paymentCards=n.vm.paymentCards;s.storedCards=n.vm.storedCards;s.isTdsRequired=n.vm.isTdsRequired;s.openModal=a;s.paymentOptionSelected=l;s.ariaCvcText=r.instant("PaymentCvcExplaination");c();k();h=function(n){return function(t){for(var u=t.length,f=1,i=0,r;u;)r=parseInt(t.charAt(--u),10),i+=(f^=1)?n[r]:r;return i&&i%10==0}}([0,2,4,6,8,1,3,5,7,9])}],controllerAs:"vm",bindToController:!0}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.controller("PaymentCardCtrl",["storedCardsRes","sitemapSvc",function(n,t){var i=this;i.creditcardUrl=t.get("pageUrlProfileCreditCardEdit");n.query().$promise.then(function(n){i.cards=n})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasPaymentCard",["templateBase",function(n){return{restrict:"EA",scope:{},templateUrl:n+"shared/components/paymentCard/paymentCard.tpl.html",controller:"PaymentCardCtrl",controllerAs:"vm"}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("paymentCardsRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/paymentcards",{},{get:{method:"GET"}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("storedCardsRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/storedPaymentCards/:action",{},{get:{method:"GET",custom400handling:!0,isArray:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.controller("ProfileSummaryCtrl",["$scope","$q","rewardSvc","countriesRes","stringutils","$translate","sitemapSvc",function(n,t,i,r,u,f,e){function s(){var n=t.defer();return r.get().$promise.then(function(t){n.resolve(t)}),n.promise}var o=this;o.show=!1;t.all([s(),i.getRewardInfo()]).then(function(n){o.rewardInfo=n[1].reward;var t=n[0].countries.filter(function(n){return n.countryCode==o.profileInfo.country});t.length>0&&(o.profileInfo.countryDisplayName=t[0].countryName);o.show=!0});o.profileInfo={};o.pageUrlClaimCashPointsLookup=e.get("pageUrlClaimCashPointsLookup");o.externalUrlNorwegianRewarDeepLink=e.get("externalUrlNorwegianRewarDeepLink");o.profileInfo=n.profileInfo();o.changeUsernameInfoBoxText=u.format(f.instant("ChangeUsernameInfoTextBox"),"<em>"+o.profileInfo.profile.username+"<\/em>");o.pageUrlProfileEdit=e.get("pageUrlProfileEdit");o.pageUrlShowCashPoints=e.get("pageUrlShowCashPoints")}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasProfileSummary",["templateBase",function(n){return{restrict:"EA",scope:{profileInfo:"&"},templateUrl:n+"shared/components/profileSummary/profileSummary.tpl.html",controller:"ProfileSummaryCtrl",controllerAs:"vm"}}])}(),function(){"use strict";function n(n,t,i,r){var u=this;u.bookingSteps=t.getStepsToDisplay();u.goTo=function(n){n.visited&&t.goToStep(n)};u.activeStepName=n.activeStepName;u.getArialabel=function(n){var t="ProgressionNextStep";return u.activeStepName===n.name&&(t="ProgressionCurrentStep"),n.visited&&(t="ProgressionPreviousStep"),r.format("{0} {1}",i.instant(t),i.instant(n.titleKey))};u.isActiveStep=function(n){return _.includes(n.isActiveFor,u.activeStepName)}}angular.module("nas.shared").directive("nasProgression",["progressionSvc","templateBase",function(t,i){return{restrict:"A",templateUrl:i+"shared/components/progression/progression.tpl.html",scope:{activeStepName:"="},controller:n,controllerAs:"vm"}}]);n.$inject=["$scope","progressionSvc","$translate","stringutils"]}(),function(){"use strict";angular.module("nas.shared").factory("progressionSvc",["$q","$rootScope","$window","$state","progressModelSvc",function(n,t,i,r,u){function e(){return _.find(f,function(n){return n.name===r.$current.name})}function h(){var n=e();return _.find(f.slice(f.indexOf(n)+1),function(n){return n.enabled})}function c(){var n=e();return _.findLast(f.slice(0,f.indexOf(n)),function(n){return n.enabled})}function l(n){var t=h(),i=n?n:t.params;r.go(t.name,i)}function a(){var n=c();n?r.go(n.name,n.params):r.go(u.getFallbackStateName(),u.getFallbackStateParam())}function o(){f=f||[];_.forEach(f.slice(0,f.indexOf(e())),function(n){n.visited=!0})}function s(){_.forEach(f,function(n){n.visited=!1})}function v(n){return _.find(f,function(t){return t.name===n})}function y(){return _.filter(f,function(n){return n.enabled&&n.isActiveFor.length>0})}function p(n){typeof n=="string"&&(n=v(n));r.go(n.name,n.params)}function w(){f=u.getProgressModel();s();o()}var f=u.getProgressModel();return t.$on("$stateChangeSuccess",function(){s();o()}),{init:w,goBack:a,goForward:l,getStepsToDisplay:y,goToStep:p}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.controller("ReceiptCtrl",["$scope","$stateParams","$q","$translate","stringutils","deviceSvc","sitemapSvc","$window","reservationUrlSvc",function(n,t,i,r,u,f,e,o,s){var h=this,c;h.pnr=h.receiptData.booking.pnr;h.pnrLocal=h.receiptData.booking.pnrLocal;h.pnrName=h.receiptData.booking.pnrName;h.receipt=h.receiptData;h.apisEstaInfo=h.receiptData.apisEstaInfo;h.isTravelAssistant=f.isTravelAssistant;h.isPlusSaleHotelEnabled=h.receiptData.isPlusSaleHotelEnabled;h.isPlusSaleHotelNewVendorEnabled=h.receiptData.isPlusSaleHotelNewVendorEnabled;h.hotelSearchModel={};c=h.receiptData.booking.routeList[0].flights;h.hotelSearchModel.destinationFlight=c[c.length-1];h.receiptData.booking.tripType!=="OneWay"&&(h.hotelSearchModel.departureFlight=h.receiptData.booking.routeList[1].flights[0]);h.carTrawlerWidget=h.receiptData.carTrawlerWidget;h.receipt.domesticSpainDiscountText=h.receiptData.subsidyDescription+" "+r.instant("DomesticSpainDiscountApplied");h.toMyReservation=function(){var n={pnr:h.pnr,pnrLocal:h.pnrLocal,pnrName:h.pnrName};o.location.href=s.getReservationUrl(n)}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasReceipt",["$state","templateBase",function(n,t){return{restrict:"A",templateUrl:t+"shared/components/receipt/receipt.tpl.html",scope:{receiptData:"="},controller:"ReceiptCtrl",controllerAs:"vm",bindToController:!0}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasReceiptDetails",["templateBase",function(n){return{restrict:"A",templateUrl:n+"shared/components/receiptDetails/receiptDetails.tpl.html",scope:{model:"=",isFlightDetailsExpandable:"=",isFlightDetailsExpanded:"="},controller:["$scope","$translate","$stateParams","$state","deviceSvc",function(n,t,i,r,u){var f=this;f.model=n.model;f.isFlightDetailsExpandable=n.isFlightDetailsExpandable;f.isFlightDetailsExpanded=n.isFlightDetailsExpanded;f.isTravelAssistant=u.isTravelAssistant;f.isSubsidyApplied=f.model.totalSubsidy>0;f.journeyText=t.instant("Journey");f.outboundFlightText=t.instant("OutboundFlight");f.inboundFlightText=t.instant("InboundFlight");f.getRouteHeader=function(n,t){return n==="TwoWayReturn"&&t===0?f.outboundFlightText:n==="TwoWayReturn"&&t===1?f.inboundFlightText:n==="OneWay"?f.outboundFlightText:f.journeyText.concat(" ",t+1)}}],controllerAs:"vm"}}])}(),function(){"use strict";angular.module("nas.shared").directive("nasRouteList",["templateBase",function(n){return{restrict:"EA",templateUrl:n+"shared/components/routeList/routeList.tpl.html",scope:{routeList:"=",selectedFlight:"="},controller:["$translate","stringutils",function(){var n=this}],controllerAs:"vm"}}])}(),function(){"use strict";angular.module("nas.shared").directive("nasRouteListSelect",["templateBase",function(n){return{restrict:"A",replace:!0,templateUrl:n+"shared/components/routeListSelect/routeListSelect.tpl.html",scope:{routeList:"=",selectedFlight:"=",onFlightChanged:"&"},controller:["$scope",function(){var n=this}],controllerAs:"vm",bindToController:!0}}])}(),function(){"use strict";function n(n,t){function f(){i.isExpanded=!i.isExpanded;u()}function u(){i.detailsText=i.isExpanded?i.detailsTextDoClose:i.detailsTextDoOpen}var r=t.instant("ReservationDetailsFlightDetails"),i=this;i.toggle=f;i.detailsTextDoOpen=r.concat(" (+)");i.detailsTextDoClose=r.concat(" (-)");i.detailsText=i.detailsTextDoOpen;u()}var t=angular.module("nas.shared");t.directive("nasFlightDetails",["templateBase",function(t){return{restrict:"EA",scope:{items:"=",isExpandable:"=",isExpanded:"="},templateUrl:t+"shared/components/routeSummary/flightDetails.tpl.html",controller:n,controllerAs:"vm",bindToController:!0}}]);n.$inject=["$scope","$translate"]}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasFlightDetailsSimple",["templateBase",function(n){return{restrict:"EA",scope:{flight:"="},templateUrl:n+"shared/components/routeSummary/flightDetailsSimple.tpl.html"}}])}(),function(){"use strict";angular.module("nas.shared").directive("nasRouteSummary",["templateBase",function(n){return{restrict:"EA",templateUrl:n+"shared/components/routeSummary/routeSummary.tpl.html",scope:{enableflightdetails:"=",route:"=",hideActionButtons:"=",isFlightDetailsExpandable:"=",isFlightDetailsExpanded:"="},controller:["$translate","stringutils",function(n,t){function u(n){var t=r(n.flights[0].localDepartureDate);angular.forEach(n.flights,function(n){n.offsetDaysDeparture=r(n.localDepartureDate).diff(t,"days");n.offsetDaysArrival=r(n.localArrivalDate).diff(t,"days");n.estimatedDepartureDateFormatted&&(n.offsetDaysEstimatedDeparture=r(n.estimatedDepartureDate).diff(t,"days"))})}function r(n){return moment.utc(n,"YYYY.MM.DD")}function f(){if(u(i.route),i.lastIndex=i.route.flights.length-1,i.route.isTransit){var n=angular.copy(i.route.flights);n.splice(0,1);i.stops=n}}var i=this;i.enableflightdetails=i.enableflightdetails||!1;i.hideActionButtons=i.hideActionButtons||!1;i.isFlightDetailsExpandable=i.isFlightDetailsExpandable||!1;i.isFlightDetailsExpanded=i.isFlightDetailsExpanded||!1;i.route&&(f(),i.myNorwegianDepartureText=n.instant("MyNorwegianDeparture"),i.route.isTransit?(i.route.durationHours>0&&(i.durationText=t.format(n.instant("ReservationDetailsRouteDurationTransitHoursMinutes"),i.route.durationHours,i.route.durationMinutes)),i.route.durationHours===0&&(i.durationText=t.format(n.instant("ReservationDetailsRouteDurationTransitMinutes"),i.routeMinutes))):(i.route.durationHours>0&&(i.durationText=t.format(n.instant("ReservationDetailsRouteDurationHoursMinutes"),i.route.durationHours,i.route.durationMinutes)),i.route.durationHours===0&&(i.durationText=t.format(n.instant("ReservationDetailsRouteDurationMinutes"),i.route.durationMinutes))));i.hourdiff=function(n,t){var i=new Date(n),r=new Date(t),u=i-r;return Math.floor(u%864e5/36e5)};i.mindiff=function(n,t){var i=new Date(n),r=new Date(t),u=i-r;return Math.round(u%864e5%36e5/6e4)}}],controllerAs:"vm",bindToController:!0}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasFareinfo",["$q","$translate","sitemapSvc","stringutils",function(n,t,i,r){return{controller:["$scope","infoModal",function(n,t){n.openModal=function(n,i){t.open(n,i.substring(0,1).toUpperCase()+i.substring(1))}}],template:function(){var u="<button class=\"link\" data-ng-click=\"openModal('{0}', '{1}')\">{1}<\/button>",h=t.instant("ResSelectionFareInfoFullText"),f=t.instant("ResSelectionFareInfoLinkText"),n=t.instant("ResSelectionOptionalChargesFullText"),c=i.get("infoUrlReadCompleteTermsUrl"),l=i.get("infoUrlCreditCardPayment"),a=i.get("infoUrlBaggageCharges"),v=i.get("infoUrlAdditionalFeesPriceList"),e=t.instant("ResSelectionOptionalChargesCreditCardFeeLinkText"),o=t.instant("ResSelectionOptionalChargesBaggageLinkText"),s=t.instant("ResSelectionOptionalChargesOptionalServicesLinkText");return n=n.replace(e,r.format(u,l,e)),n=n.replace(o,r.format(u,a,o)),n=n.replace(s,r.format(u,v,s)),'<div><h3 data-translate="ResSelectionOurFaresHeader"><\/h3>'+h.replace(f,r.format(u,c,f))+'<br><br><h3 data-translate="ResSelectionOptionalChargesHeader"><\/h3>'+n+"<\/div>"},replace:!0}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.directive("nasResselection",["$q","$translate","stringutils","templateBase",function(n,t,i,r){return{restrict:"A",templateUrl:r+"shared/components/selection/selection.tpl.html",replace:!0,scope:{model:"=",isUpdating:"=",hideHeader:"="},link:function(n){function u(){n.model.cashpointBalance&&(n.cashpointBalanceText=i.format(f,n.model.cashpointBalance,r));n.remainingBalanceText=i.format(e,r)}function o(){var t=!1;return n.model&&(n.model.items&&(t=_.some(n.model.items,function(n){return n.details&&n.details.length>0})),!t&&n.model.routeList&&n.model.routeList.length>0&&_.forEach(n.model.routeList,function(n){t=_.some(n.items,function(n){return n.details&&n.details.lenght>0})})),t}var f=t.instant("LoyaltyTitleBalance"),e=t.instant("TravelDetailsLoyaltyFooter"),r=t.instant("LoyaltyCurrency"),s=n.$watch("model",function(){n.model&&(s(),u(),n.hasExpandableDetails=o())});n.$watch("model.showReceiptDetails",function(t){n.model&&n.model.items&&(u(),_.forEach(n.model.items,function(n){n&&(n.expandDetails=!!t)}),_.forEach(n.model.routeList,function(n){n&&_.forEach(n.items,function(n){n&&(n.expandDetails=!!t)})}))})}}}])}(),function(){"use strict";angular.module("nas.shared").directive("nasTripsList",["templateBase",function(n){return{restrict:"EA",replace:!0,templateUrl:n+"shared/components/tripsList/tripsList.tpl.html",scope:{trips:"&",size:"&",reverse:"&",emptyTexts:"&"},controller:["$scope",function(n){var t=this;t.show=!1;t.emptyTexts=n.emptyTexts();t.allTrips=n.trips();n.reverse()&&t.allTrips.reverse();t.trips=n.size()?n.trips().slice(0,n.size()):n.trips();t.show=!0}],controllerAs:"vm"}}])}(),function(){"use strict";angular.module("nas.shared").directive("nasTripsummary",["templateBase","$translate",function(n,t){return{restrict:"EA",scope:{routelist:"=",header:"="},templateUrl:n+"shared/components/tripSummary/trip.summary.tpl.html",controller:["$scope",function(n){var i=this;i.header=n.header;i.routeList=n.routelist;i.getRouteTypeName=function(n){switch(n){case"Outbound":return t.instant("OutboundFlight");case"Inbound":return t.instant("InboundFlight");default:return t.instant("UnspesifiedFlight")}}}],controllerAs:"vm"}}])}(),function(){"use strict";function t(n,t){for(var r=[],u,i=0;i<n.length;i++)u=n[i][t],r.indexOf(u)==-1&&r.push(u);return r}var n=angular.module("nas.shared");n.filter("airportName",function(){return function(n){return n.displayName+" ("+n.code+")"}});n.filter("airportDisplayname",["airportsSvc",function(n){return function(t){return n.get(t).displayName}}]);n.filter("prefixDisplayName",function(){return function(n){return n.value?{name:n.name+" ("+n.value+")",value:n.value}:n.phonePrefix?{name:n.countryName+" ("+n.phonePrefix+")",value:n.phonePrefix}:n.name||n.countryName}});n.filter("normalizePrefix",function(){return function(n){return _.map(n,function(n){return n.name?{name:n.name+" ("+n.value+")",value:n.value}:n.phonePrefix?{name:n.countryName+" ("+n.phonePrefix+")",value:n.phonePrefix}:n})}});n.filter("timespan",function(){return function(n,t){var r,u,f,i=moment.duration(moment(t).diff(moment(n)));return i.days()>0&&(r=i.days()+"d"),i.hours()>0&&(u=i.hours()+"h"),i.minutes()>0&&(f=i.minutes()+"m"),_.compact([r,u,f]).join(" ")}});n.filter("numberSpaces",function(){return function(n){return n?n.toString().replace(/\B(?=(\d{3})+(?!\d))/g," "):""}});n.filter("sumByKey",function(){return function(n,t){if(typeof n=="undefined"||typeof t=="undefined")return 0;var i=0;return _.forEach(n,function(n){var r=n[t]===""?"0":n[t].replace(/\s+/g,"").replace(/,/g,".");i+=parseFloat(r)}),new Intl.NumberFormat("nb-NO",{minimumFractionDigits:2}).format(i)}});n.filter("fullName",function(){return function(n){return n.firstname+" "+n.lastname}});n.filter("price",function(){return function(n){return angular.isDefined(n)&&n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}});n.filter("groupBy",function(){return function(n,i){if(n!==null)return t(n,i)}});n.filter("range",[function(){return function(n,t,i){for(var r=t;r<=i;r++)n.push(r);return n}}]);n.filter("stripTimeZone",function(){return function(n){var t;return t=n instanceof Date&&!isNaN(n.valueOf())?n.toISOString():""+n,new Date(t.substring(0,t.length-6))}});n.filter("outputDateTime",["$filter",function(n){return function(t){return n("date")(t,"mediumDate")+" "+n("date")(t,"shortTime")}}]);n.filter("routeCount",function(){return function(n,t,i,r){return _.filter(n,function(n,u){return u<i||!n.isTransit||n.routeId==t||r})}})}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("agreementCodesRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/profile/agreementcodes",{},{get:{method:"GET",custom400handling:!0,isArray:!0},save:{method:"POST",custom400handling:!0,isArray:!0},"delete":{method:"DELETE",custom400handling:!0,isArray:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("availabilitySearchRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/availabilitySearch/:action",{},{init:{method:"GET",params:{action:"init"}}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("countriesRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/countries",{},{get:{method:"GET",cache:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("currencyRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/currency",{agreementCode:""})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("destinations",["$http","nasConfig",function(n,t){return{get:function(i){return n.get(t.resourcePrefix+"/api/destinations",{params:{destinationModel:i||"AirportModel",includeRelations:!1,v:t.cacheBuster,sortByCountryAndName:!1}})}}}]);n.factory("destinationsRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/destinations/:action",{destinationModel:"AirportModel",includeRelations:!1,v:t.cacheBuster,sortByCountryAndName:!1},{get:{method:"GET"},suggestions:{method:"GET",params:{action:"suggestions"},custom400handling:!0,custom500handling:!0}})}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("newsletterRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/profile/newsletter/:action",{},{get:{method:"GET",custom400handling:!0},save:{method:"POST",custom400handling:!0,params:{action:"saveNewsletter"}},supportedAirports:{method:"GET",custom400handling:!0,params:{action:"supportedAirports"}}})}])}(),function(){"use strict";angular.module("nas.shared").factory("availabilitySearchSvc",["$q","$window","urlHelper","userSelectionSvc","availabilitySearchRes",function(n,t,i,r,u){function f(t){var f=n.defer(),i;return t?(i=t,i.userSelection=r.init(i.userSelection),f.resolve(i)):u.init().$promise.then(function(n){i=n;i.userSelection=r.init(i.userSelection);f.resolve(i)}),f.promise}function e(n,u){n.isRoundTrip=n.tripType==="OneWay"?!1:!0;var f=r.getStateParams(n);t.location.href=n.isGroupSearch||n.isGroupBooking?i.buildUrl(u.pageUrlGroupTravelAvaDay,f):n.isAllotmentSearch?i.buildUrl(u.pageUrlAllotmentBooking,f):n.resultType==="AvaDay"?i.buildUrl(u.pageUrlAvailabilityAvaDay,f):i.buildUrl(u.pageUrlAvailabilityFareCalendar,f)}return{init:f,search:e}}])}(),function(){"use strict";angular.module("nas.shared").factory("currencySvc",["currencyRes",function(n){var t=_.memoize(function(t){return n.get({agreementCode:t})});return{getCurrencies:t}}])}(),function(){"use strict";var n=angular.module("nas.shared");n.factory("airportsSvc",["destinations","$sessionStorage","$q",function(n,t,i){var u=i.defer(),r=t.airports;return r||(r=t.airports=[]),r&&r.length>0?u.resolve(r):n.get().success(function(n){r=t.airports=n.destinations;u.resolve(r)}),{airports:u.promise,get:function(n){return _.find(r,function(t){return t.code===n})||"-"}}}])}(),function(){"use strict";angular.module("nas.shared").factory("phoneNumberSvc",[function(){function t(t){if(!n||n.length===0){var i=_.filter(t,function(n){return n.phonePrefix!==""});n=_.map(i,function(n){return{prefix:n.phonePrefix,name:n.countryName+" ("+n.phonePrefix+")",value:n.phonePrefix+n.countryCode}})}return n}function i(n,t,i){if(t)return n?n+t:"";if(n){var r=_.find(i,function(t){return t.prefix==n});if(r)return r.value}return""}var n;return{getPhonePrefixes:t,getPrefixAndCountry:i}}])}(),function(){"use strict";angular.module("nas.shared").factory("bookingTemporaryDataSvc",["$sessionStorage",function(n){function t(t){n.bookingTemporaryData.paxData=t}function i(){n.bookingTemporaryData.paxData={}}function r(){return n.bookingTemporaryData&&n.bookingTemporaryData.paxData?angular.copy(n.bookingTemporaryData.paxData):null}return n.bookingTemporaryData=n.bookingTemporaryData||{},{storePaxData:t,getPaxData:r,clearPaxData:i}}])}(),function(){"use strict";angular.module("nas.shared").factory("codeSelectionSvc",["$sessionStorage","agreementCodesRes",function(n,t){function u(n){n?typeof n=="string"?(i.agreementCode=n,i.campaignCode=""):n.id&&(i.agreementCode=n.id,i.campaignCode=""):i.agreementCode="-1"}function f(n){n?(i.campaignCode=n.toUpperCase(),i.agreementCode=""):i.campaignCode=""}function e(){return i.agreementCodes}function o(){return i.agreementCode}function s(){return i.campaignCode}function h(n){r.finally(n)}var i=n.codeSelection,r=t.get().$promise;return i||(i=n.codeSelection={agreementCodes:[]}),r.then(function(n){i.agreementCodes=n}).catch(function(){i.agreementCode=""}),{done:h,setAgreementCode:u,setCampaignCode:f,getAgreementCodes:e,getAgreementCode:o,getCampaignCode:s}}])}(),function(){"use strict";angular.module("nas.shared").factory("progressModelSvc",["$sessionStorage",function(n){function t(t){t&&(n.progressModel=t)}function i(){return n.progressModel}function r(t){t&&(n.progressFallbackStateName=t)}function u(){return n.progressFallbackStateName}function f(t){t&&(n.progressFallbackStateParam=t)}function e(){return n.progressFallbackStateParam}return{setProgressModel:t,getProgressModel:i,setFallbackStateName:r,getFallbackStateName:u,setFallbackStateParam:f,getFallbackStateParam:e}}])}(),function(){"use strict";angular.module("nas.shared").factory("reservationDetailsSvc",["$sessionStorage",function(n){function t(t){n.updatedReservationDetailsModel=t}function i(){var t=null;return n.updatedReservationDetailsModel&&(t=angular.copy(n.updatedReservationDetailsModel),sessionStorage.removeItem("ngStorage-updatedReservationDetailsModel"),delete n.updatedReservationDetailsModel),t}return{store:t,tryGetAndRemove:i}}])}(),function(){"use strict";angular.module("nas.shared").factory("scheduleChangeSvc",["$sessionStorage",function(n){function t(t){var i=null;return n.acceptedPnrListForSC&&(i=_.filter(n.acceptedPnrListForSC,function(n){return n===t})),i}function i(t){n.acceptedPnrListForSC||(n.acceptedPnrListForSC=[]);n.acceptedPnrListForSC.push(t)}return{isPnrAccepted:t,addAcceptedPnr:i}}])}(),function(){"use strict";angular.module("nas.shared").factory("userSelectionSvc",["$sessionStorage",function(n){function f(n){var t=_.pick(n,["fareType","type","flights"]),i=_.pick(n.bundle,["isIncluded","priceCode"]);return t.bundle=i,t}function e(n){return n.charAt(0).toLowerCase()+n.slice(1)}function i(n,t){var i=_.pick(n,["routeId","selectedFare","flightList","origin","destination"]);return i.selectedFare=f(n[e(t)]),i}function r(){if(t.outboundRoute&&t.inboundRoute){var n=t.outboundRoute.flightList.length;_(t.inboundRoute.flightList).forEach(function(t,i){t.legRef=n+i+1})}}var t=n.userSelectionData||{},o=function(n){if(n){var i=moment(),r="00",u=i.month()+1,h=r.substring(0,r.length-u.toString().length)+u,f=moment((n.D_Month||i.year()+""+h)+(n.D_Day||i.date()),"YYYYMMDD"),c=n.R_Month&&n.R_Day?moment(n.R_Month+n.R_Day,"YYYYMMDD"):f,e=parseInt(n.AdultCount),o=parseInt(n.ChildCount),s=parseInt(n.InfantCount);t.origin=n.D_City||t.origin;t.destination=n.A_City||t.destination;t.outboundDate=f.format("YYYY-MM-DD")||t.outboundDate;t.inboundDate=c.format("YYYY-MM-DD")||t.inboundDate;t.adultCount=isNaN(e)?t.adultCount:e;t.childCount=isNaN(o)?t.childCount:o;t.infantCount=isNaN(s)?t.infantCount:s;t.isRoundTrip=parseInt(n.TripType)===1?!1:!0;t.includeTransit=""+n.IncludeTransit=="false"?!1:!0;t.campaignCode=n.AgreementCode||t.campaignCode;t.agreementCodeFK=n.AgreementCodeFK||t.agreementCodeFK;t.currencyCode=n.CurrencyCode||t.currencyCode;t.isSsrNeeded=""+n.IsSsrNeeded=="true"?!0:!1;t.tripType=t.isRoundTrip?"TwoWayReturn":"OneWay";t.domesticSpainModel={subsidyDefinitionId:n.SubsidyDefinitionId};t.resultType=t.resultType?t.resultType:"AvaDay";t.subsidyDefinitionId=typeof t.domesticSpainModel=="undefined"?null:t.domesticSpainModel.subsidyDefinitionId}},s=function(i){return n.userSelectionData||(t=n.userSelectionData=i),t},h=function(){var n=t,i={destination:n.destination,origin:n.origin,outboundDate:n.outboundDate,inboundDate:n.inboundDate,outboundFareType:n.outboundFareType,inboundFareType:n.inboundFareType,includeTransit:""+n.includeTransit=="false"?!1:!0,isRoundTrip:n.isRoundTrip,adultCount:n.adultCount||1,childCount:n.childCount||0,infantCount:n.infantCount||0,currencyCode:n.currencyCode||"NOK",agreementCode:n.campaignCode||null,agreementCodeFK:!n.campaignCode&&n.agreementCodeFK?n.agreementCodeFK:null,fasttrackSelection:n.fasttrackSelection||[],isSsrNeeded:n.isSsrNeeded,subsidyDefinitionId:typeof n.domesticSpainModel=="undefined"?null:n.domesticSpainModel.subsidyDefinitionId};return n.outboundRoute&&(i.routeIds=[n.outboundRoute.routeId],n.isRoundTrip&&n.inboundRoute&&i.routeIds.push(n.inboundRoute.routeId)),i},c=function(n){var i=t;_.assign(i,n);var u=moment(i.outboundDate),f=moment(i.inboundDate),r={D_Day:u.format("DD"),R_Day:f.format("DD"),D_Month:u.format("YYYYMM"),R_Month:f.format("YYYYMM"),AdultCount:i.adultCount||1,ChildCount:i.childCount||0,InfantCount:i.infantCount||0,IncludeTransit:""+i.includeTransit=="false"?!1:!0,TripType:i.isRoundTrip?2:1};return i.origin&&(r.D_City=i.origin),i.destination&&(r.A_City=i.destination),i.flightCodeOutbound&&(r.FC_O=i.flightCodeOutbound),i.flightCodeReturn&&(r.FC_R=i.flightCodeReturn),i.externalReference&&(r.E_Ref=i.externalReference),i.currencyCode&&(r.CurrencyCode=i.currencyCode),i.soldInLanguage&&(r.SoldInLanguage=i.soldInLanguage),i.currencyCode&&(r.CurrencyCode=i.currencyCode),i.dFare&&(r.dFare=i.dFare),i.rFare&&(r.rFare=i.rFare),i.campaignCode&&(r.AgreementCode=i.campaignCode),i.agreementCodeFK&&(r.AgreementCodeFK=i.agreementCodeFK),i.isSsrNeeded&&(r.IsSsrNeeded=i.isSsrNeeded),i.domesticSpainModel&&i.domesticSpainModel.subsidyDefinitionId&&(r.SubsidyDefinitionId=t.domesticSpainModel.subsidyDefinitionId),r},l=function(){n.userSelectionData&&(sessionStorage.removeItem("ngStorage-userSelectionData"),delete n.userSelectionData)},a=function(){delete t.inboundRoute;delete t.inboundFareType;delete t.outboundRoute;delete t.outboundFareType;delete t.isCancellationProtectionSelected;delete t.fasttrackSelection;t.paymentInfo={};t.ancillaries=[];t.selectedInboundSeats=[];t.selectedOutboundSeats=[]},v=function(n,u){t.inboundRoute=i(n,u);t.inboundFareType=u;r()},y=function(n,u){t.outboundRoute=i(n,u);t.outboundFareType=u;r()},u=function(n){t.inboundDate!=n.replace(/(\+.*$)/,"")&&(t.inboundDate=n,t.inboundRoute=null,t.inboundFareType="")},p=function(n){t.outboundDate!=n.replace(/(\+.*$)/,"")&&(t.outboundDate=n,t.outboundRoute=null,t.outboundFareType="",(!t.inboundDate||t.inboundDate<n)&&u(n))},w=function(n){return t.outboundRoute.routeId==n?t.outboundRoute:t.inboundRoute.routeId==n?t.inboundRoute:undefined},b=function(n){t.isUnregisteredBooking=n},k=function(n){t.isSsrNeeded=n};return{selection:t,setInboundRoute:v,setOutboundRoute:y,setInboundDate:u,setOutboundDate:p,getRoute:w,unregistered:b,init:s,reset:l,activateSsr:k,setSelectionFromStateParams:o,getStateParams:c,clearFareData:a,getAvailabilityRequest:h}}])}(),function(){"use strict";var n=angular.module("nas.reward");n.factory("rewardRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/reward")}])}(),function(){"use strict";angular.module("nas.reward").factory("rewardSvc",["$q","rewardRes",function(n,t){function r(){if(i)return n.when(i);var r=n.defer();return t.get().$promise.then(function(n){i=n;r.resolve(n)}),r.promise}function u(){var r=n.defer();return t.save().$promise.then(function(n){r.resolve(n);i=null}),r.promise}var i;return{getRewardInfo:r,signUp:u}}])}(),function(){"use strict";var n=angular.module("nas.reward");n.controller("RewardinfoCtrl",["$q","$state","$translate","$scope","$window","rewardSvc","sitemapSvc","stringutils","infoModal",function(n,t,i,r,u,f,e,o,s){function c(){s.open(e.get("infoUrlNorwegianRewardConditions"),"RewardTermsReadMore")}function l(n){n.$invalid?n.confirmTerms.$setTouched():f.signUp().then(function(n){h.reward=n;h.rewardinfo=o.format(i.instant("ProfileRewardCreateSuccess"),h.reward.rewardNumber);r.$emit("setProfileRewardNumber",h.reward.rewardNumber)})}var h=this;h.show=!1;h.confirm=!1;h.login=function(){u.location.href=e.get("pageUrlProfileLogin")+"?returnHash="+u.location.hash};h.register=function(){t.go("profile.create",{returnHash:u.location.hash})};h.mypageUrl=e.get("landingPageMyNorwegian");h.openRewardTermsModal=c;h.save=l;r.showRewardForProfile&&(h.showRewardForProfile=!0);f.getRewardInfo().then(function(n){h.profile=n.profileName;h.reward=n.reward;r.showSignupOnly?h.reward===null&&h.profile&&(h.show=!0):h.show=!0})}])}(),function(){"use strict";var n=angular.module("nas.reward");n.directive("nasRewardinfo",["templateBase",function(n){return{restrict:"EA",scope:{showRewardForProfile:"=?",showSignupOnly:"=?"},templateUrl:n+"reward/rewardinfo.tpl.html",controller:"RewardinfoCtrl",controllerAs:"vm"}}])}(),function(){"use strict";var n=angular.module("nas.holidays");n.directive("nasHolidaysSearch",["$q","$translate","$window","$sce","$sessionStorage","$timeout","$cookies","dateAvailabilitySearchRes","templateBase","destinationsRes","nasConfig",function(n,t,i,r,u,f,e,o,s,h,c){return{priority:10,restrict:"A",templateUrl:s+"holidays/holidayssearch.tpl.html",replace:!1,scope:{model:"&",holidaySearch:"=search",bannerName:"=?"},link:{pre:function(n){function p(){k&&f.cancel(k);k=f(function(){pt()},100)}function at(t){n.airports=t;n.origins=_.filter(n.airports.destinations,function(n){return n.code.length>3&&n.code.indexOf("ALL")>-1?!1:n.code});n.destinations=_.filter(n.airports.destinations,function(n){return n.code.length>3&&n.code.indexOf("ALL")>-1&&!n.norwegianHolidayAreaId?!1:n.code})}function ft(){n.canSearch=!!(n.holidaysModel.origin&&n.holidaysModel.destination);wt()}function vt(){n.holidaysModel.outboundDate=s(moment(n.holidaysModel.outboundDate));n.holidaysModel.inboundDate=s(moment(n.holidaysModel.inboundDate));var t=_.find(n.destinations,function(t){return t.code===n.holidaysModel.destination}),i={searchType:n.holidaysModel.searchType,origin:n.holidaysModel.origin,destination:n.holidaysModel.destination,norwegianHolidayAreaType:t?t.norwegianHolidayAreaType:"",norwegianHolidayAreaId:t?t.norwegianHolidayAreaId:"",outboundDate:moment(n.holidaysModel.outboundDate).format("DD%2FMM%2FYY"),inboundDate:moment(n.holidaysModel.inboundDate).format("DD%2FMM%2FYY"),roomCount:n.holidaysModel.roomCount,roomInfo:encodeURIComponent(JSON.stringify({rooms:n.holidaysModel.rooms},yt)),holidaySearchOrigin:n.model.holidaySearchOrigin};n.holidaySearch(i,n.bannerName)}function yt(n,t){return n==="$$hashKey"?undefined:t}function et(t,i,r){if(nt||!n.enableDateAvailabilitySearch||r==="month")return!1;var u=!0;return t.forEach(function(n){if(n.getDate()===i.getDate()&&n.getMonth()===i.getMonth()){u=!1;return}}),u}function pt(){var u=new Date(l),f=new Date(a),t,r;(f<u&&(a=l),t={origin:i.origin,destination:i.destination,outboundDate:l,inboundDate:a,isRoundTrip:!0},t.origin&&t.destination)&&(n.isUpdatingDatePicker=!0,r=angular.toJson(t),b[r]?(ot(b[r]),n.isUpdatingDatePicker=!1):o.get(t).$promise.then(function(t){ot(t);b[r]=t;n.isUpdatingDatePicker=!1},function(t){t.data&&(nt=!0,n.messageList=t.data.messageList,n.messageListType="error",n.expandOptions=!1,n.canSearch=!1,n.isUpdatingDatePicker=!1)}))}function ot(t){n.enableDateAvailabilitySearch=t.enableDateAvailabilitySearch;st(t.outboundResult,y);st(t.inboundResult,d);n.messageList=[];n.$broadcast("refreshDatepickers");n.footerMessageOutbound=y.length===0?g:"";n.footerMessageInbound=d.length===0?g:""}function st(n,t){t.length=0;n.forEach(function(n){var i=n.year+"-"+("0"+n.month).slice(-2)+"-"+("0"+n.day).slice(-2);t.push(moment(i).toDate())})}function wt(){f(function(){n.expandOptions=n.holidaysModel.origin&&n.holidaysModel.destination;n.expandOptions?f(function(){n.showOverflow=!0},600):n.showOverflow=!1})}function bt(){h.get({includeRelations:!0}).$promise.then(at);ft();i.labelChildren=t.instant("PaxChildren");i.labelFlightHotel=t.instant("FlightHotel");i.labelFlightCar=t.instant("FlightCar");i.labelRooms=t.instant("Rooms");i.labelChildrenAge=t.instant("ChildAge");i.labelAdults=t.instant("SearchAdults");n.searchTypes=tt}function s(n){return n.format("YYYY-MM-DD")}var w,i,it,rt,ut;n.model=n.model();n.accessibilityMode=!1;c.cookies.overrideDisplayModeCookie&&(w=e.get(c.cookies.overrideDisplayModeCookie.name),w&&w===c.cookies.overrideDisplayModeCookie.valueMobile&&(n.accessibilityMode=!0));n.totalChildCount=0;n.isUpdatingDatePicker=!1;var b={},g=t.instant("AvailabilityNoFlightsFound"),nt=!1,v=moment(n.model.minDate).add(n.model.holidaySearchOutboundDateOffset,"days"),ht=v,ct=moment(n.model.minDate).add(n.model.holidaySearchInboundDateOffset,"days"),k,tt={flightHotel:"air_room",flightCar:"air_car"},lt={holidays:{origin:"",destination:"",outboundDate:s(ht),inboundDate:s(ct),roomCount:1,rooms:[],searchType:tt.flightHotel}};i=u.holidays;i||(i=u.holidays=lt.holidays);it=moment(i.outboundDate);it<v&&(i.outboundDate=s(v));n.accessibilityMode&&(i.outboundDate instanceof Date||(rt=new Date(i.outboundDate?i.outboundDate:n.model.minDate),i.outboundDate=rt),i.inboundDate instanceof Date||(ut=new Date(i.inboundDate?i.inboundDate:n.model.minDate),i.inboundDate=ut));var y=[],d=[],l=s(moment(i.outboundDate).date(1)),a=s(moment(i.inboundDate).date(1));i.labelRooms="Rooms";i.labelChildren="";i.labelChildrenAge="";n.search=vt;n.holidaysModel=i;n.airportChange=ft;n.canSearch=!1;n.outboundMinDate=v;n.inboundMinDate=v;n.trustAsHtml=r.trustAsHtml;n.expandOptions=!1;n.showOverflow=!1;n.canAdd=function(){return n.totalChildCount<6};bt();n.$on("dateViewSwitched",function(n,t){t.name==="holidaysOutbound"&&t.date.getMonth()!==new Date(l).getMonth()?(l=s(moment(t.date).date(1)),p()):t.name==="holidaysInbound"&&t.date.getMonth()!==new Date(a).getMonth()&&(a=s(moment(t.date).date(1)),p())});n.$watch("holidaysModel.outboundDate",function(t){t&&(typeof t=="string"?(n.inboundMinDate=t,l=s(moment(t).date(1)),n.inboundMaxDate=s(moment(t).add(n.model.holidaySearchMaxPeriodDays,"days"))):(n.inboundMinDate=s(moment(t)),l=s(moment(t).date(1)),n.inboundMaxDate=s(moment(t).add(n.model.holidaySearchMaxPeriodDays,"days"))),!n.accessibilityMode||t instanceof Date||(i.outboundDate=new Date(t)))});n.$watch("holidaysModel.rooms",function(){var t=0;_.forEach(i.rooms,function(n){n.childAges.length>n.numChildren?n.childAges.pop():n.childAges.length<n.numChildren&&(n.childAges.length=n.numChildren);t+=n.numChildren+n.numInfantsInLaps});n.totalChildCount=t},!0);n.$watch("holidaysModel.roomCount",function(n){n>i.rooms.length?i.rooms.push({numAdults:2,numChildren:0,numInfantsInLaps:0,childAges:[]}):i.rooms.length=n});n.$watch("holidaysModel.inboundDate",function(t){t&&(a=s(moment(t).date(1)),!n.accessibilityMode||t instanceof Date||(i.inboundDate=new Date(t)))});n.$watch("holidaysModel.origin",function(t){t&&(p(),n.airports&&(n.destinations=_.filter(n.airports.destinations,function(n){return n.code.length>3&&n.code.indexOf("ALL")>-1&&!n.norwegianHolidayAreaId?!1:i.origin&&i.origin===n.code?!1:n.code})))});n.$watch("holidaysModel.destination",function(n){n&&p()});n.inboundDisabled=function(n,t){return et(d,n,t)};n.outboundDisabled=function(n,t){if(t==="month"&&y.length!==0){var i=y[0].getYear()===n.getYear();return!i}return et(y,n,t)};n.clear=function(){n.holidaysModel.origin="";n.holidaysModel.destination="";f(function(){n.holidaysModel.outboundDate="";f(function(){n.holidaysModel.inboundDate=""});n.toggleChild=!1;n.model.request.searchType=n.searchTypes.flightHotel},200)}}}}}])}(),function(){"use strict";var n=angular.module("nas.cartrawler");n.factory("cartrawlerRes",["$resource","nasConfig",function(n,t){return n(t.resourcePrefix+"/api/cartrawler",{v:t.cacheBuster},{get:{method:"GET",custom400handling:!0,custom500handling:!0}})}])}(),function(){"use strict";angular.module("nas.cartrawler").factory("cartrawlerSvc",function(){function n(n){var i=[],t;for(t in n)n.hasOwnProperty(t)&&i.push(encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return i.join("&")}return{getCartrawlerUrl:function(t,i){return"https://cars.cartrawler.com/norwegian-new/"+t+"/book?"+decodeURIComponent(n(i))}}})}(),function(){"use strict";var n=angular.module("nas.cartrawler");n.directive("nasCartrawlerSearch",["$cookies","$q","$translate","$window","$sce","$sessionStorage","$timeout","nasConfig","templateBase","cartrawlerRes",function(n,t,i,r,u,f,e,o,s,h){return{priority:10,restrict:"A",templateUrl:s+"cartrawler/cartrawlersearch.tpl.html",replace:!1,scope:{model:"&",carSearch:"=search",bannerName:"=?"},link:{pre:function(t){function g(n){i.pickupLocations=n.carRentalLocations}function nt(n){i.returnLocations=n.carRentalLocations}function l(){t.canSearch=!!(t.trawlerModel.deliverElsewhere?t.trawlerModel.pickupLocation&&t.trawlerModel.returnLocation:t.trawlerModel.pickupLocation)}function tt(){k("");l()}function k(n){h.get({searchString:n}).$promise.then(g).catch(function(n){t.errors=n.data.messageList;t.errorHeader=n.data.header})}function it(n){h.get({searchString:n}).$promise.then(nt).catch(function(n){t.errors=n.data.messageList;t.errorHeader=n.data.header})}var c,s;t.accessibilityMode=!1;o.cookies.overrideDisplayModeCookie&&(c=n.get(o.cookies.overrideDisplayModeCookie.name),c&&c===o.cookies.overrideDisplayModeCookie.valueMobile&&(t.accessibilityMode=!0));t.model=t.model();var a=new Date,r="10:00",v=r,y=r,d={carTrawler:{pickupLocation:"",returnLocation:"",pickupDateTime:moment(a).add(1,"days"),pickupTime:r,returnDateTime:moment(a).add(2,"days"),returnTime:r,currencyCode:t.model.userSelection.currencyCode,languageCode:t.model.neutralLanguageCode,deliverElsewhere:!1}},i=f.carTrawler;for(i||(i=f.carTrawler=d.carTrawler),i.languageCode=t.model.neutralLanguageCode,i.pickupLabel=t.model.pickupLabel,i.pickupDateTimeLabel=t.model.pickupDateTimeLabel,i.returnLabel=t.model.returnLabel,i.returnDateTimeLabel=t.model.returnDateTimeLabel,i.pickupAndReturnLabel=t.model.pickupAndReturnLabel,i.pickupTime&&i.pickupTime!=""||(i.pickupTime=r),i.returnTime&&i.returnTime!=""||(i.returnTime=r),t.trawlerModel=i,t.airportChange=l,t.getPickupLocations=k,t.getReturnLocations=it,t.canSearch=!1,t.pickupMinDateTime=t.model.minDate,t.returnMinDateTime=t.model.minDate,t.trustAsHtml=u.trustAsHtml,t.hoursList=[],s=0;s<=23;s++){var p=s<10?"0"+s:""+s,w=p+":00",b=p+":30";t.hoursList.push({displayName:w,code:w});t.hoursList.push({displayName:b,code:b})}tt();t.$watch("trawlerModel.deliverElsewhere",function(n){n&&(angular.element(document.getElementById("returnLocation")).addClass("animation__pop-in-from-top"),e(function(){angular.element(document.getElementById("returnLocation")).removeClass("animation__pop-in-from-top")},400));l()});t.$watch("trawlerModel.pickupDateTime",function(n){n&&(t.returnMinDateTime=typeof n=="string"?n:moment(n).format("YYYY-MM-DD[T]HH:mm"))});t.onTimeChange=function(){i.pickupTime==""&&(i.pickupTime=v);v=i.pickupTime;i.returnTime==""&&(i.returnTime=y);y=i.returnTime};t.search=function(){var u=t.trawlerModel.languageCode,n=t.trawlerModel.pickupTime.split(":"),i=t.trawlerModel.returnTime.split(":"),r;t.trawlerModel.pickupDateTime=moment(t.trawlerModel.pickupDateTime).hours(n[0]).minutes(n[1]).format("YYYY-MM-DD[T]HH:mm");t.trawlerModel.returnDateTime=moment(t.trawlerModel.returnDateTime).hours(i[0]).minutes(i[1]).format("YYYY-MM-DD[T]HH:mm");r={pickupID:t.trawlerModel.pickupLocation,returnID:t.trawlerModel.deliverElsewhere?t.trawlerModel.returnLocation:t.trawlerModel.pickupLocation,residencyId:o.culture.slice(3),curr:t.trawlerModel.currencyCode||"EUR",age:"30",pickupDateTime:t.trawlerModel.pickupDateTime,returnDateTime:t.trawlerModel.returnDateTime};t.carSearch(u,r,t.bannerName)}}}}}])}(),function(){"use strict";var n=angular.module("nas.experiment",[]);n.factory("urlQuery",["$window",function(n){var t={},i=n.location.search;return i.replace(/([^?=&]+)(=([^&]*))?/g,function(n,i,r,u){t[i]=u}),{params:t}}]);n.factory("nasExperiment",["urlQuery",function(n){var t="a",i=n.params;return i&&i.site&&(t=i.site.toLowerCase()),{site:t,className:"alt-"+t}}])}(),function(){"use strict";angular.module("nas.availabilitysearch").controller("FullSearchCtrl",["$sessionStorage","searchModel","nasConfig","destinations","currencySvc","cartrawlerSvc","availabilitySearchSvc",function(n,t,i,r,u,f,e){function h(){var n=new Date;return moment(new Date(n.getFullYear(),n.getMonth(),n.getDate())).format("YYYY-MM-DD")}function c(){var n=new Date;return moment(new Date(n.getFullYear(),n.getMonth(),n.getDate())).add(i.avaSearchDayLimit,"days").format("YYYY-MM-DD")}var o=this,s;t.airportRelations=r.relations;o.searchModel=t;o.searchModel.minDate=h();o.searchModel.maxDate=c();o.searchModel.originAirportList=r.destinations;o.searchModel.adultMaxCount=9;u.getCurrencies().$promise.then(function(n){o.searchModel.userSelection.currencyCode=n.currencyCodes[0]});o.searchModel.holidaySearchOutboundDateOffset=3;o.searchModel.holidaySearchInboundDateOffset=6;o.searchModel.holidaySearchMaxPeriodDays=29;o.tab=n.tab||1;o.setTab=function(t){o.tab=t;n.tab=t};s={"nb-NO":"NO","da-DK":"DK","sv-SE":"SE","fi-FI":"FI","en-UK":"EN","en-GB":"EN","es-ES":"ES"};o.search=function(){e.search(o.searchModel.userSelection,o.searchModel.urlList)};o.carSearch=function(n,t){t.clientId="242532";window.location=f.getCartrawlerUrl(n,t)};o.holidaySearch=function(n){var t="airport%3A"+n.destination,r;n.norwegianHolidayAreaType&&n.norwegianHolidayAreaType.length>0&&(t=n.norwegianHolidayAreaType+"%3A"+n.norwegianHolidayAreaId);r=n.holidaySearchOrigin?"&origin="+n.holidaySearchOrigin:"";window.location="https://www.norwegianholidays.com/travel/arc_waiting.cfm?nav="+(s[i.culture]||"EU")+"earn&air_room_car_radio="+n.searchType+"&area1=%7Cairport%3A"+n.origin+"&area2=%7C"+t+"&date1="+n.outboundDate+"&date2="+n.inboundDate+"&num_rooms="+n.roomCount+"&room_info="+n.roomInfo+r}}])}(),function(){"use strict";angular.module("nas.availabilitysearch").controller("SearchCtrl",["userSelectionSvc","destinations","searchModel","currencySvc","nasConfig","availabilitySearchSvc",function(n,t,i,r,u,f){function o(){var n=new Date;return moment(new Date(n.getFullYear(),n.getMonth(),n.getDate())).format("YYYY-MM-DD")}function s(){var n=new Date;return moment(new Date(n.getFullYear(),n.getMonth(),n.getDate())).add(u.avaSearchDayLimit,"days").format("YYYY-MM-DD")}var e=this;i.airportRelations=t.relations;e.searchModel=i;e.searchModel.minDate=o();e.searchModel.maxDate=s();e.searchModel.originAirportList=t.destinations;e.searchModel.adultMaxCount=9;e.searchModel.adultMinCount=1;e.searchModel.fromSuggestionList=e.searchModel.fromSuggestionList==undefined?[]:e.searchModel.fromSuggestionList;r.getCurrencies().$promise.then(function(n){e.searchModel.userSelection.currencyCode=n.currencyCodes[0]});e.search=function(){f.search(e.searchModel.userSelection,e.searchModel.urlList)}}])}()